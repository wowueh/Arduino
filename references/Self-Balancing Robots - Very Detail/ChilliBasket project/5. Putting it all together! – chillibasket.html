<!DOCTYPE html>
<!-- saved from url=(0062)http://wired.chillibasket.com/2015/10/putting-it-all-together/ -->
<html lang="en-US" class=" js cssanimations csstransitions"><!--BEGIN head--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

                    <!-- Favicon -->
            <!-- Firefox, Chrome, Safari, IE 11+ and Opera. -->
            <link href="http://wired.chillibasket.com/wp-content/uploads/2015/03/4e9d6895b4e9e70456edbdb2b46312aa1-550c5afcv1_site_icon.png" rel="icon" type="image/x-icon">
        
        <!-- Meta Tags -->
        
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Putting it all together! – chillibasket</title>
<link rel="dns-prefetch" href="http://maps.googleapis.com/">
<link rel="dns-prefetch" href="http://www.google.com/">
<link rel="dns-prefetch" href="http://s0.wp.com/">
<link rel="dns-prefetch" href="http://s.gravatar.com/">
<link rel="dns-prefetch" href="http://fonts.googleapis.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="chillibasket » Feed" href="http://wired.chillibasket.com/feed/">
<link rel="alternate" type="application/rss+xml" title="chillibasket » Comments Feed" href="http://wired.chillibasket.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="chillibasket » Putting it all together! Comments Feed" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/feed/">
		<script async="" src="./5. Putting it all together! – chillibasket_files/analytics.js.tải xuống"></script><script type="text/javascript" async="" src="./5. Putting it all together! – chillibasket_files/recaptcha__en.js.tải xuống"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/wired.chillibasket.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=261c7bf7d6d16263a6a86155c84aa6a5"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./5. Putting it all together! – chillibasket_files/wp-emoji-release.min.js.tải xuống" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="parallaxcss-css" href="./5. Putting it all together! – chillibasket_files/parallax.css" type="text/css" media="all">
<link rel="stylesheet" id="fontawesomecss-css" href="./5. Putting it all together! – chillibasket_files/font-awesome.css" type="text/css" media="all">
<link rel="stylesheet" id="maincss-css" href="./5. Putting it all together! – chillibasket_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrapcss-css" href="./5. Putting it all together! – chillibasket_files/bootstrap.css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrapcsstheme-css" href="./5. Putting it all together! – chillibasket_files/bootstrap-theme.css" type="text/css" media="all">
<style id="bootstrapcsstheme-inline-css" type="text/css">
 
body {
    background-color: #ecebe9;
}

.home-content-boxes .content-box {
    background: #efefef;
    padding: 30px 10px;
}

.content-box p {
    margin: 25px 0 50px 0;
}

@media (min-width: 768px) {
    .home-content-boxes .content-box {
        padding: 30px 20px 70px 20px;
        margin: 0 0.98%;
    }
    .home-content-boxes .col-md-3.content-box {
        width: 23%;
    }
    .home-content-boxes .col-md-4.content-box {
        width: 31.33333333%;
    }
    .home-content-boxes .col-md-6.content-box {
        width: 48%;
        margin: 0 0.96%;
    }
    .home-content-boxes .col-md-12.content-box {
        width: 98%;
    }
}

@media (min-width: 768px) and (max-width: 991px) {
    .home-content-boxes .col-md-3.content-box {
        width: 23%;
    }
}

@media (min-width: 992px) {
    .home-content-boxes .col-md-3.content-box {
        width: 23%;
    }
}

@media (max-width: 768px) {
    .cntbox_btn {
        position: relative;
        bottom: 0px;
    }
}

.sticky-header .nav {
    float: left;
    margin-left: 25px;
}

ul.nav-menu li a:active,
ul.nav-menu li:active > a,
ul.nav-menu li a:focus,
ul.nav-menu li:focus > a,
ul.nav-menu li a:hover,
ul.nav-menu li:hover> a,
ul.nav-menu li:hover,
ul.nav-menu li a:hover span,
ul.nav-menu li:hover> a span,
ul.nav-menu li:hover> .sf-with-ul::after {
    color: #111111 !important;
}
 
@media only screen and (min-width: 768px) {
    .link-effect a:hover span,
    .link-effect a:focus span {
        -webkit-transform: translateY(-100%);
        -moz-transform: translateY(-100%);
        transform: translateY(-100%);
    }
}

@media (min-width: 1005px) {
    .container, 
    #wrapper {
	width: 985px!important;
    }
}

#gmap {
    width: 100%;
    margin:0 auto;
    height: 415px
}

@media only screen and (min-width: 768px) {
    .link-effect a:hover span,
    .link-effect a:focus span {
        -webkit-transform: translateY(-100%);
        -moz-transform: translateY(-100%);
        transform: translateY(-100%); 
    } 
}

.entry-content .thumbnail-post:hover img {
    -webkit-transform: scale(1.1,1.1);
    -moz-transform: scale(1.1,1.1);
    -o-transform: scale(1.1,1.1);
    -ms-transform: scale(1.1,1.1);
    transform: scale(1.1,1.1);
}

.entry-content .thumbnail-post:hover .mask {
    -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=100)";
    filter: alpha(opacity=100);
    opacity: 1;
}

.entry-content .thumbnail-post:hover .icon {
    -ms-filter: "progid: DXImageTransform.Microsoft.Alpha(Opacity=100)";
    filter: alpha(opacity=100);
    opacity: 1;
    top: 50%;
	left: 50%;	
    margin-top: -21px;
    -webkit-transition-delay: 0.1s;
    -moz-transition-delay: 0.1s;
    -o-transition-delay: 0.1s;
    -ms-transition-delay: 0.1s;
    transition-delay: 0.1s;
}

.header-pattern {
    background: #313a43;
}

.header-pattern, 
.footer {
    background-image: url(http://wired.chillibasket.com/wp-content/themes/evolve/library/media/images/pattern/pattern_5_thumb.png);
}

.menu-back {
    background-color: #595959;
    background: -webkit-gradient(radial, center center, 0, center center, 460, from(#595959), to(#353535));
    background: -webkit-radial-gradient(circle, #595959, #353535);
    background: -moz-radial-gradient(circle, #595959, #353535);
    background: -o-radial-gradient(circle, #595959, #353535);
    background: -ms-radial-gradient(circle, #595959, #353535);
}

.da-dots span {
    background: #3e3e3e
}

/**
 * Posts Layout
 * 
 */   

.home .type-post .entry-content, 
.archive .type-post .entry-content, 
.search .type-post .entry-content, 
.page-template-blog-page-php .type-post .entry-content {
    font-size: 13px;
}

.entry-content {
    margin-top: 25px;
}

.home .odd0, 
.archive .odd0, 
.search .odd0, 
.page-template-blog-page-php .odd0 {
    clear: both;
}

.home .odd1, 
.archive .odd1, 
.search .odd1, 
.page-template-blog-page-php .odd1 {
    margin-right: 0px;
}

.home .entry-title, 
.entry-title a, 
.archive .entry-title, 
.search .entry-title, 
.page-template-blog-page-php .entry-title {
    font-size: 120%!important;
    line-height: 120%!important;
    margin-bottom: 0;
}

.home .entry-header, 
.archive .entry-header, 
.search .entry-header, 
.page-template-blog-page-php .entry-header {
    font-size: 12px;
    padding: 0;
}

.home .published strong, 
.archive .published strong, 
.search .published strong, 
.page-template-blog-page-php .published strong {
    font-size: 15px;
    line-height: 15px;
}

.home .hfeed, 
.archive .hfeed,
.single .hfeed, 
.page .hfeed, 
.page-template-blog-page-php .hfeed {
    margin-right: 0px;
}

.home .type-post .entry-footer, 
.archive .type-post .entry-footer, 
.search .type-post .entry-footer, 
.page-template-blog-page-php .type-post .entry-footer {
    float: left;
    width: 100%
}

.home .type-post .comment-count, 
.archive .type-post .comment-count, 
.search .type-post .comment-count, 
.page-template-blog-page-php .type-post .comment-count {
    background: none!important;
    padding-right: 0;
}

.title-container #logo {
    float: left;
}

.title-container #tagline {
    padding-top: 20px;
}

.title-container #logo a {
    padding: 0px 20px 0px 0px;
}

.title-container #logo a {
    padding: 0px 20px 0px 3px;
}
#logo a{font-size:40px ;}#logo a{font-family:Roboto !important;}#logo a{font-weight:300 !important;}#logo a{color:#3a3a3a !important;}#logo a{letter-spacing:-.03em;}#tagline{font-size:13px ;}#tagline{font-family:Roboto !important;}#tagline{color:#878787 !important;}.entry-title, .entry-title a, .page-title{font-size:26px !important;}.entry-title, .entry-title a, .page-title{font-family:Roboto !important;}.entry-content{font-size:16px !important;}.entry-content{font-family:Roboto !important;}.entry-content{font-style:normal !important;}.entry-content{line-height:1.5em;}body{color: !important;}#sticky-logo a{font-size:25px ;}#sticky-logo a{font-family:Roboto !important;}#sticky-logo a{font-weight:400 !important;}#sticky-logo a{color:#3a3a3a !important;}#sticky-logo a{letter-spacing:-.03em;}ul.nav-menu a, .menu-header, #wrapper .dd-container label, #wrapper .dd-container a{font-size:14px ;}ul.nav-menu a, .menu-header, #wrapper .dd-container label, #wrapper .dd-container a{font-family:Roboto !important;}ul.nav-menu a, .menu-header, #wrapper .dd-container label, #wrapper .dd-container a{color:#3a3a3a !important;}#bootstrap-slider .carousel-caption h2 {font-size:30px ;}#bootstrap-slider .carousel-caption h2 {font-family:Roboto !important;}#bootstrap-slider .carousel-caption h2 {font-weight:700 !important;}#bootstrap-slider .carousel-caption p  {font-size:18px ;}#bootstrap-slider .carousel-caption p  {font-family:Roboto !important;}#bootstrap-slider .carousel-caption p  {font-weight:300 !important;}.da-slide h2 {font-size:36px ;}.da-slide h2 {font-family:Roboto !important;}.da-slide h2 {font-style:normal !important;}.da-slide p {font-size:18px ;}.da-slide p {font-family:Roboto !important;}#slide_holder .featured-title a {font-size:25px ;}#slide_holder .featured-title a {font-family:Roboto !important;}#slide_holder .featured-title a {font-weight:500 !important;}#slide_holder p {font-size:14px ;}#slide_holder p {font-family:Roboto !important;}#slide_holder p {font-weight:400 !important;}.widget-title{font-size:19px ;}.widget-title{font-family:Roboto !important;}.widget-content, .aside, .aside a{font-size:13px ;}.widget-content, .aside, .aside a{font-family:Roboto !important;}.widget-content, .widget-content a, .widget-content .tab-holder .news-list li .post-holder a, .widget-content .tab-holder .news-list li .post-holder .meta{color: !important;}.content-box h2{font-size:30px ;}.content-box h2{font-family:Roboto !important;}.content-box h2{font-weight:400 !important;}.content-box h2{color:#6b6b6b !important;}.content-box p{font-size:22px ;}.content-box p{font-family:Roboto !important;}.content-box p{font-weight:400 !important;}.content-box p{color:#888 !important;}.entry-content h1{font-size:46px ;}.entry-content h1{font-family:Roboto !important;}.entry-content h2{font-size:40px ;}.entry-content h2{font-family:Roboto !important;}.entry-content h3{font-size:34px ;}.entry-content h3{font-family:Roboto !important;}.entry-content h4{font-size:20px ;}.entry-content h4{font-family:Roboto !important;}.entry-content h5{font-size:16px ;}.entry-content h5{font-family:Roboto !important;}.entry-content h6{font-size:12px ;}.entry-content h6{font-family:Roboto !important;}
ul.primary-menu-cont.nav-menu li:hover ul,
ul.primary-menu-cont.nav-menu li.nav-hover ul {
    top: 52px;
}

#bootstrap-slider .carousel-inner .img-responsive {
    display: block;
    height: auto;
    width: 100%;
}

.sticky-header #logo {
    float: left;
    padding: 6px 6px 6px 3px;
}

.sticky-header #sticky-logo {
    float: left;
    padding: 0px 6px 0px 3px;
}

body #header.sticky-header img#logo-image {
    margin-left: 10px;
}

#backtotop {
    right: 2%;
}

#wrapper {
    position: relative;
    margin: 0 auto 30px auto !important;
    background: #f9f9f9;
    box-shadow: 0 0 3px rgba(0, 0, 0, .2);
}

#wrapper:before {
    -webkit-box-shadow: 0 0 9px rgba(0, 0, 0, 0.6);
    -moz-box-shadow: 0 0 9px rgba(0, 0, 0, 0.6);
    box-shadow: 0 0 9px rgba(0, 0, 0, 0.6);
    left: 30px;
    right: 30px;
    position: absolute;
    z-index: -1;
    height: 20px;
    bottom: 0px;
    content: "";
    -webkit-border-radius: 100px / 10px;
    -moz-border-radius: 100px / 10px;
    border-radius: 100px / 10px;		
}

a, 
a:hover,
a:focus,
.entry-content a:link, 
.entry-content a:active, 
.entry-content a:visited, 
#secondary a:hover, 
#secondary-2 a:hover, 
.tooltip-shortcode, 
#jtwt .jtwt_tweet a:hover, 
.contact_info a:hover, 
.widget .wooslider h2.slide-title a, 
.widget .wooslider h2.slide-title a:hover {
    color: #7a9cad;
}

.header { 
    padding-top: 40px;
    padding-bottom: 40px;
}

.header .container {
    padding-left: 30px;
    padding-right: 30px;
}
	
ul.nav-menu > li { 
    padding: 0px 8px; 
}

@media only screen and (max-width: 1220px) {
    body #header.sticky-header {
    	margin: 0px !important;
	left: 0px;
    }
}

body #header.sticky-header {
    margin-left: -16px;
}

#rss, 
#email-newsletter, 
#facebook, 
#twitter, 
#instagram, 
#skype, 
#youtube, 
#flickr, 
#linkedin, 
#plus, 
#pinterest, 
#tumblr { 
    color: #999999;
}
.sc_menu li a {
    color: #999999;
}

#rss, 
#email-newsletter, 
#facebook, 
#twitter, 
#instagram, 
#skype, 
#youtube, 
#flickr, 
#linkedin, 
#plus, 
#pinterest, 
#tumblr { 
    font-size: normal;
}
.sc_menu li a {
    font-size: normal;
}

.menu-back { 
    background-repeat: no-repeat;
}

.content-box-1 i { 
    color: #faa982;
}

.content-box-2 i { 
    color: #8fb859;
}

.content-box-3 i { 
    color: #78665e;
}

.content-box-4 i { 
    color: #82a4fa;
}

.content {
    background-color: #ffffff
}

.t4p-reading-box-container a.button-default,	
button, 
.button, 
.bootstrap-button,
input#submit, 
.da-slide .da-link, 
span.more a,
a.read-more,
a.comment-reply-link,	
.entry-content a.t4p-button-default,
.button.button-3d.button-small, 
.button.default.button-3d.button-small, 
.button.default.small,
#reviews input#submit,
.woocommerce .login .button,
.woocommerce .register .button,
.bbp-submit-wrapper button,
.wpcf7-form input[type="submit"], 
.wpcf7-submit,
#wrapper a.read-more,
input[type="submit"],
.price_slider_amount button,
.product-buttons .add_to_cart_button,
.product-buttons .button.product_type_grouped, 
.product-buttons .button.product_type_simple,
.product-buttons .button.product_type_external {
    -webkit-box-shadow: 0px 2px 0px #1d6e72;
    -moz-box-shadow: 	0px 2px 0px #1d6e72;
    box-shadow:         0px 2px 0px #1d6e72;		
}	

.t4p-reading-box-container a.button-default:active,
button:active, 
.button:active, 
.bootstrap-button:active,
input#submit:active, 
.da-slide .da-link:active, 
span.more a:active,
a.read-more:active,
a.comment-reply-link:active,
.entry-content a.t4p-button-default:active,	
.button.button-3d.button-small:active, 
.button.default.button-3d.button-small:active, 
.button.default.small:active,
#reviews input#submit:active,
.woocommerce .login .button:active, 
.woocommerce .register .button:active,
.bbp-submit-wrapper button:active,
.wpcf7-form input[type="submit"]:active, 
.wpcf7-submit:active,
#wrapper a.read-more:active,
input[type="submit"]:active,
.product-buttons .add_to_cart_button:active,
.product-buttons .button.product_type_grouped:active, 
.product-buttons .button.product_type_simple:active,
.product-buttons .button.product_type_external:active {
    -webkit-box-shadow: 0px 1px 0px #1d6e72;
    -moz-box-shadow: 	0px 1px 0px #1d6e72;
    box-shadow:		0px 1px 0px #1d6e72;		
}

.t4p-reading-box-container a.button-default:hover,
input[type="submit"]:hover, 
button:hover, 
.button:hover, 
.bootstrap-button:hover,
input#submit:hover, 
.da-slide .da-link:hover, 
span.more a:hover,
a.read-more:hover,
a.comment-reply-link:hover,
.entry-content a.t4p-button-default:hover,
.button.button-3d.button-small:hover, 
.button.default.button-3d.button-small:hover, 
.button.default.small:hover,
.t4p-button.button-green.button-3d.button-small:hover,
.button.green.button-3d.button-small:hover,
.t4p-button.button-darkgreen.button-3d.button-small:hover,
.button.darkgreen.button-3d.button-small:hover,
.t4p-button.button-orange.button-3d.button-small:hover,
.button.orange.button-3d.button-small:hover,
.t4p-button.button-blue.button-3d.button-small:hover,
.button.blue.button-3d.button-small:hover,
.t4p-button.button-darkblue.button-3d.button-small:hover,
.button.darkblue.button-3d.button-small:hover,
.t4p-button.button-red.button-3d.button-small:hover,
.button.darkred.button-3d.button-small:hover,
.t4p-button.button-pink.button-3d.button-small:hover,
.button.pink.button-3d.button-small:hover,
.t4p-button.button-darkgray.button-3d.button-small:hover,
.button.darkgray.button-3d.button-small:hover,
.t4p-button.button-lightgray.button-3d.button-small:hover,
.button.lightgray.button-3d.button-small:hover,   
#reviews input#submit:hover,
.woocommerce .login .button:hover, 
.woocommerce .register .button:hover,
.bbp-submit-wrapper button:hover,
.wpcf7-form input[type="submit"]:hover, 
.wpcf7-submit:hover,
#wrapper a.read-more:hover,
.price_slider_amount button:hover,
.product-buttons .add_to_cart_button:hover,
.product-buttons .button.product_type_grouped:hover, 
.product-buttons .button.product_type_simple:hover,
.product-buttons .button.product_type_external:hover {
    -webkit-box-shadow:  0px 2px 0px #313a43;
    -moz-box-shadow: 	 0px 2px 0px #313a43;
    box-shadow:		 0px 2px 0px #313a43;		
}

.button.button-3d.button-medium, 
.button.default.button-3d.button-medium, 
.button.default.medium,   
#comment-submit,
.woocommerce form.checkout #place_order,
.woocommerce .single_add_to_cart_button,
.bbp-submit-wrapper button.button-medium,
.wpcf7-form input[type="submit"].button-medium, 
.wpcf7-submit.button-medium {
    -webkit-box-shadow:  0px 3px 0px #1d6e72;
    -moz-box-shadow: 	 0px 3px 0px #1d6e72;
    box-shadow:		 0px 3px 0px #1d6e72;		
}

.button.button-3d.button-medium:active, 
.button.default.button-3d.button-medium:active, 
.button.default.medium:active,
#comment-submit:active,
.woocommerce form.checkout #place_order:active,
.woocommerce .single_add_to_cart_button:active,
.bbp-submit-wrapper button.button-medium:active,
.wpcf7-form input[type="submit"].button-medium:active, 
.wpcf7-submit.button-medium:active {
    -webkit-box-shadow:  0px 1px 0px #1d6e72;
    -moz-box-shadow: 	 0px 1px 0px #1d6e72;
    box-shadow:		 0px 1px 0px #1d6e72;		
}

.button.button-3d.button-medium:hover, 
.button.default.button-3d.button-medium:hover, 
.button.default.medium:hover, 
.t4p-button.button-green.button-3d.button-medium:hover,
.button.green.button-3d.button-medium:hover,
.t4p-button.button-darkgreen.button-3d.button-medium:hover,
.button.darkgreen.button-3d.button-medium:hover,
.t4p-button.button-orange.button-3d.button-medium:hover,
.button.orange.button-3d.button-medium:hover,
.t4p-button.button-blue.button-3d.button-medium:hover,
.button.blue.button-3d.button-medium:hover,
.t4p-button.button-darkblue.button-3d.button-medium:hover,
.button.darkblue.button-3d.button-medium:hover,
.t4p-button.button-red.button-3d.button-medium:hover,
.button.darkred.button-3d.button-medium:hover,
.t4p-button.button-pink.button-3d.button-medium:hover,
.button.pink.button-3d.button-medium:hover,
.t4p-button.button-darkgray.button-3d.button-medium:hover,
.button.darkgray.button-3d.button-medium:hover,
.t4p-button.button-lightgray.button-3d.button-medium:hover,
.button.lightgray.button-3d.button-medium:hover,        
#comment-submit:hover,
.woocommerce form.checkout #place_order:hover,
.woocommerce .single_add_to_cart_button:hover,
.bbp-submit-wrapper button.button-medium:hover,
.wpcf7-form input[type="submit"].button-medium:hover, 
.wpcf7-submit.button-medium:hover {
    -webkit-box-shadow:  0px 3px 0px #313a43;
    -moz-box-shadow: 	 0px 3px 0px #313a43;
    box-shadow: 	 0px 3px 0px #313a43;		
}

.button.button-3d.button-large, 
.button.default.button-3d.button-large, 
.button.default.large,
.bbp-submit-wrapper button.button-large,
.wpcf7-form input[type="submit"].button-large, 
.wpcf7-submit.button-large {
    -webkit-box-shadow:  0px 4px 0px #1d6e72;
    -moz-box-shadow: 	 0px 4px 0px #1d6e72;
    box-shadow: 	 0px 4px 0px #1d6e72;		
}		

.button.button-3d.button-large:active, 
.button.default.button-3d.button-large:active, 
.button.default.large:active,
.bbp-submit-wrapper button.button-large:active,
.wpcf7-form input[type="submit"].button-large:active, 
.wpcf7-submit.button-large:active {
    -webkit-box-shadow:  0px 1px 0px #1d6e72;
    -moz-box-shadow: 	 0px 1px 0px #1d6e72;
    box-shadow:		 0px 1px 0px #1d6e72;				
}

.button.button-3d.button-large:hover, 
.button.default.button-3d.button-large:hover, 
.button.default.large:hover,
.t4p-button.button-green.button-3d.button-large:hover,
.button.green.button-3d.button-large:hover,
.t4p-button.button-darkgreen.button-3d.button-large:hover,
.button.darkgreen.button-3d.button-large:hover,
.t4p-button.button-orange.button-3d.button-large:hover,
.button.orange.button-3d.button-large:hover,
.t4p-button.button-blue.button-3d.button-large:hover,
.button.blue.button-3d.button-large:hover,
.t4p-button.button-darkblue.button-3d.button-large:hover,
.button.darkblue.button-3d.button-large:hover,
.t4p-button.button-red.button-3d.button-large:hover,
.button.darkred.button-3d.button-large:hover,
.t4p-button.button-pink.button-3d.button-large:hover,
.button.pink.button-3d.button-large:hover,
.t4p-button.button-darkgray.button-3d.button-large:hover,
.button.darkgray.button-3d.button-large:hover,
.t4p-button.button-lightgray.button-3d.button-large:hover,
.button.lightgray.button-3d.button-large:hover,   
.bbp-submit-wrapper button.button-large:hover,
.wpcf7-form input[type="submit"].button-large:hover, 
.wpcf7-submit.button-large:hover {
    -webkit-box-shadow:  0px 4px 0px #313a43;
    -moz-box-shadow: 	 0px 4px 0px #313a43;
    box-shadow: 	 0px 4px 0px #313a43;				
}

.button.button-3d.button-xlarge, 
.button.default.button-3d.button-xlarge, 
.button.default.xlarge,
.bbp-submit-wrapper button.button-xlarge,
.wpcf7-form input[type="submit"].button-xlarge, 
.wpcf7-submit.button-xlarge {
    -webkit-box-shadow:  0px 5px 0px #1d6e72, 1px 7px 7px 3px rgba(0,0,0,0.3);
    -moz-box-shadow: 	 0px 5px 0px #1d6e72, 1px 7px 7px 3px rgba(0,0,0,0.3);
    box-shadow: 	 0px 5px 0px #1d6e72, 1px 7px 7px 3px rgba(0,0,0,0.3);		
}		

.button.button-3d.button-xlarge:active, 
.button.default.button-3d.button-xlarge:active, 
.button.default.xlarge:active,
.bbp-submit-wrapper button.button-xlarge:active,
.wpcf7-form input[type="submit"].button-xlarge:active, 
.wpcf7-submit.button-xlarge:active {
    -webkit-box-shadow:  0px 2px 0px #1d6e72, 1px 7px 7px 3px rgba(0,0,0,0.3);
    -moz-box-shadow: 	 0px 2px 0px #1d6e72, 1px 7px 7px 3px rgba(0,0,0,0.3);
    box-shadow: 	 0px 2px 0px #1d6e72, 1px 7px 7px 3px rgba(0,0,0,0.3);					
}

.button.button-3d.button-xlarge:hover, 
.button.default.button-3d.button-xlarge:hover, 
.button.default.xlarge:hover,
.t4p-button.button-green.button-3d.button-xlarge:hover,
.button.green.button-3d.button-xlarge:hover,
.t4p-button.button-darkgreen.button-3d.button-xlarge:hover,
.button.darkgreen.button-3d.button-xlarge:hover,
.t4p-button.button-orange.button-3d.button-xlarge:hover,
.button.orange.button-3d.button-xlarge:hover,
.t4p-button.button-blue.button-3d.button-xlarge:hover,
.button.blue.button-3d.button-xlarge:hover,
.t4p-button.button-darkblue.button-3d.button-xlarge:hover,
.button.darkblue.button-3d.button-xlarge:hover,
.t4p-button.button-red.button-3d.button-xlarge:hover,
.button.darkred.button-3d.button-xlarge:hover,
.t4p-button.button-pink.button-3d.button-xlarge:hover,
.button.pink.button-3d.button-xlarge:hover,
.t4p-button.button-darkgray.button-3d.button-xlarge:hover,
.button.darkgray.button-3d.button-xlarge:hover,
.t4p-button.button-lightgray.button-3d.button-xlarge:hover,
.button.lightgray.button-3d.button-xlarge:hover,   
.bbp-submit-wrapper button.button-xlarge:hover,
.wpcf7-form input[type="submit"].button-xlarge:hover, 
.wpcf7-submit.button-xlarge:hover {
    -webkit-box-shadow:  0px 5px 0px #313a43, 1px 7px 7px 3px rgba(0,0,0,0.3);
    -moz-box-shadow: 	 0px 5px 0px #313a43, 1px 7px 7px 3px rgba(0,0,0,0.3);
    box-shadow: 	 0px 5px 0px #313a43, 1px 7px 7px 3px rgba(0,0,0,0.3);					
}

.t4p-reading-box-container a.button-default,
button, 
.bootstrap-button,
input#submit, 
.da-slide .da-link, 
span.more a,
a.read-more,	
a.comment-reply-link,
.entry-content a.t4p-button-default,	
.t4p-button,
.button,
.button.default,
.gform_wrapper .gform_button,
#comment-submit,
.woocommerce form.checkout #place_order,
.woocommerce .single_add_to_cart_button,
#reviews input#submit,
.woocommerce .login .button,
.woocommerce .register .button,
.woocommerce .button.view,
.woocommerce .wc-backward,
.bbp-submit-wrapper button,
.wpcf7-form input[type="submit"], 
.wpcf7-submit,
input[type="submit"],
.price_slider_amount button,
.product-buttons .add_to_cart_button,
.product-buttons .button.product_type_grouped, 
.product-buttons .button.product_type_simple,
.product-buttons .button.product_type_external,
#content .entry-content .product-buttons a:link {
    color: #f4f4f4;
}

.t4p-reading-box-container a.button-default:hover,	
button:hover, 
.bootstrap-button:hover,
input#submit:hover, 
.da-slide .da-link:hover, 
span.more a:hover,
a.read-more:hover,	
a.comment-reply-link:hover,
.entry-content a.t4p-button-default:hover,
.t4p-button:hover,
.button:hover,
.button.default:hover,
.gform_wrapper .gform_button:hover,
#comment-submit:hover,
.woocommerce form.checkout #place_order:hover,
.woocommerce .single_add_to_cart_button:hover,
#reviews input#submit:hover,
.woocommerce .login .button:hover,
.woocommerce .register .button:hover,
.woocommerce .wc-backward,
.woocommerce .button.view:hover,
.bbp-submit-wrapper button:hover,
.wpcf7-form input[type="submit"]:hover, 
.wpcf7-submit:hover,
#wrapper a.read-more:hover,
input[type="submit"]:hover,
.product-buttons .add_to_cart_button:hover,
.product-buttons .button.product_type_grouped:hover, 
.product-buttons .button.product_type_simple:hover,
.product-buttons .button.product_type_external:hover,
#content .entry-content .product-buttons a:hover {
    color: #ffffff;
}

.tagcloud a:hover {
    color: #ffffff!important;
}

.t4p-reading-box-container a.button-default,	
input[type="submit"], 
button, 
.button, 
.bootstrap-button,
input#submit, 
.da-slide .da-link, 
span.more a,
a.read-more,	
a.comment-reply-link,	
.entry-content a.t4p-button-default,	
.t4p-button.button-flat,
.home-content-boxes .t4p-button {
    text-shadow: none!important;
}

.t4p-reading-box-container a.button-default,	
button, 
.bootstrap-button,
input#submit, 
.da-slide .da-link, 
span.more a,
a.read-more,	
a.comment-reply-link,
.entry-content a.t4p-button-default,	
.t4p-button,
.button,
.button.default,
.button-default,
.gform_wrapper .gform_button,
#comment-submit,
.woocommerce form.checkout #place_order,
.woocommerce .single_add_to_cart_button,
#reviews input#submit,
.woocommerce .login .button,
.woocommerce .register .button,
.woocommerce-message .wc-forward,
.woocommerce .wc-backward,
.woocommerce .button.view,
.bbp-submit-wrapper button,
.wpcf7-form input[type="submit"], 
.wpcf7-submit,
#wrapper a.read-more,
input[type="submit"],
.price_slider_amount button,
.product-buttons .add_to_cart_button,
.product-buttons .button.product_type_grouped, 
.product-buttons .button.product_type_simple,
.product-buttons .button.product_type_external {
    border-width: 1px;
    border-style: solid;
}

.t4p-reading-box-container a.button-default:hover,
input[type="submit"]:hover, 
button:hover, 
.button:hover, 
.bootstrap-button:hover,
input#submit:hover, 
.da-slide .da-link:hover, 
span.more a:hover,
a.read-more:hover,
a.comment-reply-link:hover,
.entry-content a.t4p-button-default:hover,	
.t4p-button:hover,
.button:hover, 
.button.default:hover, 
.t4p-button.button-default:hover,
#wrapper a.read-more:hover,
.t4p-accordian .panel-title a.active,
.price_slider_amount button:hover,
.button:focus,
.button:active {
    border-width: 1px;
    border-style: solid;
}

.t4p-reading-box-container a.button-default,
button, 
.button, 
.bootstrap-button,
input#submit, 
.da-slide .da-link, 
span.more a,
a.read-more,		
a.comment-reply-link,		
.entry-content a.t4p-button-default,	
.t4p-button,
.button.default,
.button-default,
.gform_wrapper .gform_button,
#comment-submit,
.woocommerce form.checkout #place_order,
.woocommerce .single_add_to_cart_button,
#reviews input#submit,
.woocommerce .login .button,
.woocommerce .register .button,
.woocommerce-message .wc-forward,
.woocommerce .wc-backward,
.woocommerce .button.view,
.bbp-submit-wrapper button,
.wpcf7-form input[type="submit"], 
.wpcf7-submit,
#wrapper a.read-more,
.woocommerce-pagination .current,
.t4p-accordian .panel-title a.active,
input[type="submit"],
.price_slider_amount button,
.product-buttons .add_to_cart_button,
.product-buttons .button.product_type_grouped, 
.product-buttons .button.product_type_simple,
.product-buttons .button.product_type_external,
.button:focus,
.button:active {
    border-color: #0bb697;
}

.t4p-reading-box-container a.button-default:hover,	
button:hover, 
.bootstrap-button:hover,
input#submit:hover, 
.da-slide .da-link:hover, 
span.more a:hover,
a.read-more:hover,	
a.comment-reply-link:hover,	
.entry-content a.t4p-button-default:hover,	
.t4p-button:hover,
.button:hover,
.button.default:hover,
.button-default:hover,
.gform_wrapper .gform_button:hover,
#comment-submit:hover,
.woocommerce form.checkout #place_order:hover,
.woocommerce .single_add_to_cart_button:hover,
.woocommerce-message .wc-forward:hover,
.woocommerce .wc-backward:hover,
.woocommerce .button.view:hover,
#reviews input#submit:hover,
.woocommerce .login .button:hover,
.woocommerce .register .button:hover,
.bbp-submit-wrapper button:hover,
.wpcf7-form input[type="submit"]:hover, 
.wpcf7-submit:hover,
#wrapper a.read-more:hover,
.woocommerce-pagination .current:hover,
input[type="submit"]:hover,
.price_slider_amount button:hover,
.product-buttons .add_to_cart_button:hover,
.product-buttons .button.product_type_grouped:hover, 
.product-buttons .button.product_type_simple:hover,
.product-buttons .button.product_type_external:hover {
    border-color: #313a43!important;
}

.t4p-reading-box-container a.button-default,	
button, 
.bootstrap-button,
input#submit, 
.da-slide .da-link, 
span.more a,
a.read-more,	
a.comment-reply-link,	
.entry-content a.t4p-button-default,	
.t4p-button,
.button,
.button.default,
#comment-submit,
.woocommerce form.checkout #place_order,
.woocommerce .single_add_to_cart_button,
#reviews input#submit,
.woocommerce .evolve-shipping-calculator-form .button,
.woocommerce .login .button,
.woocommerce .register .button,
.woocommerce-message .wc-forward,
.woocommerce .wc-backward,
.woocommerce .button.view,
.bbp-submit-wrapper button,
.wpcf7-form input[type="submit"], 
.wpcf7-submit,
a.read-more,
input[type="submit"],
.price_slider_amount button,
.product-buttons .add_to_cart_button,
.product-buttons .button.product_type_grouped, 
.product-buttons .button.product_type_simple,
.product-buttons .button.product_type_external {
    border-radius: 4px;
}

.t4p-reading-box-container a.button-default,	
button, 
.bootstrap-button,
input#submit, 
.da-slide .da-link, 
span.more a,
a.read-more,	
a.comment-reply-link,	
.entry-content a.t4p-button-default,	
.t4p-button,
.reading-box .button,
.continue.button,
#wrapper .portfolio-one .button,
#wrapper .comment-submit,
#reviews input#submit,
.comment-form input[type="submit"],
.button,
.button-default,
.button.default,
a.read-more, 
.tagcloud a:hover,
h5.toggle.active a,
h5.toggle.active a:hover,
span.more a, 
.project-content .project-info .project-info-box a.button,
input[type="submit"], 
.price_slider_amount button,
.gform_wrapper .gform_button,
.woocommerce-pagination .current,
.widget_shopping_cart_content .buttons a,
.woocommerce-success-message a.button, 
.woocommerce .order-again .button,
.woocommerce-message .wc-forward,
.woocommerce .wc-backward,
.woocommerce .button.view,
.product-buttons .add_to_cart_button,
.product-buttons .button.product_type_grouped, 
.product-buttons .button.product_type_simple,
.product-buttons .button.product_type_external,
.wpcf7-form input.button,
.wpcf7-form input[type="submit"],
.wpcf7-submit, 
.woocommerce .single_add_to_cart_button,
.woocommerce .button.view,
.woocommerce .shipping-calculator-form .button,
.woocommerce form.checkout #place_order,
.woocommerce .checkout_coupon .button,
.woocommerce .login .button,
.woocommerce .register .button,
.woocommerce .evolve-order-details .order-again .button,
.t4p-accordian .panel-title a.active {
    background: #0bb697;
		
    background-image: -webkit-gradient( linear, left bottom, left top, from( #0bb697 ), to( #0bb697 ) );
    background-image: -webkit-linear-gradient( bottom, #0bb697, #0bb697 );
    background-image:    -moz-linear-gradient( bottom, #0bb697, #0bb697 );
    background-image:      -o-linear-gradient( bottom, #0bb697, #0bb697 );
    background-image: linear-gradient( to top, #0bb697, #0bb697 );	
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#0bb697', endColorstr='#0bb697' );
	
}

.t4p-reading-box-container a.button-default:hover,	
input[type="submit"]:hover, 
button:hover, 
.bootstrap-button:hover,
input#submit:hover, 
.da-slide .da-link:hover, 
span.more a:hover,
a.read-more:hover,	
a.comment-reply-link:hover,	
.entry-content a.t4p-button-default:hover,	
.t4p-button:hover,
#wrapper .portfolio-one .button:hover,
#wrapper .comment-submit:hover,
#reviews input#submit:hover,
.comment-form input[type="submit"]:hover,
.wpcf7-form input[type="submit"]:hover,
.wpcf7-submit:hover,
.bbp-submit-wrapper button:hover,
.button:hover,
.button-default:hover,
.button.default:hover,
.price_slider_amount button:hover,
.gform_wrapper .gform_button:hover,
.woocommerce .single_add_to_cart_button:hover,
.woocommerce .shipping-calculator-form .button:hover,
.woocommerce form.checkout #place_order:hover,
.woocommerce .checkout_coupon .button:hover,
.woocommerce .login .button:hover,
.woocommerce .register .button:hover,
.woocommerce .evolve-order-details .order-again .button:hover,
.woocommerce .button.view:hover,
.reading-box .button:hover, 
.continue.button:hover, 
#wrapper .comment-form input[type="submit"]:hover,
.comment-form input[type="submit"]:hover,
.button:hover,
.button .lightgray:hover,
a.read-more:hover,
span.more a:hover, 
a.button:hover, 
.woocommerce-pagination .page-numbers.current:hover,
.product-buttons .add_to_cart_button:hover,
.product-buttons .button.product_type_grouped:hover, 
.product-buttons .button.product_type_simple:hover,
.product-buttons .button.product_type_external:hover {
    background: #313a43;

    background-image: -webkit-gradient( linear, left bottom, left top, from( #313a43 ), to( #313a43 ) );
    background-image: -webkit-linear-gradient( bottom, #313a43, #313a43 );
    background-image:    -moz-linear-gradient( bottom, #313a43, #313a43 );
    background-image:      -o-linear-gradient( bottom, #313a43, #313a43 );
    background-image: linear-gradient( to top, #313a43, #313a43 );
    filter: progid:DXImageTransform.Microsoft.gradient(startColorstr=\#313a43', endColorstr=\#313a43');

}

/* Extra small devices (phones, <768px) */

@media (max-width: 768px) { 
    .da-slide h2, 
    #bootstrap-slider .carousel-caption h2 {
    	font-size: 120%!important;
	letter-spacing: 1px; 
    }
    #slide_holder .featured-title a {
	font-size: 80%!important;
	letter-spacing: 1px;
    } 
    .da-slide p, 
    #slide_holder p, 
    #bootstrap-slider .carousel-caption p {
    	font-size: 90%!important; 
    }
}

/* Small devices (tablets, 768px) */

@media (min-width: 768px) { 
    .da-slide h2 {
	font-size: 180%;
	letter-spacing: 0; 
    }
    #slide_holder .featured-title a {
	font-size: 120%;
	letter-spacing: 0; 
    }
    .da-slide p, 
    #slide_holder p {
    	font-size: 100%; 
    }
}  

/* Large devices (large desktops) */

@media (min-width: 992px) { 
    .da-slide h2 {
	font-size: 36px;
	line-height: 1em; 
    } 
    #slide_holder .featured-title a {
	font-size: 25px;
	line-height: 1em;
    }
    .da-slide p {
    	font-size: 18px;
    }
    #slide_holder p {
    	font-size: 14px;
    }
}

input#s,
#comment-input input,
#comment-textarea textarea,
.comment-form-comment textarea,
.input-text,
.post-password-form .password,
.wpcf7-form .wpcf7-text,
.wpcf7-form .wpcf7-quiz,
.wpcf7-form .wpcf7-number,
.wpcf7-form textarea,
.wpcf7-form .wpcf7-select,
.wpcf7-captchar,
.wpcf7-form .wpcf7-date,
.gform_wrapper .gfield input[type=text],
.gform_wrapper .gfield input[type=email],
.gform_wrapper .gfield textarea,
.gform_wrapper .gfield select,
#bbpress-forums .bbp-search-form #bbp_search,
.bbp-reply-form input#bbp_topic_tags,
.bbp-topic-form input#bbp_topic_title,
.bbp-topic-form input#bbp_topic_tags,
.bbp-topic-form select#bbp_stick_topic_select,
.bbp-topic-form select#bbp_topic_status_select,
#bbpress-forums div.bbp-the-content-wrapper textarea.bbp-the-content,
.main-nav-search-form input,
.search-page-search-form input,
.chzn-container-single .chzn-single,
.chzn-container .chzn-drop,
.evolve-select-parent,
.evolve-select-parent select,
.evolve-select-parent .evolve-select-arrow,
.evolve-select-parent .country_to_state,
#wrapper .select-arrow,
#lang_sel_click a.lang_sel_sel,
#lang_sel_click ul ul a,
#lang_sel_click ul ul a:visited,
#lang_sel_click a,
#lang_sel_click a:visited,
#wrapper .search-field input,
input[type=text],
input[type=email],
input[type=password],
input[type=file],
textarea,
select {
    background-color: #ffffff !important;
}
    
input#s,
input#s .placeholder,
#comment-input input,
#comment-textarea textarea,
#comment-input .placeholder,
#comment-textarea .placeholder,
.comment-form-comment textarea,
.input-text,
.post-password-form .password,
.wpcf7-form .wpcf7-text,
.wpcf7-form .wpcf7-quiz,
.wpcf7-form .wpcf7-number,
.wpcf7-form textarea,
.wpcf7-form .wpcf7-select,
.wpcf7-select-parent .select-arrow,
.wpcf7-captchar,
.wpcf7-form .wpcf7-date,
.gform_wrapper .gfield input[type=text],
.gform_wrapper .gfield input[type=email],
.gform_wrapper .gfield textarea,
.gform_wrapper .gfield select,
#bbpress-forums .bbp-search-form #bbp_search,
.bbp-reply-form input#bbp_topic_tags,
.bbp-topic-form input#bbp_topic_title,
.bbp-topic-form input#bbp_topic_tags,
.bbp-topic-form select#bbp_stick_topic_select,
.bbp-topic-form select#bbp_topic_status_select,
#bbpress-forums div.bbp-the-content-wrapper textarea.bbp-the-content,
.main-nav-search-form input,
.search-page-search-form input,
.chzn-container-single .chzn-single,
.chzn-container .chzn-drop,
.evolve-select-parent,
.evolve-select-parent select,
.evolve-select-parent .country_to_state,
.select2-container .select2-choice>.select2-chosen,
#wrapper .search-field input,
input[type=text],
input[type=email],
input[type=password],
input[type=file],
textarea,
select {
    color: #888888 !important;
}

input#s::-webkit-input-placeholder,
#comment-input input::-webkit-input-placeholder,
.post-password-form .password::-webkit-input-placeholder,
#comment-textarea textarea::-webkit-input-placeholder,
.comment-form-comment textarea::-webkit-input-placeholder,
.input-text::-webkit-input-placeholder {
    color: #888888;
}

input#s:-moz-placeholder,
#comment-input input:-moz-placeholder,
.post-password-form .password::-moz-input-placeholder,
#comment-textarea textarea:-moz-placeholder,
.comment-form-comment textarea:-moz-placeholder,
.input-text:-moz-placeholder,
input#s:-ms-input-placeholder,
#comment-input input:-ms-input-placeholder,
.post-password-form .password::-ms-input-placeholder,
#comment-textarea textarea:-moz-placeholder,
.comment-form-comment textarea:-ms-input-placeholder,
.input-text:-ms-input-placeholder {
    color: #888888;
}

input#s,
#comment-input input,
#comment-textarea textarea,
.comment-form-comment textarea,
.input-text,
.post-password-form .password,
.wpcf7-form .wpcf7-text,
.wpcf7-form .wpcf7-quiz,
.wpcf7-form .wpcf7-number,
.wpcf7-form textarea,
.wpcf7-form .wpcf7-select,
.wpcf7-select-parent .select-arrow,
.wpcf7-captchar,
.wpcf7-form .wpcf7-date,
.gform_wrapper .gfield input[type=text],
.gform_wrapper .gfield input[type=email],
.gform_wrapper .gfield textarea,
.gform_wrapper .gfield_select[multiple=multiple],
.gform_wrapper .gfield select,
.gravity-select-parent .select-arrow,
.select-arrow,
#bbpress-forums .quicktags-toolbar,
#bbpress-forums .bbp-search-form #bbp_search,
.bbp-reply-form input#bbp_topic_tags,
.bbp-topic-form input#bbp_topic_title,
.bbp-topic-form input#bbp_topic_tags,
.bbp-topic-form select#bbp_stick_topic_select,
.bbp-topic-form select#bbp_topic_status_select,
#bbpress-forums div.bbp-the-content-wrapper textarea.bbp-the-content,
#wp-bbp_topic_content-editor-container,
#wp-bbp_reply_content-editor-container,
.main-nav-search-form input,
.search-page-search-form input,
.chzn-container-single .chzn-single,
.chzn-container .chzn-drop,
.evolve-select-parent,
.evolve-select-parent select,
.evolve-select-parent select2-container,
.evolve-select-parent .evolve-select-arrow,
.evolve-select-parent .country_to_state,
#lang_sel_click a.lang_sel_sel,
#lang_sel_click ul ul a,
#lang_sel_click ul ul a:visited,
#lang_sel_click a,
#lang_sel_click a:visited,
#wrapper .search-field input,
input[type=text],
input[type=email],
input[type=password],
input[type=file],
textarea,
select {
    border-color: #E0E0E0 !important;
}

#bootstrap-slider .layout-left {
    left: 0;
    right: 50%;
    margin-left: 60px;
}

#bootstrap-slider .carousel-caption {
    bottom: 12%;
}

#bootstrap-slider .carousel-caption p {
    background: rgba(0, 0, 0, .7);
}

#bootstrap-slider .carousel-control {
    left: 60px;
    bottom: 6%;
}

#bootstrap-slider .right.carousel-control {
    left: 100px;
}
#jp-relatedposts h3.jp-relatedposts-headline em {
    font-size: 22px;
    line-height: 19px;
    letter-spacing: 0px;
    font-weight: normal !important;
}

#jp-relatedposts h3.jp-relatedposts-headline {
    margin-bottom: 12px !important;
}

#jp-relatedposts .jp-relatedposts-items .jp-relatedposts-post .jp-relatedposts-post-title a {
font-size: 18px !important;
}

#slide_holder p {
    margin: 0 0 0;
}

#slide_holder .featured-title {
margin-bottom: 3px;
}

#slide_holder .featured-title {
 width:45%;
}

.table-1 tr:first-child {
 background-color: gray; 
 color: white;
 font-weight: bold;
}

.table-1 td:first-child {
 background-color: #f5f5f5;
}

.table-1 tr:first-child td:first-child {
 background-color: gray;
}

.woocommerce-menu-holder {
    float: left;
}

.container-menu {
    z-index: 3;
}

#search-text-top {
    position: absolute;
    right: 0;
}

#search-text-top:focus {
    position: absolute;
    right: 0px;
    left: initial;
}

.header .woocommerce-menu {
    margin-right: 20px;
    padding: 5px;
}

@media (max-width: 768px) {
    .header_v0 .title-container #logo a {
        padding: 0px;
    }
    #search-text-top {
        background: #fff !important;
        font-size: 12px;
        font-weight: normal;
        color: #888 !important;
    }
    .sc_menu {
        float: none;
        text-align: center;
    }
    #search-text-top {
        border: 1px solid #fff;
        height: 36px;
        width: 190px;
    }
    .woocommerce-menu-holder {
        float: none;
    }
    .header .woocommerce-menu {
        float: none;
        margin-right: 0;
    }
    .title-container #logo {
        float: none;
    }
    #righttopcolumn,
    #social,
    .header a,
    #tagline,
    #logo {
        width: auto;
        display: block;
    }
}

@media screen and (min-width: 1200px) {
    .header_v0 div#search-text-box {
        margin-right: 0px
    }
}

</style>
<link rel="stylesheet" id="crayon-css" href="./5. Putting it all together! – chillibasket_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-arduino-ide-css" href="./5. Putting it all together! – chillibasket_files/arduino-ide.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./5. Putting it all together! – chillibasket_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="redux-google-fonts-evl_options-css" href="./5. Putting it all together! – chillibasket_files/css" type="text/css" media="all">
<link rel="stylesheet" id="jetpack_css-css" href="./5. Putting it all together! – chillibasket_files/jetpack.css" type="text/css" media="all">
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/jquery.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/jquery-migrate.min.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/parallax.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/modernizr.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/carousel.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/tipsy.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/fields.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/jquery.infinite-scroll.min.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/jquery.scroll.pack.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/supersubs.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/superfish.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/buttons.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/ddslick.js.tải xuống"></script><style id="css-ddslick" type="text/css">.dd-select{ border-radius:2px; border:solid 1px #ccc; position:relative; cursor:pointer;}.dd-desc { color:#aaa; display:block; overflow: hidden; font-weight:normal; line-height: 1.4em; }.dd-selected{ overflow:hidden; display:block; padding:10px; font-weight:bold;}.dd-pointer{ width:0; height:0; position:absolute; right:10px; top:50%; margin-top:-3px;}.dd-pointer-down{ border:solid 5px transparent; border-top:solid 5px #000; }.dd-pointer-up{border:solid 5px transparent !important; border-bottom:solid 5px #000 !important; margin-top:-8px;}.dd-options{ border:solid 1px #ccc; border-top:none; list-style:none; box-shadow:0px 1px 5px #ddd; display:none; position:absolute; z-index:2000; margin:0; padding:0;background:#fff; overflow:auto;}.dd-option{ padding:10px; display:block; border-bottom:solid 1px #ddd; overflow:hidden; text-decoration:none; color:#333; cursor:pointer;-webkit-transition: all 0.25s ease-in-out; -moz-transition: all 0.25s ease-in-out;-o-transition: all 0.25s ease-in-out;-ms-transition: all 0.25s ease-in-out; }.dd-options > li:last-child > .dd-option{ border-bottom:none;}.dd-option:hover{ background:#f3f3f3; color:#000;}.dd-selected-description-truncated { text-overflow: ellipsis; white-space:nowrap; }.dd-option-selected { background:#f6f6f6; }.dd-option-image, .dd-selected-image { vertical-align:middle; float:left; margin-right:5px; max-width:64px;}.dd-image-right { float:right; margin-right:15px; margin-left:5px;}.dd-container{ position:relative;}​ .dd-selected-text { font-weight:bold}​</style>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/js"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/api.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/bootstrap.js.tải xuống"></script>
<script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/related-posts.js.tải xuống"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/wired.chillibasket.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/crayon.min.js.tải xuống"></script>
<link rel="https://api.w.org/" href="http://wired.chillibasket.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://wired.chillibasket.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://wired.chillibasket.com/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="The PID Controller" href="http://wired.chillibasket.com/2015/03/pid-controller/">
<link rel="next" title="My 3D Printer!" href="http://wired.chillibasket.com/2016/06/my-3d-printer/">

<link rel="canonical" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/">
<link rel="shortlink" href="http://wired.chillibasket.com/?p=299">
<link rel="alternate" type="application/json+oembed" href="http://wired.chillibasket.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwired.chillibasket.com%2F2015%2F10%2Fputting-it-all-together%2F">
<link rel="alternate" type="text/xml+oembed" href="http://wired.chillibasket.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwired.chillibasket.com%2F2015%2F10%2Fputting-it-all-together%2F&amp;format=xml">

<link rel="dns-prefetch" href="http://v0.wordpress.com/">
<link rel="dns-prefetch" href="http://jetpack.wordpress.com/">
<link rel="dns-prefetch" href="http://s0.wp.com/">
<link rel="dns-prefetch" href="http://s1.wp.com/">
<link rel="dns-prefetch" href="http://s2.wp.com/">
<link rel="dns-prefetch" href="http://public-api.wordpress.com/">
<link rel="dns-prefetch" href="http://0.gravatar.com/">
<link rel="dns-prefetch" href="http://1.gravatar.com/">
<link rel="dns-prefetch" href="http://2.gravatar.com/">
<style type="text/css">img#wpstats{display:none}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #d3d3d3; background-image: url("http://wired.chillibasket.com/wp-content/uploads/2014/08/grey-chevron-stripes-patterns-5.png"); background-position: left top; background-size: auto; background-repeat: repeat; background-attachment: fixed; }
</style>

<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article">
<meta property="og:title" content="Putting it all together!">
<meta property="og:url" content="http://wired.chillibasket.com/2015/10/putting-it-all-together/">
<meta property="og:description" content="Up until now we have looked at all of the individual topics behind self-balancing robots. In this final part of the tutorial, I’ll bring it all together and give you some guidelines to design…">
<meta property="article:published_time" content="2015-10-08T00:11:37+00:00">
<meta property="article:modified_time" content="2017-05-12T23:31:10+00:00">
<meta property="og:site_name" content="chillibasket">
<meta property="og:image" content="http://wired.chillibasket.com/wp-content/uploads/2015/10/BalancerDiagram1.jpg">
<meta property="og:image:width" content="700">
<meta property="og:image:height" content="412">
<meta property="og:locale" content="en_US">
<meta name="twitter:image" content="http://wired.chillibasket.com/wp-content/uploads/2015/10/BalancerDiagram1.jpg?w=640">
<meta name="twitter:card" content="summary_large_image">
<link rel="icon" href="http://wired.chillibasket.com/wp-content/uploads/2015/03/4e9d6895b4e9e70456edbdb2b46312aa1-550c5afcv1_site_icon-32x32.png" sizes="32x32">
<link rel="icon" href="http://wired.chillibasket.com/wp-content/uploads/2015/03/4e9d6895b4e9e70456edbdb2b46312aa1-550c5afcv1_site_icon-256x256.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="http://wired.chillibasket.com/wp-content/uploads/2015/03/4e9d6895b4e9e70456edbdb2b46312aa1-550c5afcv1_site_icon-256x256.png">
<meta name="msapplication-TileImage" content="http://wired.chillibasket.com/wp-content/uploads/2015/03/4e9d6895b4e9e70456edbdb2b46312aa1-550c5afcv1_site_icon.png">
<!-- BEGIN GADWP v5.1.2.2 Universal Analytics - https://deconf.com/google-analytics-dashboard-wordpress/ -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-68587581-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- END GADWP Universal Analytics -->

        <!--[if lt IE 9]>
        <link rel="stylesheet" type="text/css" href="http://wired.chillibasket.com/wp-content/themes/evolve/ie.css">
        <![endif]-->

    <script type="text/javascript" charset="UTF-8" src="./5. Putting it all together! – chillibasket_files/common.js.tải xuống"></script><script type="text/javascript" charset="UTF-8" src="./5. Putting it all together! – chillibasket_files/util.js.tải xuống"></script><script type="text/javascript" charset="UTF-8" src="./5. Putting it all together! – chillibasket_files/stats.js.tải xuống"></script><script type="text/javascript" charset="UTF-8" src="./5. Putting it all together! – chillibasket_files/geocoder.js.tải xuống"></script><style type="text/css"></style><link rel="stylesheet" type="text/css" id="gravatar-card-css" href="./5. Putting it all together! – chillibasket_files/hovercard.css"><link rel="stylesheet" type="text/css" id="gravatar-card-services-css" href="./5. Putting it all together! – chillibasket_files/services.css"></head><!--END head-->

      

    <!--BEGIN body-->
    <body class="post-template-default single single-post postid-299 single-format-standard custom-background">
                    <div id="wrapper">
                
            <div class="menu-back">
                                <div class="clearfix"></div>
            </div><!--/.menu-back-->

            <div id="top"></div>
            <!--BEGIN .header-pattern-->
<div class="header-pattern">
    <!--BEGIN .header-border-->

    <div class="header-border">
        <div class="header-border-sticky">
            <!--BEGIN .header-->
            <div class="header">
                <!--BEGIN .container-header-->
                <div class="container container-header header_v0">
                    <!--BEGIN #righttopcolumn-->
                    <div id="righttopcolumn">
                                                    <!--BEGIN #subscribe-follow-->
                            <div id="social">
                                   

<ul class="sc_menu">
       
        <li><a target="_blank" href="http://wired.chillibasket.com/feed/rss/" class="tipsytext" id="rss" name="RSS Feed"><i class="t4p-icon-social-rss"></i></a></li>
                       <li><a target="_blank" href="https://www.youtube.com/user/simonbluett" class="tipsytext" id="youtube" name="YouTube"><i class="t4p-icon-social-youtube"></i></a></li>
        </ul>                                        
                            </div>
                            <!--END #subscribe-follow-->
                                            </div>
                    <!--END #righttopcolumn-->

                                        <!--BEGIN .title-container-->
                    <div class="title-container ">
                                                         <div id="logo"><a href="http://wired.chillibasket.com/">chillibasket</a></div>
                            <div id="tagline">A Student Technology Blog</div>                        
                    </div>
                    <!--END .title-container-->
                </div>
                <!--END .container-header-->
            </div>
            <!--END .header-->
        </div>
    </div>
    <!--END .header-border-->
</div>
<!--END .header-pattern-->
<div class="menu-container header_v0">
    
        <div class="menu-header">
            <div class="menu-header-sticky">
                <!--BEGIN .container-menu-->
                <div class="container nacked-menu container-menu">
                                            <div class="primary-menu">
                            <nav class="nav nav-holder link-effect"><div class="menu-wired-menu-container"><ul id="menu-wired-menu" class="nav-menu sf-js-enabled sf-arrows"><li id="menu-item-22" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-22"><a href="http://wired.chillibasket.com/"><span data-hover="Home">Home</span></a></li>
<li id="menu-item-24" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24"><a href="http://wired.chillibasket.com/tutorials/"><span data-hover="Tutorials">Tutorials</span></a></li>
<li id="menu-item-23" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23"><a href="http://wired.chillibasket.com/about/"><span data-hover="About">About</span></a></li>
</ul></div>                            <div id="undefined" class="dd-container" style="width: 100%;"><div class="dd-select" style="width: 100%;"><input class="dd-selected-value" type="hidden" value=""><a class="dd-selected"><label class="dd-selected-text"><span class="t4p-icon-menu"></span></label></a></div><ul class="dd-options dd-click-off-close" style="width: 100%;"><li><a class="dd-option dd-option-selected"> <label class="dd-option-text"><span class="t4p-icon-menu"></span></label></a></li><li><a class="dd-option"> <input class="dd-option-value" type="hidden" value="http://wired.chillibasket.com/"> <label class="dd-option-text">Home</label></a></li><li><a class="dd-option"> <input class="dd-option-value" type="hidden" value="http://wired.chillibasket.com/tutorials/"> <label class="dd-option-text">Tutorials</label></a></li><li><a class="dd-option"> <input class="dd-option-value" type="hidden" value="http://wired.chillibasket.com/about/"> <label class="dd-option-text">About</label></a></li></ul></div></nav>
                        </div><!-- /.primary-menu -->
                                                    <!--BEGIN #searchform-->
                            <form action="http://wired.chillibasket.com/" method="get" class="searchform">
                                <div id="search-text-box">
                                    <label class="searchfield" id="search_label_top" for="search-text-top"><input id="search-text-top" type="text" tabindex="1" name="s" class="search" placeholder="Type your search"></label>
                                </div>
                            </form>
                            <div class="clearfix"></div>
                            <!--END #searchform-->
                            <header id="header" class="sticky-header  container row sticky" style="">
    <div class="container">
                <div class="sticky-menubar col-md-9 col-sm-9">    
            <nav class="nav nav-holder link-effect"><div class="menu-wired-menu-container"><ul id="menu-wired-menu-1" class="nav-menu sf-js-enabled sf-arrows"><li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-22"><a href="http://wired.chillibasket.com/"><span data-hover="Home">Home</span></a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-24"><a href="http://wired.chillibasket.com/tutorials/"><span data-hover="Tutorials">Tutorials</span></a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-23"><a href="http://wired.chillibasket.com/about/"><span data-hover="About">About</span></a></li>
</ul></div>            </nav>
        </div>            
                    <!--BEGIN #searchform-->
            <form action="http://wired.chillibasket.com/" method="get" class="stickysearchform">
                <div id="stickysearch-text-box" class="col-md-2 col-sm-2">
                    <label class="searchfield" id="stickysearch_label" for="search-stickyfix"><input id="search-stickyfix" type="text" tabindex="1" name="s" class="search" placeholder="Type your search"></label>
                </div>
            </form>
            <div class="clearfix"></div>
            <!--END #searchform-->
                    
    </div>
</header>                                    </div><!-- /.container -->
            </div><!-- /.menu-header -->
        </div>
        </div>              
            <div class="menu-container">
                                    <div class="menu-back">
                        <div class="sliderblock">
    </div><!--/.sliderblock-->                        <div style="clear:both;"></div> 

                                                                        
                    </div><!--/.menu-back-->
                    
                <!--BEGIN .content-->
                <div class="content chillibasket_wiredsingular single s-category-self-balancing s-category-tutorial s-tag-accelerometer s-tag-arduino s-tag-balancing s-tag-mpu6050 s-tag-self-balancing s-tag-stabilisation s-tag-tutorial s-author-none">
                                        <!--BEGIN .container-->
                    <div class="container container-center row">
                        <!--BEGIN #content-->
                        <div id="content">
                            
<!--BEGIN #primary .hfeed-->
<div id="primary" class=" col-xs-12 col-sm-6 col-md-8 col-md-8 col-single col-single">

    <ul class="breadcrumbs"><li><a class="home" href="http://wired.chillibasket.com/">Home</a></li><li><a href="http://wired.chillibasket.com/category/tutorial/" title="Tutorial">Tutorial</a></li> <li><a href="http://wired.chillibasket.com/category/tutorial/self-balancing/" title="Self-balancing">Self-balancing</a></li><li>Putting it all together!</li></ul>
            <!--BEGIN .hentry-->
            <div id="post-299" class="post-299 post type-post status-publish format-standard has-post-thumbnail hentry category-self-balancing category-tutorial tag-accelerometer tag-arduino tag-balancing tag-mpu6050 tag-self-balancing tag-stabilisation tag-tutorial p publish first-post cat tag">

                                        <h1 class="entry-title">Putting it all together!</h1>
                    
                    <!--BEGIN .entry-meta .entry-header-->
                    <div class="entry-meta entry-header">

                        <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/"><span class="published updated">October 8, 2015</span></a>

                                                    <span class="comment-count"><a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comments">61 Comments</a></span>
                            
                        <span class="author vcard">
                            Written by <strong><a class="url fn" href="http://wired.chillibasket.com/author/chillibasket_wired/" title="View all posts by Simon B.">Simon B.</a></strong>
                        </span>
                                              
                        <!--END .entry-meta .entry-header-->
                    </div> 

                    
                <!--BEGIN .entry-content .article-->
                <div class="entry-content article">

                    <p><img data-attachment-id="345" data-permalink="http://wired.chillibasket.com/2015/10/putting-it-all-together/self-balancing-part-5/" data-orig-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Self-balancing-Part-5.jpg" data-orig-size="1200,450" data-comments-opened="0" data-image-meta="{&quot;aperture&quot;:&quot;4.2&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;NIKON D3100&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1408559911&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;26&quot;,&quot;iso&quot;:&quot;400&quot;,&quot;shutter_speed&quot;:&quot;0.05&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Self-balancing Part 5" data-image-description="" data-medium-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Self-balancing-Part-5-300x113.jpg" data-large-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Self-balancing-Part-5-1024x384.jpg" class="alignleft size-full wp-image-345 img-responsive" src="./5. Putting it all together! – chillibasket_files/Self-balancing-Part-5.jpg" alt="Self-balancing Part 5" width="1200" height="450" srcset="http://wired.chillibasket.com/wp-content/uploads/2015/10/Self-balancing-Part-5.jpg 1200w, http://wired.chillibasket.com/wp-content/uploads/2015/10/Self-balancing-Part-5-300x113.jpg 300w, http://wired.chillibasket.com/wp-content/uploads/2015/10/Self-balancing-Part-5-1024x384.jpg 1024w" sizes="(max-width: 1200px) 100vw, 1200px"></p>
<p>Up until now we have looked at all of the individual&nbsp;topics behind self-balancing robots. In this final part of the tutorial, I’ll bring it all together and&nbsp;give you some guidelines to designing and assembling your own robot!</p>
<p>&nbsp;</p>
<hr>
<h4>Designing the&nbsp;Robot</h4>
<p><span style="text-decoration: underline;"><em><strong>Weight Distribution:</strong></em></span> Self-balancing robots work on the principle of an inverted pendulum. This means that the system is most stable when all of the mass is positioned as high as possible. This seems to go against common sense; usually systems are more stable when they have a low centre of gravity. In this case keeping the mass on top increases the inertia of the system, meaning that the robot has more time to&nbsp;respond to changes in balance. Therefore my first recommendation is to place the heaviest objects, such as the battery, at the top of the robot.</p>
<p><span style="color: #000000;"><em><strong><span style="text-decoration: underline;">Sensor Positioning:</span>&nbsp;</strong></em></span>The positioning of the accelerometer/gyroscope module is also important. When I was demonstrating&nbsp;my balancing robot at the Dublin Maker Faire this year, I asked a number of people where they think the sensor should be positioned. Most guessed that it should be on top, as this is where it would record&nbsp;the largest amount of&nbsp;movement!</p>
<p>We actually want to avoid as much of this translational movement as possible, as we are only interested in the rotation of the robot.&nbsp;Therefore the sensor should be placed exactly on the axis of rotation, between both wheels. Placing the sensor&nbsp;further up on the frame introduces noise and jitter into the readings, and may cause a feedback loop (similar to the squeaking noise made when a microphone is too close to its own speaker).</p>
<p><em><strong><span style="text-decoration: underline;">Frame Design:</span>&nbsp;</strong></em>For the rest of the frame, it is up to your own imagination what you want to do with it. I’ve included&nbsp;a couple of pictures and sketches below to help you come up with your own designs. Although I 3D printed two of my frames, I made my first&nbsp;prototype out of lollipop sticks (and it worked really well)!</p>
<p>&nbsp;</p>
<div class="tiled-gallery type-rectangular" data-original-width="610" data-carousel-extra="{&quot;blog_id&quot;:1,&quot;permalink&quot;:&quot;http:\/\/wired.chillibasket.com\/2015\/10\/putting-it-all-together\/&quot;,&quot;likes_blog_id&quot;:73605368}" itemscope="" itemtype="http://schema.org/ImageGallery"> <div class="gallery-row" style="width: 607px; height: 719px;" data-original-width="610" data-original-height="723"> <div class="gallery-group images-2" style="width: 235px; height: 719px;" data-original-width="237" data-original-height="723"> <div class="tiled-gallery-item tiled-gallery-item-small" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/lollipop-balancer/" border="0" itemprop="url"> <meta itemprop="width" content="233"> <meta itemprop="height" content="333"> <img data-attachment-id="322" data-orig-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Lollipop-Balancer.jpg" data-orig-size="699,1000" data-comments-opened="" data-image-meta="{&quot;aperture&quot;:&quot;5.3&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;NIKON D3100&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1420723585&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;40&quot;,&quot;iso&quot;:&quot;400&quot;,&quot;shutter_speed&quot;:&quot;0.04&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Lollipop-Balancer" data-image-description="" data-medium-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Lollipop-Balancer-210x300.jpg" data-large-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Lollipop-Balancer.jpg" src="./5. Putting it all together! – chillibasket_files/Lollipop-Balancer.jpg" width="233" height="333" data-original-width="233" data-original-height="333" itemprop="http://schema.org/image" title="Lollipop-Balancer" alt="Lollipop-sticks Prototype" style="width: 231px; height: 331px;" class="img-responsive"> </a> <div class="tiled-gallery-caption" itemprop="caption description" style="display: none;"> Lollipop-sticks Prototype </div> </div> <div class="tiled-gallery-item tiled-gallery-item-small" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/gen1-balancer/" border="0" itemprop="url"> <meta itemprop="width" content="233"> <meta itemprop="height" content="382"> <img data-attachment-id="324" data-orig-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Gen1-Balancer.jpg" data-orig-size="610,1000" data-comments-opened="" data-image-meta="{&quot;aperture&quot;:&quot;5.6&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;NIKON D3100&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1420719619&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;55&quot;,&quot;iso&quot;:&quot;640&quot;,&quot;shutter_speed&quot;:&quot;0.066666666666667&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Gen1 Balancer" data-image-description="" data-medium-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Gen1-Balancer-183x300.jpg" data-large-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Gen1-Balancer.jpg" src="./5. Putting it all together! – chillibasket_files/Gen1-Balancer.jpg" width="233" height="382" data-original-width="233" data-original-height="382" itemprop="http://schema.org/image" title="Gen1 Balancer" alt="Self-balancing Robot (Gen1)" style="width: 231px; height: 380px;" class="img-responsive"> </a> <div class="tiled-gallery-caption" itemprop="caption description" style="display: none;"> Self-balancing Robot (Gen1) </div> </div> </div> <!-- close group --> <div class="gallery-group images-2" style="width: 371px; height: 719px;" data-original-width="373" data-original-height="723"> <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/gen2-balancer/" border="0" itemprop="url"> <meta itemprop="width" content="369"> <meta itemprop="height" content="498"> <img data-attachment-id="326" data-orig-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Gen2-Balancer.jpg" data-orig-size="667,900" data-comments-opened="" data-image-meta="{&quot;aperture&quot;:&quot;4&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;NIKON D3100&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1439325523&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;24&quot;,&quot;iso&quot;:&quot;720&quot;,&quot;shutter_speed&quot;:&quot;0.066666666666667&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="Gen2 Balancer" data-image-description="" data-medium-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Gen2-Balancer-222x300.jpg" data-large-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/Gen2-Balancer.jpg" src="./5. Putting it all together! – chillibasket_files/Gen2-Balancer.jpg" width="369" height="498" data-original-width="369" data-original-height="498" itemprop="http://schema.org/image" title="Gen2 Balancer" alt="Self-balancing Robot (Gen2)" style="width: 367px; height: 495px;" class="img-responsive"> </a> <div class="tiled-gallery-caption" itemprop="caption description" style="display: none;"> Self-balancing Robot (Gen2) </div> </div> <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/balancerdiagram1/" border="0" itemprop="url"> <meta itemprop="width" content="369"> <meta itemprop="height" content="217"> <img data-attachment-id="328" data-orig-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/BalancerDiagram1.jpg" data-orig-size="700,412" data-comments-opened="" data-image-meta="{&quot;aperture&quot;:&quot;5.3&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;NIKON D3100&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;1444247786&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;42&quot;,&quot;iso&quot;:&quot;400&quot;,&quot;shutter_speed&quot;:&quot;0.016666666666667&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="BalancerDiagram1" data-image-description="" data-medium-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/BalancerDiagram1-300x177.jpg" data-large-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/BalancerDiagram1.jpg" src="./5. Putting it all together! – chillibasket_files/BalancerDiagram1.jpg" width="369" height="217" data-original-width="369" data-original-height="217" itemprop="http://schema.org/image" title="BalancerDiagram1" alt="Schematic Diagram" style="width: 367px; height: 215px;" class="img-responsive"> </a> <div class="tiled-gallery-caption" itemprop="caption description" style="display: none;"> Schematic Diagram </div> </div> </div> <!-- close group --> </div> <!-- close row --> </div>
<p>&nbsp;</p>
<hr>
<h4>Assembling the Frame</h4>
<p>Putting together the frame and&nbsp;electronics is actually the easiest part of the project! Once you have your frame designed and ready to go, all you have to do is stick/screw all of the components together. Here is a schematic I made to help you with the wiring of the robot:</p>
<p>&nbsp;</p>
<div class="tiled-gallery type-rectangular" data-original-width="610" data-carousel-extra="{&quot;blog_id&quot;:1,&quot;permalink&quot;:&quot;http:\/\/wired.chillibasket.com\/2015\/10\/putting-it-all-together\/&quot;,&quot;likes_blog_id&quot;:73605368}" itemscope="" itemtype="http://schema.org/ImageGallery"> <div class="gallery-row" style="width: 607px; height: 350px;" data-original-width="610" data-original-height="352"> <div class="gallery-group images-2" style="width: 200px; height: 350px;" data-original-width="201" data-original-height="352"> <div class="tiled-gallery-item tiled-gallery-item-small" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/overal-assembly-diagram/" border="0" itemprop="url"> <meta itemprop="width" content="197"> <meta itemprop="height" content="213"> <img data-attachment-id="317" data-orig-file="http://wired.chillibasket.com/wp-content/uploads/2015/09/overal-assembly-diagram.jpg" data-orig-size="744,800" data-comments-opened="" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="overal-assembly-diagram" data-image-description="" data-medium-file="http://wired.chillibasket.com/wp-content/uploads/2015/09/overal-assembly-diagram-279x300.jpg" data-large-file="http://wired.chillibasket.com/wp-content/uploads/2015/09/overal-assembly-diagram.jpg" src="./5. Putting it all together! – chillibasket_files/overal-assembly-diagram.jpg" width="197" height="213" data-original-width="197" data-original-height="213" itemprop="http://schema.org/image" title="overal-assembly-diagram" alt="Assembly Diagram" style="width: 196px; height: 211px;" class="img-responsive"> </a> <div class="tiled-gallery-caption" itemprop="caption description" style="display: none;"> Assembly Diagram </div> </div> <div class="tiled-gallery-item tiled-gallery-item-small" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/balancing-schematic-1/" border="0" itemprop="url"> <meta itemprop="width" content="197"> <meta itemprop="height" content="131"> <img data-attachment-id="371" data-orig-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/balancing-schematic-1.jpg" data-orig-size="1250,831" data-comments-opened="" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="balancing-schematic-1" data-image-description="" data-medium-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/balancing-schematic-1-300x199.jpg" data-large-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/balancing-schematic-1-1024x681.jpg" src="./5. Putting it all together! – chillibasket_files/balancing-schematic-1.jpg" width="197" height="131" data-original-width="197" data-original-height="131" itemprop="http://schema.org/image" title="balancing-schematic-1" alt="balancing-schematic-1" style="width: 196px; height: 130px;" class="img-responsive"> </a> </div> </div> <!-- close group --> <div class="gallery-group images-1" style="width: 406px; height: 350px;" data-original-width="409" data-original-height="352"> <div class="tiled-gallery-item tiled-gallery-item-large" itemprop="associatedMedia" itemscope="" itemtype="http://schema.org/ImageObject"> <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/balancing-schematic-2/" border="0" itemprop="url"> <meta itemprop="width" content="405"> <meta itemprop="height" content="348"> <img data-attachment-id="372" data-orig-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/balancing-schematic-2.jpg" data-orig-size="1000,859" data-comments-opened="" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;1&quot;}" data-image-title="balancing-schematic-2" data-image-description="" data-medium-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/balancing-schematic-2-300x258.jpg" data-large-file="http://wired.chillibasket.com/wp-content/uploads/2015/10/balancing-schematic-2.jpg" src="./5. Putting it all together! – chillibasket_files/balancing-schematic-2.jpg" width="405" height="348" data-original-width="405" data-original-height="348" itemprop="http://schema.org/image" title="balancing-schematic-2" alt="balancing-schematic-2" style="width: 402px; height: 346px;" class="img-responsive"> </a> </div> </div> <!-- close group --> </div> <!-- close row --> </div>
<hr>
<h4>Combined Program</h4>
<p>In the previous parts of the tutorial I included snippets of code to show you how each part of the self-balancing robot should work. Here I have compiled all of the parts together into one code that you can use and modify for your own robot. I included a horrendous amount of comments, so that the program is as easy to follow as possible!</p>
<p><em>Note: This code is programmed for the specific components I was using, such as an Arduino motor shield, and the MPU6050 Accel-Gyro module.</em></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a01d678a36d9492413430" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title">Self-Balancing Robot Code</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">C</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">/* * * * * * * * * * * * * * * * * * * * * *
 * SELF-BALANCING ROBOT
 * =========================================
 *
 * Code by: Simon Bluett
 * Email: hello@chillibasket.com
 * Website: wired.chillibasket.com
 *
 * 7/10/15, Version 2.0
 *
 * Here are some hints when you try to use this code:
 *
 *  &gt; Ensure pin-mapping is correct for your robot (line 54)
 *  &gt; Ensure calibration values are correct for your sensor (line 181)
 *  &gt; Uncomment (line 700) in order to see if your sensor is working
 *  &gt; Play with your PID values on (line 93)
 *  &gt; Ensure that your left &amp; right motors aren't inverted (line 355)
 *  &gt; Confirm whether you want the Pitch ypr[1] or Roll ypr[2] sensor readings!
 * * * * * * * * * * * * * * * * * * * * * */


/* * * * * * * * * * * * * * * * * * * * * *
 *  This Demo makes use of the I2Cdev and MPU6050 libraries, and the demonstration
 *  sketch written by (Jeff Rowberg &lt;jeff@rowberg.net&gt;), modified to work
 *  with the Intel Galileo Development Board:
 *  -- -- -- -- -- -- -- -- -- -- -- -- -- --
 *  I2Cdev device library code is placed under the MIT license
 *  Copyright (c) 2012 Jeff Rowberg
 *  Permission is hereby granted, free of charge, to any person obtaining a copy
 *  of this software and associated documentation files (the "Software"), to deal
 *  in the Software without restriction, including without limitation the rights
 *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 *  copies of the Software, and to permit persons to whom the Software is
 *  furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included in
 *  all copies or substantial portions of the Software.
 * * * * * * * * * * * * * * * * * * * * * */



// I2Cdev and MPU6050 must be installed as libraries, or else the .cpp/.h files
// for both classes must be in the include path of your project
#include &lt;I2Cdev.h&gt;
#include &lt;MPU6050_6Axis_MotionApps20.h&gt;
#include &lt;Wire.h&gt;

// Specific I2C addresses may be passed as a parameter here
MPU6050 mpu;        			// Default: AD0 low = 0x68


// Define the pin-mapping
// -- -- -- -- -- -- -- -- -- -- -- -- -- --
#define DIR_A 12                // Direction Pin, Motor A
#define DIR_B 13                // Direction Pin, Motor B
#define PWM_A 3                 // PWM, Motor A (Left Motor)
#define PWM_B 11                // PWM, Motor B (Right Motor)
#define BRK_A 9                 // Brake, Motor A
#define BRK_B 8                 // Brake, Motor B

#define BTN_1 10                 // On/Off Button
#define BTN_2 7                 // Set Centre of Gravity Button

#define LED_1 5                 // Low-battery Warning LED
#define LED_2 4                // Current mode LED


// Max PWM parameters
#define MAX_TURN 30


// MPU Control/Status
// -- -- -- -- -- -- -- -- -- -- -- -- -- --
bool dmpReady = false;         	// Set true if DMP init was successful
uint8_t devStatus;              // Return status after device operation (0 = success, !0 = error)
uint8_t mpuIntStatus;           // Holds actual interrupt status byte from MPU
uint16_t packetSize;            // Expected DMP packet size (default is 42 bytes)
uint16_t fifoCount;             // Count of all bytes currently in FIFO
uint8_t fifoBuffer[64];         // FIFO storage buffer


// Orientation/Motion
// -- -- -- -- -- -- -- -- -- -- -- -- -- --
Quaternion q;                   // [w, x, y, z]       Quaternion Container
VectorFloat gravity;           	// [x, y, z]            Gravity Vector
int16_t gyro[3];               	// [x, y, z]            Gyro Vector
float ypr[3];                   // [yaw, pitch, roll]   Yaw/Pitch/Roll &amp; gravity vector
float averagepitch[50];        	// Used for averaging pitch value


// For PID Controller
// -- -- -- -- -- -- -- -- -- -- -- -- -- --
float Kp = 8;                   // (P)roportional Tuning Parameter
float Ki = 2;					// (I)ntegral Tuning Parameter        
float Kd = 5;					// (D)erivative Tuning Parameter       
float lastpitch;                // Keeps track of error over time
float iTerm;              		// Used to accumulate error (integral)
float targetAngle = 2.1;       	// Can be adjusted according to centre of gravity 

// You can Turn off YAW control, by setting
// the Tp and Td constants below to 0.
float Tp = 0.6;        			// Yaw Proportional Tuning Parameter
float Td = 0.1;					// Yaw Derivative Tuning Parameter
float targetYaw = 0;            // Used to maintain the robot's yaw
float lastYawError = 0;

float PIDGain = 0;				// Used for soft start (prevent jerking at initiation)


// Motor Control
// -- -- -- -- -- -- -- -- -- -- -- -- -- --
int direction_A = 0;            // 0 - Forwards, 1 - Backwards
int direction_B = 0;            //
int brake_A = 1;                // 1 - On, 0 - Off
int brake_B = 1;                //


// Runtime variables
// -- -- -- -- -- -- -- -- -- -- -- -- -- --
int modeSelect = 1;             // System Mode (0 = off, 1 = normal, 2 = guided)
bool initialised = true;        // Is the balancing system on?

char inchar = 0;                // Hold any incoming characters
float angular_rate = 0;         // Used to make sure rate is ~0 when balance mode is initiated

bool newCalibration = false;	// If set TRUE, the target angles are recalibrated


// Variables used for timing control
// Aim is 10ms per cycle (100Hz)
// -- -- -- -- -- -- -- -- -- -- -- -- -- --
#define STD_LOOP_TIME 9

unsigned long loopStartTime = 0;
unsigned long lastTime;             // Time since PID was called last (should be ~10ms)

// 0 = Off, 1 = On
int modes = 0;



// ------------------------------------------------------------------
// 					      INITIAL SETUP
// ------------------------------------------------------------------

void setup() {

    Wire.begin();

    // Initialize serial communication for debugging
    Serial.begin(115200);
	
	 // Configure LED for output
    pinMode(LED_1, OUTPUT);
    pinMode(LED_2, OUTPUT);

    digitalWrite(LED_1, LOW);
    digitalWrite(LED_2, LOW);

    // Set as input, internal pullup for buttons
    pinMode(BTN_1, INPUT_PULLUP);
    pinMode(BTN_2, INPUT_PULLUP);

    // Configure Motor I/O
    pinMode(DIR_A, OUTPUT);     // Left Motor Direction
    pinMode(DIR_B, OUTPUT);     // Right Motor Direction
    pinMode(BRK_A, OUTPUT);     // Left Motor Brake
    pinMode(BRK_B, OUTPUT);     // Right Motor Brake

    // Initialize MPU6050
    mpu.initialize();
    Serial.println("Testing MPU connection:");

    Serial.println(mpu.testConnection() ? "&gt; MPU6050 connection successful" : "&gt; MPU6050 connection failed");
    Serial.println("Initialising DMP");
    devStatus = mpu.dmpInitialize();

    /* * * * * * * * * * * * * * * * * * * *
     * IMPORTANT!
     * Supply your own MPU6050 offsets here
     * Otherwise robot will not balance properly.
     * * * * * * * * * * * * * * * * * * * */
    mpu.setXGyroOffset(93);
    mpu.setYGyroOffset(-15);
    mpu.setZGyroOffset(30);
    mpu.setXAccelOffset(-2500);
    mpu.setYAccelOffset(1783);
    mpu.setZAccelOffset(877);

    // Make sure it worked (returns 0 if so)
    if (devStatus == 0) {
        Serial.println("Enabling DMP");
        mpu.setDMPEnabled(true);
        mpuIntStatus = mpu.getIntStatus();

        // Set our DMP Ready flag so the main loop() function knows it's okay to use it
        Serial.println("DMP Ready! Let's Proceed.");
        Serial.println("Robot is now ready to balance. Hold the robot steady");
        Serial.println("in a vertical position, and the motors should start.");
        dmpReady = true;
        packetSize = mpu.dmpGetFIFOPacketSize();

    } else {
		// In case of an error with the DMP
        if(devStatus == 1) Serial.println("&gt; Initial Memory Load Failed");
        else if (devStatus == 2) Serial.println("&gt; DMP Configuration Updates Failed");
    }

}



// -------------------------------------------------------------------
// 			 PID CONTROLLER
// -------------------------------------------------------------------

int PID(float pitch) {            

    // Calculate time since last time PID was called (~10ms)
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    unsigned long thisTime = millis();
    float timeChange = float(thisTime - lastTime);

    // Calculate Error
    float error = targetAngle - pitch;


    // Calculate our PID terms
    // PID values are multiplied/divided by 10 in order to allow the
    // constants to be numbers between 0-10.
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    float pTerm = Kp * error * 10;
    iTerm += Ki * error * timeChange / 10;  
    float dTerm = Kd * (pitch - lastpitch) / timeChange * 100; 
	
	if (Ki == 0) iTerm = 0;
    lastpitch = pitch;
    lastTime = thisTime;


    // Obtain PID output value
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    float PIDValue = pTerm + iTerm - dTerm;

    // Set a minimum speed (motors will not move below this - can help to reduce latency)
    //if(PIDValue &gt; 0) PIDValue = PIDValue + 10;
    //if(PIDValue &lt; 0) PIDValue = PIDValue - 10;

	// Limit PID value to maximum PWM values
    if (PIDValue &gt; 255) PIDValue = 255;
    else if (PIDValue &lt; -255) PIDValue = -255; 

    return int(PIDValue);

}



// -------------------------------------------------------------------
// 			 YAW CONTROLLER
// -------------------------------------------------------------------

int yawPD(int yawError) {            


    // Calculate our PD terms
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    float pTerm = Tp * yawError;
    float dTerm = Kd * (yawError - lastYawError) / 10; 
	
    lastYawError = yawError;

    // Obtain PD output value
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    int yawPDvalue = int(-pTerm + dTerm);

	// Limit PD value to maximum
    if (yawPDvalue &gt; MAX_TURN) yawPDvalue = MAX_TURN;
    else if (yawPDvalue &lt; -MAX_TURN) yawPDvalue = -MAX_TURN; 

    //Serial.print("Error: ");
    //Serial.print(yawError);
    //Serial.print(" - PD: ");
    //Serial.println(yawPDvalue);
    return yawPDvalue;

}



// -------------------------------------------------------------------
// 			 	MOVEMENT CONTROLLER
// -------------------------------------------------------------------
// This function calculate the PWM output required to keep the robot 
// balanced, to move it back and forth, and to control the yaw.

void MoveControl(int pidValue, float yaw){
	
    // Set both motors to this speed
    int left_PWM = pidValue;
    int right_PWM = pidValue;


    /* YAW CONTROLLER */

    // Check if turning left or right is faster
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    int leftTurn, rightTurn;

    float newYaw = targetYaw;

    if((yaw &gt; 0) &amp;&amp; (newYaw &lt; 0)){
        rightTurn = yaw + abs(newYaw);
        leftTurn = (180 - yaw) + (180 - abs(newYaw));

    } else if ((yaw &lt; 0) &amp;&amp; (newYaw &gt; 0)){
        rightTurn = (180 - abs(yaw)) + (180 - newYaw);
        leftTurn = abs(yaw) + newYaw;

    } else if (((yaw &gt; 0) &amp;&amp; (newYaw &gt; 0)) || ((yaw &lt; 0) &amp;&amp; (newYaw &lt; 0))){
        rightTurn = newYaw - yaw;

        if (rightTurn &gt; 0){
            leftTurn = rightTurn;
            rightTurn = 360 - leftTurn;
        } else if (rightTurn &lt; 0){
            rightTurn = abs(rightTurn);
            leftTurn = 360 - abs(rightTurn);
        } else if (rightTurn == 0){
            rightTurn = leftTurn = 0;
        }
    }

    // Apply yaw PD controller to motor output
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    if ((leftTurn == 0) &amp;&amp; (rightTurn == 0)){
        // Do nothing
    } else if (leftTurn &lt;= rightTurn){
    	leftTurn = yawPD(leftTurn);
        left_PWM = left_PWM - leftTurn;
        right_PWM = right_PWM + leftTurn;

    } else if (rightTurn &lt; leftTurn){
        rightTurn = yawPD(rightTurn);
        left_PWM = left_PWM + rightTurn;
        right_PWM = right_PWM - rightTurn;
        
    }


    // Limits PID to max motor speed
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    if (left_PWM &gt; 255) left_PWM = 255;
    else if (left_PWM &lt; -255) left_PWM = -255; 
    if (right_PWM &gt; 255) right_PWM = 255;
    else if (right_PWM &lt; -255) right_PWM = -255; 

    // Send command to left motor
    if (left_PWM &gt;= 0) Move(0, 0, int(left_PWM));   	// '0' = Left-motor, '1' = Right-motor
    else Move(0, 1, (int(left_PWM) * -1));
	// Send command to right motor
    if (right_PWM &gt;= 0) Move(1, 1, int(right_PWM)); 	// '0' = Forward, '1' = Backward
    else Move(1, 0, (int(right_PWM) * -1));    

}



// -------------------------------------------------------------------
// 			 MOTOR CONTROLLER
// -------------------------------------------------------------------

void Move(int motor, int direction, int speed) {            

	// Left Motor
	// -- -- -- -- -- -- -- -- -- -- -- -- -- --
	if (motor == 0){
	
		// Set motor direction (only if it is currently not that direction)
		if (direction == 0){
            if (direction_A == 1) digitalWrite(DIR_A, HIGH);		// Forwards
			direction_A = 0;
		} else {
			if (direction_A == 0)  digitalWrite(DIR_A, LOW);		// Backwards
			direction_A = 1;
		}
        
		// Release brake (only if brake is active)
		if (brake_A == 1){
			digitalWrite(BRK_A, LOW);
			brake_A = 0;
		}
		
		// Send PWM data to motor A
		analogWrite(PWM_A, speed);


    // Right Motor
	// -- -- -- -- -- -- -- -- -- -- -- -- -- --
    } else if (motor == 1){
	
		// Set motor direction (only if it is currently not that direction)
		if (direction == 0){
			if (direction_B == 1) digitalWrite(DIR_B, HIGH);		// Forwards
			direction_B = 0;
		} else {
			if (direction_B == 0)  digitalWrite(DIR_B, LOW);		// Backwards
			direction_B = 1;
		}
        
		// Release brake (only if brake is active)
		if (brake_B == 1){
			digitalWrite(BRK_B, LOW);
			brake_B = 0;
		}
		
		// Send PWM data to motor A
		analogWrite(PWM_B, speed);


    // Stop both motors
	// -- -- -- -- -- -- -- -- -- -- -- -- -- --
    } else if (motor = 3){  

        analogWrite(PWM_A, 0);
        analogWrite(PWM_B, 0);
        digitalWrite(BRK_A, HIGH);
        digitalWrite(BRK_B, HIGH);
        brake_A = 1;
        brake_B = 1;

    }
}



// -------------------------------------------------------------------
// 			 READ INPUT FROM SERIAL
// -------------------------------------------------------------------

void readSerial() {

    // Initiate all of the variables
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
	int changestate = 0;		// Which action needs to be taken?
	int no_before = 0;			// Numbers before decimal point
	int no_after = 0;			// Numbers after decimal point
	bool minus = false;			// See if number is negative
	inchar = Serial.read();		// Read incoming data

    if (inchar == 'P') changestate = 1;
    else if (inchar == 'I') changestate = 2;
    else if (inchar == 'D') changestate = 3;

    // Tell robot to calibrate the Centre of Gravity
    else if (inchar == 'G') calibrateTargets();


    // Records all of the incoming data (format: 00.000)
    // And converts the chars into a float number
    if (changestate &gt; 0){
        if (Serial.available() &gt; 0){

            // Is the number negative?
            inchar = Serial.read();
            if(inchar == '-'){
                minus = true;
                inchar = Serial.read();
            }
            no_before = inchar - '0';

            if (Serial.available() &gt; 0){
                inchar = Serial.read();

                if (inchar != '.'){
                    no_before = (no_before * 10) + (inchar - '0');

                    if (Serial.available() &gt; 0){
                        inchar = Serial.read();
                    }
                }

                if (inchar == '.'){
                    inchar = Serial.read();
                    if (inchar != '0'){
                        no_after = (inchar - '0') * 100;
                    }

                    if (Serial.available() &gt; 0){
                        inchar = Serial.read();
                        if (inchar != '0'){
                            no_after = no_after + ((inchar - '0') * 10);
                        }

                        if (Serial.available() &gt; 0){
                            inchar = Serial.read();
                            if (inchar != '0'){
                                no_after = no_after + (inchar - '0');
                            }
                        }
                    }
                }
            }

            // Combine the chars into a single float
            float answer = float(no_after) / 1000;
            answer = answer + no_before;
            if (minus) answer = answer * -1;

            // Update the PID constants
            if (changestate == 1){
                Kp = answer;
                Serial.print("P - ");
            } else if (changestate == 2){
                Ki = answer;
                Serial.print("I - ");
            } else if (changestate == 3){ 
                Kd = answer;
                Serial.print("D - ");
            }
            Serial.print("Constant Set: ");
            Serial.println(answer, 3);

        } else {
            changestate = 0;
        }
    }
}



// -------------------------------------------------------------------
// 			 RECALIBRATE TARGET VALUES
// -------------------------------------------------------------------
// Takes a number of readings and gets new values for the target angles.
// Robot must be held upright while this process is being completed.

void calibrateTargets(){

	targetAngle = 0;
	targetYaw = 0;
	
    for(int calibrator = 0; calibrator &lt; 50; calibrator++){
	
		accelgyroData();
		targetAngle += pitch();
		targetYaw += yaw();
		delay(10);
	}
	
	// Set our new value for Pitch and Yaw
	targetAngle = targetAngle / 50;
	targetYaw = targetYaw / 50;
	Serial.print("Target Pitch: ");
	Serial.print(targetAngle, 3);
	Serial.print(", Target Yaw: ");
	Serial.print(targetYaw, 3);

	newCalibration = false;
}



// -------------------------------------------------------------------
// 			 GET PITCH AND YAW VALUES
// -------------------------------------------------------------------
// This simply converts the values from the accel-gyro arrays into degrees.

float pitch(){
	return (ypr[1] * 180/M_PI);
}

float yaw(){
	return (ypr[0] * 180/M_PI);
}

float angRate(){
	return -((float)gyro[1]/131.0);
}



// -------------------------------------------------------------------
// 			 GET ACCEL_GYRO DATA
// -------------------------------------------------------------------

void accelgyroData(){

    // Reset interrupt flag and get INT_STATUS byte
    mpuIntStatus = mpu.getIntStatus();

    // Get current FIFO count
    fifoCount = mpu.getFIFOCount();

    // Check for overflow (this should never happen unless our code is too inefficient)
    if ((mpuIntStatus &amp; 0x10) || fifoCount == 1024) {
        // Reset so we can continue cleanly
        mpu.resetFIFO();
        Serial.println("Warning - FIFO Overflowing!");

    // otherwise, check for DMP data ready interrupt (this should happen exactly once per loop: 100Hz)
    } else if (mpuIntStatus &amp; 0x02) {
        // Wait for correct available data length, should be less than 1-2ms, if any!
        while (fifoCount &lt; packetSize) fifoCount = mpu.getFIFOCount();


        // read a packet from FIFO
        mpu.getFIFOBytes(fifoBuffer, packetSize);
        
        // track FIFO count here in case there is &gt; 1 packet available
        // (this lets us immediately read more without waiting for an interrupt)
        fifoCount -= packetSize;

        // Get sensor data
        mpu.dmpGetQuaternion(&amp;q, fifoBuffer);
        mpu.dmpGetGyro(gyro, fifoBuffer);
        mpu.dmpGetGravity(&amp;gravity, &amp;q);
        mpu.dmpGetYawPitchRoll(ypr, &amp;q, &amp;gravity);
        mpu.resetFIFO();

        //Serial.print(ypr[1]);
        //Serial.print(" - ");
        //Serial.println(ypr[0]);
    }
}



// -------------------------------------------------------------------
// 			 MAIN PROGRAM LOOP
// -------------------------------------------------------------------

void loop() {

	// If the "SET" button is pressed
	// -- -- -- -- -- -- -- -- -- -- -- -- -- --
	if (digitalRead(BTN_2) == LOW){

		digitalWrite(LED_1, HIGH);
	    calibrateTargets();

	    lastpitch = 0;
	    iTerm = 0;

	    Serial.println("&gt; Setting new centre of gravity &lt;");

		delay(250);
	    mpu.resetFIFO();
	    digitalWrite(LED_1, LOW);
	}


	// If the "POWER" button is pressed
	// -- -- -- -- -- -- -- -- -- -- -- -- -- --
	if (digitalRead(BTN_1) == LOW){
	    if (modeSelect == 1){
	        Serial.println("&gt; Turning off balancing system &lt;");
	        initialised = false;
	        modeSelect = 0;
	        Move(3,0,0);        // Stop both motors from moving
	        digitalWrite(LED_2, LOW);
	    } else if (modeSelect == 0){
	        Serial.println("&gt; Turning on balancing system &lt;");
	        initialised = false;
	        modeSelect = 1;
	        digitalWrite(LED_2, HIGH);
	    }
	    delay(500);
	    mpu.resetFIFO();
	}
		
	// Gather data from MPU6050
	accelgyroData();
		
	// If the Balance System is turned on:
	if (modeSelect == 1){
				
		if (!initialised){

	        // Wait until robot is vertical and angular rate is almost zero:
	        if ((pitch() &lt; targetAngle+0.1) &amp;&amp; (pitch() &gt; targetAngle-0.1) &amp;&amp; (abs(angRate()) &lt; 0.3)){
	            Serial.println("&gt;&gt;&gt;&gt; Balancing System Active &lt;&lt;&lt;&lt;");
	            initialised = true;
	            lastpitch = pitch();
	            iTerm = 0;
	        }
	
	    // Otherwise, run the PID controller
		} else {

			// Stop the system if it has fallen over:
			if ((pitch() &lt; -45) || (pitch() &gt; 45)){
					
				// Stop the motors
				Move(3, 0, 0);
				// Reset runtime variables
				lastpitch = 0;
				iTerm = 0;
				initialised = false;
				Serial.println("&gt;&gt;&gt;&gt; Balancing System Stopped &lt;&lt;&lt;&lt;");

			} else {
				// A bit of function-ception happening here:
				//Serial.println(pitch());
				MoveControl(PID(pitch()), yaw());
			}
		}
	}

    if (Serial.available() &gt; 0){    // If new PID values are being sent by the interface
        readSerial();               // Run the read serial method
    }

    // Call the timing function
    // Very important to keep the response time consistent!
    timekeeper();
}



// -------------------------------------------------------------------
// 			 	TIME KEEPER
// -------------------------------------------------------------------

void timekeeper() {

    // Calculate time since loop began
    float timeChange = millis() - loopStartTime;

    // If the required loop time has not been reached, please wait!

    if (timeChange &lt; STD_LOOP_TIME) {
        delay(STD_LOOP_TIME - timeChange);
    } 


    // Update loop timer variables
    loopStartTime = millis();   
}</textarea></div>
			<div class="crayon-main" style="max-height: 400px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-2">2</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-4">4</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-6">6</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-8">8</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-10">10</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-12">12</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-14">14</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-16">16</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-18">18</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-20">20</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-22">22</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-24">24</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-26">26</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-28">28</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-30">30</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-32">32</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-34">34</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-36">36</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-38">38</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-40">40</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-42">42</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-44">44</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-46">46</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-48">48</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-50">50</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-52">52</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-54">54</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-56">56</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-58">58</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-60">60</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-62">62</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-64">64</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-66">66</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-68">68</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-70">70</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-72">72</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-74">74</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-76">76</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-78">78</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-80">80</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-82">82</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-84">84</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-86">86</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-88">88</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-90">90</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-92">92</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-94">94</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-96">96</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-98">98</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-100">100</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-102">102</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-104">104</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-106">106</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-108">108</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-110">110</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-112">112</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-114">114</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-116">116</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-118">118</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-120">120</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-122">122</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-124">124</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-126">126</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-128">128</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-130">130</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-132">132</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-134">134</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-136">136</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-138">138</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-140">140</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-142">142</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-144">144</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-146">146</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-148">148</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-150">150</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-152">152</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-154">154</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-156">156</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-158">158</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-160">160</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-162">162</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-164">164</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-166">166</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-168">168</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-170">170</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-172">172</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-174">174</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-176">176</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-178">178</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-180">180</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-182">182</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-184">184</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-186">186</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-188">188</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-190">190</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-192">192</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-194">194</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-196">196</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-198">198</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-200">200</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-202">202</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-204">204</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-206">206</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-208">208</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-210">210</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-212">212</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-214">214</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-215">215</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-216">216</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-217">217</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-218">218</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-219">219</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-220">220</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-221">221</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-222">222</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-223">223</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-224">224</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-225">225</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-226">226</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-227">227</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-228">228</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-229">229</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-230">230</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-231">231</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-232">232</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-233">233</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-234">234</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-235">235</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-236">236</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-237">237</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-238">238</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-239">239</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-240">240</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-241">241</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-242">242</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-243">243</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-244">244</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-245">245</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-246">246</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-247">247</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-248">248</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-249">249</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-250">250</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-251">251</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-252">252</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-253">253</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-254">254</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-255">255</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-256">256</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-257">257</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-258">258</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-259">259</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-260">260</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-261">261</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-262">262</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-263">263</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-264">264</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-265">265</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-266">266</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-267">267</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-268">268</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-269">269</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-270">270</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-271">271</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-272">272</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-273">273</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-274">274</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-275">275</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-276">276</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-277">277</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-278">278</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-279">279</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-280">280</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-281">281</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-282">282</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-283">283</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-284">284</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-285">285</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-286">286</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-287">287</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-288">288</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-289">289</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-290">290</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-291">291</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-292">292</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-293">293</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-294">294</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-295">295</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-296">296</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-297">297</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-298">298</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-299">299</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-300">300</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-301">301</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-302">302</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-303">303</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-304">304</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-305">305</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-306">306</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-307">307</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-308">308</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-309">309</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-310">310</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-311">311</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-312">312</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-313">313</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-314">314</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-315">315</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-316">316</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-317">317</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-318">318</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-319">319</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-320">320</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-321">321</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-322">322</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-323">323</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-324">324</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-325">325</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-326">326</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-327">327</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-328">328</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-329">329</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-330">330</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-331">331</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-332">332</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-333">333</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-334">334</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-335">335</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-336">336</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-337">337</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-338">338</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-339">339</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-340">340</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-341">341</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-342">342</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-343">343</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-344">344</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-345">345</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-346">346</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-347">347</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-348">348</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-349">349</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-350">350</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-351">351</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-352">352</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-353">353</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-354">354</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-355">355</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-356">356</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-357">357</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-358">358</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-359">359</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-360">360</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-361">361</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-362">362</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-363">363</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-364">364</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-365">365</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-366">366</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-367">367</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-368">368</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-369">369</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-370">370</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-371">371</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-372">372</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-373">373</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-374">374</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-375">375</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-376">376</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-377">377</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-378">378</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-379">379</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-380">380</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-381">381</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-382">382</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-383">383</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-384">384</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-385">385</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-386">386</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-387">387</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-388">388</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-389">389</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-390">390</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-391">391</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-392">392</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-393">393</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-394">394</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-395">395</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-396">396</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-397">397</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-398">398</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-399">399</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-400">400</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-401">401</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-402">402</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-403">403</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-404">404</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-405">405</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-406">406</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-407">407</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-408">408</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-409">409</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-410">410</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-411">411</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-412">412</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-413">413</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-414">414</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-415">415</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-416">416</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-417">417</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-418">418</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-419">419</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-420">420</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-421">421</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-422">422</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-423">423</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-424">424</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-425">425</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-426">426</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-427">427</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-428">428</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-429">429</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-430">430</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-431">431</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-432">432</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-433">433</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-434">434</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-435">435</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-436">436</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-437">437</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-438">438</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-439">439</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-440">440</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-441">441</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-442">442</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-443">443</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-444">444</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-445">445</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-446">446</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-447">447</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-448">448</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-449">449</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-450">450</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-451">451</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-452">452</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-453">453</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-454">454</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-455">455</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-456">456</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-457">457</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-458">458</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-459">459</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-460">460</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-461">461</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-462">462</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-463">463</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-464">464</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-465">465</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-466">466</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-467">467</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-468">468</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-469">469</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-470">470</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-471">471</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-472">472</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-473">473</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-474">474</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-475">475</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-476">476</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-477">477</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-478">478</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-479">479</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-480">480</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-481">481</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-482">482</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-483">483</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-484">484</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-485">485</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-486">486</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-487">487</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-488">488</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-489">489</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-490">490</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-491">491</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-492">492</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-493">493</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-494">494</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-495">495</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-496">496</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-497">497</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-498">498</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-499">499</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-500">500</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-501">501</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-502">502</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-503">503</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-504">504</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-505">505</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-506">506</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-507">507</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-508">508</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-509">509</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-510">510</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-511">511</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-512">512</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-513">513</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-514">514</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-515">515</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-516">516</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-517">517</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-518">518</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-519">519</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-520">520</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-521">521</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-522">522</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-523">523</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-524">524</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-525">525</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-526">526</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-527">527</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-528">528</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-529">529</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-530">530</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-531">531</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-532">532</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-533">533</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-534">534</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-535">535</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-536">536</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-537">537</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-538">538</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-539">539</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-540">540</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-541">541</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-542">542</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-543">543</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-544">544</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-545">545</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-546">546</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-547">547</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-548">548</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-549">549</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-550">550</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-551">551</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-552">552</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-553">553</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-554">554</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-555">555</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-556">556</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-557">557</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-558">558</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-559">559</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-560">560</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-561">561</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-562">562</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-563">563</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-564">564</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-565">565</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-566">566</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-567">567</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-568">568</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-569">569</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-570">570</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-571">571</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-572">572</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-573">573</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-574">574</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-575">575</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-576">576</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-577">577</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-578">578</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-579">579</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-580">580</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-581">581</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-582">582</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-583">583</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-584">584</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-585">585</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-586">586</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-587">587</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-588">588</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-589">589</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-590">590</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-591">591</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-592">592</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-593">593</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-594">594</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-595">595</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-596">596</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-597">597</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-598">598</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-599">599</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-600">600</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-601">601</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-602">602</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-603">603</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-604">604</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-605">605</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-606">606</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-607">607</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-608">608</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-609">609</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-610">610</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-611">611</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-612">612</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-613">613</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-614">614</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-615">615</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-616">616</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-617">617</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-618">618</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-619">619</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-620">620</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-621">621</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-622">622</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-623">623</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-624">624</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-625">625</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-626">626</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-627">627</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-628">628</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-629">629</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-630">630</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-631">631</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-632">632</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-633">633</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-634">634</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-635">635</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-636">636</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-637">637</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-638">638</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-639">639</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-640">640</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-641">641</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-642">642</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-643">643</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-644">644</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-645">645</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-646">646</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-647">647</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-648">648</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-649">649</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-650">650</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-651">651</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-652">652</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-653">653</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-654">654</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-655">655</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-656">656</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-657">657</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-658">658</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-659">659</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-660">660</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-661">661</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-662">662</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-663">663</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-664">664</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-665">665</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-666">666</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-667">667</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-668">668</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-669">669</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-670">670</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-671">671</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-672">672</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-673">673</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-674">674</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-675">675</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-676">676</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-677">677</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-678">678</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-679">679</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-680">680</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-681">681</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-682">682</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-683">683</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-684">684</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-685">685</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-686">686</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-687">687</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-688">688</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-689">689</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-690">690</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-691">691</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-692">692</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-693">693</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-694">694</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-695">695</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-696">696</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-697">697</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-698">698</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-699">699</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-700">700</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-701">701</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-702">702</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-703">703</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-704">704</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-705">705</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-706">706</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-707">707</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-708">708</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-709">709</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-710">710</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-711">711</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-712">712</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-713">713</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-714">714</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-715">715</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-716">716</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-717">717</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-718">718</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-719">719</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-720">720</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-721">721</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-722">722</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-723">723</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-724">724</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-725">725</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-726">726</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-727">727</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-728">728</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-729">729</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-730">730</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-731">731</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-732">732</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-733">733</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-734">734</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-735">735</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-736">736</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-737">737</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a36d9492413430-738">738</div><div class="crayon-num" data-line="crayon-5a01d678a36d9492413430-739">739</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a01d678a36d9492413430-1"><span class="crayon-c">/* * * * * * * * * * * * * * * * * * * * * *</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-2"><span class="crayon-c"> * SELF-BALANCING ROBOT</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-3"><span class="crayon-c"> * =========================================</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-4"><span class="crayon-c"> *</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-5"><span class="crayon-c"> * Code by: Simon Bluett</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-6"><span class="crayon-c"> * Email: hello@chillibasket.com</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-7"><span class="crayon-c"> * Website: wired.chillibasket.com</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-8"><span class="crayon-c"> *</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-9"><span class="crayon-c"> * 7/10/15, Version 2.0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-10"><span class="crayon-c"> *</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-11"><span class="crayon-c"> * Here are some hints when you try to use this code:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-12"><span class="crayon-c"> *</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-13"><span class="crayon-c"> *&nbsp;&nbsp;&gt; Ensure pin-mapping is correct for your robot (line 54)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-14"><span class="crayon-c"> *&nbsp;&nbsp;&gt; Ensure calibration values are correct for your sensor (line 181)</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-15"><span class="crayon-c"> *&nbsp;&nbsp;&gt; Uncomment (line 700) in order to see if your sensor is working</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-16"><span class="crayon-c"> *&nbsp;&nbsp;&gt; Play with your PID values on (line 93)</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-17"><span class="crayon-c"> *&nbsp;&nbsp;&gt; Ensure that your left &amp; right motors aren't inverted (line 355)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-18"><span class="crayon-c"> *&nbsp;&nbsp;&gt; Confirm whether you want the Pitch ypr[1] or Roll ypr[2] sensor readings!</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-19"><span class="crayon-c"> * * * * * * * * * * * * * * * * * * * * * */</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-20">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-22"><span class="crayon-c">/* * * * * * * * * * * * * * * * * * * * * *</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-23"><span class="crayon-c"> *&nbsp;&nbsp;This Demo makes use of the I2Cdev and MPU6050 libraries, and the demonstration</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-24"><span class="crayon-c"> *&nbsp;&nbsp;sketch written by (Jeff Rowberg &lt;jeff@rowberg.net&gt;), modified to work</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-25"><span class="crayon-c"> *&nbsp;&nbsp;with the Intel Galileo Development Board:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-26"><span class="crayon-c"> *&nbsp;&nbsp;-- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-27"><span class="crayon-c"> *&nbsp;&nbsp;I2Cdev device library code is placed under the MIT license</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-28"><span class="crayon-c"> *&nbsp;&nbsp;Copyright (c) 2012 Jeff Rowberg</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-29"><span class="crayon-c"> *&nbsp;&nbsp;Permission is hereby granted, free of charge, to any person obtaining a copy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-30"><span class="crayon-c"> *&nbsp;&nbsp;of this software and associated documentation files (the "Software"), to deal</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-31"><span class="crayon-c"> *&nbsp;&nbsp;in the Software without restriction, including without limitation the rights</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-32"><span class="crayon-c"> *&nbsp;&nbsp;to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-33"><span class="crayon-c"> *&nbsp;&nbsp;copies of the Software, and to permit persons to whom the Software is</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-34"><span class="crayon-c"> *&nbsp;&nbsp;furnished to do so, subject to the following conditions:</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-35"><span class="crayon-c"> *</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-36"><span class="crayon-c"> *&nbsp;&nbsp;The above copyright notice and this permission notice shall be included in</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-37"><span class="crayon-c"> *&nbsp;&nbsp;all copies or substantial portions of the Software.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-38"><span class="crayon-c"> * * * * * * * * * * * * * * * * * * * * * */</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-39">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-40">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-42"><span class="crayon-c">// I2Cdev and MPU6050 must be installed as libraries, or else the .cpp/.h files</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-43"><span class="crayon-c">// for both classes must be in the include path of your project</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-44"><span class="crayon-p">#include &lt;I2Cdev.h&gt;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-45"><span class="crayon-p">#include &lt;MPU6050_6Axis_MotionApps20.h&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-46"><span class="crayon-p">#include &lt;Wire.h&gt;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-47">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-48"><span class="crayon-c">// Specific I2C addresses may be passed as a parameter here</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-49"><span class="crayon-e">MPU6050 </span><span class="crayon-v">mpu</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-c">// Default: AD0 low = 0x68</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-50">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-52"><span class="crayon-c">// Define the pin-mapping</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-53"><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-54"><span class="crayon-p">#define DIR_A 12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Direction Pin, Motor A</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-55"><span class="crayon-p">#define DIR_B 13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Direction Pin, Motor B</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-56"><span class="crayon-p">#define PWM_A 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // PWM, Motor A (Left Motor)</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-57"><span class="crayon-p">#define PWM_B 11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// PWM, Motor B (Right Motor)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-58"><span class="crayon-p">#define BRK_A 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Brake, Motor A</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-59"><span class="crayon-p">#define BRK_B 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Brake, Motor B</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-60">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-61"><span class="crayon-p">#define BTN_1 10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // On/Off Button</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-62"><span class="crayon-p">#define BTN_2 7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Set Centre of Gravity Button</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-63">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-64"><span class="crayon-p">#define LED_1 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Low-battery Warning LED</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-65"><span class="crayon-p">#define LED_2 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Current mode LED</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-66">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-67">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-68"><span class="crayon-c">// Max PWM parameters</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-69"><span class="crayon-p">#define MAX_TURN 30</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-70">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-72"><span class="crayon-c">// MPU Control/Status</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-73"><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-74"><span class="crayon-t">bool</span><span class="crayon-h"> </span><span class="crayon-v">dmpReady</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	</span><span class="crayon-c">// Set true if DMP init was successful</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-75"><span class="crayon-e">uint8_t </span><span class="crayon-v">devStatus</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Return status after device operation (0 = success, !0 = error)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-76"><span class="crayon-e">uint8_t </span><span class="crayon-v">mpuIntStatus</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Holds actual interrupt status byte from MPU</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-77"><span class="crayon-e">uint16_t </span><span class="crayon-v">packetSize</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Expected DMP packet size (default is 42 bytes)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-78"><span class="crayon-e">uint16_t </span><span class="crayon-v">fifoCount</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Count of all bytes currently in FIFO</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-79"><span class="crayon-e">uint8_t </span><span class="crayon-v">fifoBuffer</span><span class="crayon-sy">[</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// FIFO storage buffer</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-80">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-81">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-82"><span class="crayon-c">// Orientation/Motion</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-83"><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-84"><span class="crayon-i">Quaternion</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// [w, x, y, z]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Quaternion Container</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-85"><span class="crayon-e">VectorFloat </span><span class="crayon-v">gravity</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	</span><span class="crayon-c">// [x, y, z]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gravity Vector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-86"><span class="crayon-e">int16_t </span><span class="crayon-v">gyro</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	</span><span class="crayon-c">// [x, y, z]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gyro Vector</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-87"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">ypr</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// [yaw, pitch, roll]&nbsp;&nbsp; Yaw/Pitch/Roll &amp; gravity vector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-88"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">averagepitch</span><span class="crayon-sy">[</span><span class="crayon-cn">50</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;	</span><span class="crayon-c">// Used for averaging pitch value</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-90">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-91"><span class="crayon-c">// For PID Controller</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-92"><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-93"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">Kp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// (P)roportional Tuning Parameter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-94"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">Ki</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">;</span><span class="crayon-h">					</span><span class="crayon-c">// (I)ntegral Tuning Parameter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-95"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">Kd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">;</span><span class="crayon-h">					</span><span class="crayon-c">// (D)erivative Tuning Parameter&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-96"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">lastpitch</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Keeps track of error over time</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-97"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">iTerm</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;		</span><span class="crayon-c">// Used to accumulate error (integral)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-98"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">targetAngle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2.1</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 	</span><span class="crayon-c">// Can be adjusted according to centre of gravity </span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-99">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-100"><span class="crayon-c">// You can Turn off YAW control, by setting</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-101"><span class="crayon-c">// the Tp and Td constants below to 0.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-102"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">Tp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;			</span><span class="crayon-c">// Yaw Proportional Tuning Parameter</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-103"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">Td</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">;</span><span class="crayon-h">					</span><span class="crayon-c">// Yaw Derivative Tuning Parameter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-104"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">targetYaw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Used to maintain the robot's yaw</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-105"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">lastYawError</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-106">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-107"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">PIDGain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">				</span><span class="crayon-c">// Used for soft start (prevent jerking at initiation)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-108">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-109">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-110"><span class="crayon-c">// Motor Control</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-111"><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-112"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// 0 - Forwards, 1 - Backwards</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-113"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-114"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">brake_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// 1 - On, 0 - Off</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-115"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">brake_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-116">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-117">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-118"><span class="crayon-c">// Runtime variables</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-119"><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-120"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">modeSelect</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// System Mode (0 = off, 1 = normal, 2 = guided)</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-121"><span class="crayon-t">bool</span><span class="crayon-h"> </span><span class="crayon-v">initialised</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Is the balancing system on?</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-122">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-123"><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Hold any incoming characters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-124"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">angular_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Used to make sure rate is ~0 when balance mode is initiated</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-125">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-126"><span class="crayon-t">bool</span><span class="crayon-h"> </span><span class="crayon-v">newCalibration</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span><span class="crayon-h">	</span><span class="crayon-c">// If set TRUE, the target angles are recalibrated</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-127">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-128">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-129"><span class="crayon-c">// Variables used for timing control</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-130"><span class="crayon-c">// Aim is 10ms per cycle (100Hz)</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-131"><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-132"><span class="crayon-p">#define STD_LOOP_TIME 9</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-133">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-134"><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">long</span><span class="crayon-h"> </span><span class="crayon-v">loopStartTime</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-135"><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">long</span><span class="crayon-h"> </span><span class="crayon-v">lastTime</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Time since PID was called last (should be ~10ms)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-136">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-137"><span class="crayon-c">// 0 = Off, 1 = On</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-138"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">modes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-139">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-140">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-141">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-142"><span class="crayon-c">// ------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-143"><span class="crayon-c">// 					&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INITIAL SETUP</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-144"><span class="crayon-c">// ------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-145">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-146"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">setup</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-147">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-148"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Wire</span><span class="crayon-sy">.</span><span class="crayon-e">begin</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-149">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-150"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Initialize serial communication for debugging</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-151"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">begin</span><span class="crayon-sy">(</span><span class="crayon-cn">115200</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-152"><span class="crayon-h">	</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-153"><span class="crayon-h">	 </span><span class="crayon-c">// Configure LED for output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-154"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">LED_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-155"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">LED_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-156">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-157"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">LED_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-158"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">LED_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-159">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-160"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Set as input, internal pullup for buttons</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-161"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">BTN_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">INPUT_PULLUP</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-162"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">BTN_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">INPUT_PULLUP</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-163">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-164"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Configure Motor I/O</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-165"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">DIR_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Left Motor Direction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-166"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">DIR_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Right Motor Direction</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-167"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">BRK_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Left Motor Brake</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-168"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">BRK_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Right Motor Brake</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-169">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-170"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Initialize MPU6050</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-171"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">initialize</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-172"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"Testing MPU connection:"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-173">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-174"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">testConnection</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-s">"&gt; MPU6050 connection successful"</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"&gt; MPU6050 connection failed"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-175"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"Initialising DMP"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-176"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">devStatus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">dmpInitialize</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-177">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-178"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* * * * * * * * * * * * * * * * * * * *</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-179"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp; * IMPORTANT!</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-180"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp; * Supply your own MPU6050 offsets here</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-181"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp; * Otherwise robot will not balance properly.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-182"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp; * * * * * * * * * * * * * * * * * * * */</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-183"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">setXGyroOffset</span><span class="crayon-sy">(</span><span class="crayon-cn">93</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-184"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">setYGyroOffset</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">15</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-185"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">setZGyroOffset</span><span class="crayon-sy">(</span><span class="crayon-cn">30</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-186"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">setXAccelOffset</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">2500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-187"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">setYAccelOffset</span><span class="crayon-sy">(</span><span class="crayon-cn">1783</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-188"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">setZAccelOffset</span><span class="crayon-sy">(</span><span class="crayon-cn">877</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-189">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-190"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Make sure it worked (returns 0 if so)</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-191"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">devStatus</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-192"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"Enabling DMP"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-193"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">setDMPEnabled</span><span class="crayon-sy">(</span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-194"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpuIntStatus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">getIntStatus</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-195">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-196"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Set our DMP Ready flag so the main loop() function knows it's okay to use it</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-197"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"DMP Ready! Let's Proceed."</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-198"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"Robot is now ready to balance. Hold the robot steady"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-199"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"in a vertical position, and the motors should start."</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-200"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dmpReady</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-201"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">packetSize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">dmpGetFIFOPacketSize</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-202">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-203"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-204"><span class="crayon-h">		</span><span class="crayon-c">// In case of an error with the DMP</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-205"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">devStatus</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt; Initial Memory Load Failed"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-206"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">devStatus</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt; DMP Configuration Updates Failed"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-207"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-208">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-209"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-210">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-211">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-212">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-213"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-214"><span class="crayon-c">// 			 PID CONTROLLER</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-215"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-216">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-217"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">PID</span><span class="crayon-sy">(</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">pitch</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-218">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-219"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Calculate time since last time PID was called (~10ms)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-220"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-221"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-t">long</span><span class="crayon-h"> </span><span class="crayon-v">thisTime</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">millis</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-222"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">timeChange</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">thisTime</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lastTime</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-223">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-224"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Calculate Error</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-225"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">targetAngle</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">pitch</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-226">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-227">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-228"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Calculate our PID terms</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-229"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// PID values are multiplied/divided by 10 in order to allow the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-230"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// constants to be numbers between 0-10.</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-231"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-232"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">pTerm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Kp</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-233"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">iTerm</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-v">Ki</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">timeChange</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-234"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">dTerm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Kd</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">pitch</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lastpitch</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">timeChange</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-235"><span class="crayon-h">	</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-236"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Ki</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">iTerm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-237"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lastpitch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pitch</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-238"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lastTime</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">thisTime</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-239">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-240">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-241"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Obtain PID output value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-242"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-243"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">PIDValue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pTerm</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">iTerm</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">dTerm</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-244">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-245"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Set a minimum speed (motors will not move below this - can help to reduce latency)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-246"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//if(PIDValue &gt; 0) PIDValue = PIDValue + 10;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-247"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//if(PIDValue &lt; 0) PIDValue = PIDValue - 10;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-248">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-249"><span class="crayon-h">	</span><span class="crayon-c">// Limit PID value to maximum PWM values</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-250"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">PIDValue</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">PIDValue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-251"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">PIDValue</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">PIDValue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">255</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-252">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-253"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">PIDValue</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-254">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-255"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-256">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-257">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-258">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-259"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-260"><span class="crayon-c">// 			 YAW CONTROLLER</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-261"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-262">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-263"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">yawPD</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">yawError</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-264">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-265">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-266"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Calculate our PD terms</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-267"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-268"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">pTerm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Tp</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">yawError</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-269"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">dTerm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Kd</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yawError</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lastYawError</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-270"><span class="crayon-h">	</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-271"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lastYawError</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">yawError</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-272">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-273"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Obtain PD output value</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-274"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-275"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">yawPDvalue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">pTerm</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">dTerm</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-276">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-277"><span class="crayon-h">	</span><span class="crayon-c">// Limit PD value to maximum</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-278"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yawPDvalue</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">MAX_TURN</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">yawPDvalue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">MAX_TURN</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-279"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">yawPDvalue</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">MAX_TURN</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">yawPDvalue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">MAX_TURN</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-280">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-281"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Serial.print("Error: ");</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-282"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Serial.print(yawError);</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-283"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Serial.print(" - PD: ");</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-284"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Serial.println(yawPDvalue);</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-285"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">yawPDvalue</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-286">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-287"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-288">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-289">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-290">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-291"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-292"><span class="crayon-c">// 			 	MOVEMENT CONTROLLER</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-293"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-294"><span class="crayon-c">// This function calculate the PWM output required to keep the robot </span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-295"><span class="crayon-c">// balanced, to move it back and forth, and to control the yaw.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-296">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-297"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">MoveControl</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">pidValue</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">yaw</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-298"><span class="crayon-h">	</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-299"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Set both motors to this speed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-300"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pidValue</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-301"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pidValue</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-302">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-303">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-304"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* YAW CONTROLLER */</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-305">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-306"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Check if turning left or right is faster</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-307"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-308"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">leftTurn</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rightTurn</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-309">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-310"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">newYaw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">targetYaw</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-311">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-312"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">yaw</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">newYaw</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-313"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">yaw</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">newYaw</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-314"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">leftTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">180</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">yaw</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">180</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">newYaw</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-315">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-316"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">yaw</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">newYaw</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-317"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">180</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">yaw</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">180</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">newYaw</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-318"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">leftTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">yaw</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">newYaw</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-319">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-320"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">yaw</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">newYaw</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">yaw</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">newYaw</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-321"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">newYaw</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">yaw</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-322">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-323"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-324"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">leftTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rightTurn</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-325"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">360</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">leftTurn</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-326"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-327"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">rightTurn</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-328"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">leftTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">360</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-v">rightTurn</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-329"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-330"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">leftTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-331"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-332"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-333">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-334"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Apply yaw PD controller to motor output</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-335"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-336"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">leftTurn</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-337"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Do nothing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-338"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">leftTurn</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">rightTurn</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-339"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;	</span><span class="crayon-v">leftTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">yawPD</span><span class="crayon-sy">(</span><span class="crayon-v">leftTurn</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-340"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">leftTurn</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-341"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">leftTurn</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-342">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-343"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">leftTurn</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-344"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rightTurn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">yawPD</span><span class="crayon-sy">(</span><span class="crayon-v">rightTurn</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-345"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">rightTurn</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-346"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">rightTurn</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-347"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-348"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-349">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-350">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-351"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Limits PID to max motor speed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-352"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-353"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-354"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">255</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-355"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-356"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">255</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-357">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-358"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Send command to left motor</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-359"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">Move</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">left_PWM</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; 	</span><span class="crayon-c">// '0' = Left-motor, '1' = Right-motor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-360"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-e">Move</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">left_PWM</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-361"><span class="crayon-h">	</span><span class="crayon-c">// Send command to right motor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-362"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">Move</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">right_PWM</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> 	</span><span class="crayon-c">// '0' = Forward, '1' = Backward</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-363"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-e">Move</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">right_PWM</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-364">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-365"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-366">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-367">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-368">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-369"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-370"><span class="crayon-c">// 			 MOTOR CONTROLLER</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-371"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-372">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-373"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">Move</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">motor</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">direction</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">speed</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-374">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-375"><span class="crayon-h">	</span><span class="crayon-c">// Left Motor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-376"><span class="crayon-h">	</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-377"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">motor</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-378"><span class="crayon-h">	</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-379"><span class="crayon-h">		</span><span class="crayon-c">// Set motor direction (only if it is currently not that direction)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-380"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-381"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">DIR_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">		</span><span class="crayon-c">// Forwards</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-382"><span class="crayon-h">			</span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-383"><span class="crayon-h">		</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-384"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">DIR_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">		</span><span class="crayon-c">// Backwards</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-385"><span class="crayon-h">			</span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-386"><span class="crayon-h">		</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-387"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-388"><span class="crayon-h">		</span><span class="crayon-c">// Release brake (only if brake is active)</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-389"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">brake_A</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-390"><span class="crayon-h">			</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">BRK_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-391"><span class="crayon-h">			</span><span class="crayon-v">brake_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-392"><span class="crayon-h">		</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-393"><span class="crayon-h">		</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-394"><span class="crayon-h">		</span><span class="crayon-c">// Send PWM data to motor A</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-395"><span class="crayon-h">		</span><span class="crayon-e">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">PWM_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">speed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-396">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-397">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-398"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Right Motor</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-399"><span class="crayon-h">	</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-400"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">motor</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-401"><span class="crayon-h">	</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-402"><span class="crayon-h">		</span><span class="crayon-c">// Set motor direction (only if it is currently not that direction)</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-403"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-404"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">DIR_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">		</span><span class="crayon-c">// Forwards</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-405"><span class="crayon-h">			</span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-406"><span class="crayon-h">		</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-407"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">DIR_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">		</span><span class="crayon-c">// Backwards</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-408"><span class="crayon-h">			</span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-409"><span class="crayon-h">		</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-410"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-411"><span class="crayon-h">		</span><span class="crayon-c">// Release brake (only if brake is active)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-412"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">brake_B</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-413"><span class="crayon-h">			</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">BRK_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-414"><span class="crayon-h">			</span><span class="crayon-v">brake_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-415"><span class="crayon-h">		</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-416"><span class="crayon-h">		</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-417"><span class="crayon-h">		</span><span class="crayon-c">// Send PWM data to motor A</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-418"><span class="crayon-h">		</span><span class="crayon-e">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">PWM_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">speed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-419">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-420">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-421"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Stop both motors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-422"><span class="crayon-h">	</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-423"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">motor</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-424">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-425"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">PWM_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-426"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">PWM_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-427"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">BRK_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-428"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">BRK_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-429"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">brake_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-430"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">brake_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-431">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-432"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-433"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-434">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-435">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-436">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-437"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-438"><span class="crayon-c">// 			 READ INPUT FROM SERIAL</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-439"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-440">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-441"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">readSerial</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-442">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-443"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Initiate all of the variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-444"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-445"><span class="crayon-h">	</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">		</span><span class="crayon-c">// Which action needs to be taken?</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-446"><span class="crayon-h">	</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">no_before</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">			</span><span class="crayon-c">// Numbers before decimal point</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-447"><span class="crayon-h">	</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">no_after</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">			</span><span class="crayon-c">// Numbers after decimal point</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-448"><span class="crayon-h">	</span><span class="crayon-t">bool</span><span class="crayon-h"> </span><span class="crayon-v">minus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span><span class="crayon-h">			</span><span class="crayon-c">// See if number is negative</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-449"><span class="crayon-h">	</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">		</span><span class="crayon-c">// Read incoming data</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-450">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-451"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'P'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-452"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'I'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-453"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'D'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-454">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-455"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Tell robot to calibrate the Centre of Gravity</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-456"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'G'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">calibrateTargets</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-457">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-458">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-459"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Records all of the incoming data (format: 00.000)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-460"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// And converts the chars into a float number</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-461"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-462"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">available</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-463">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-464"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Is the number negative?</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-465"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-466"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'-'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-467"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">minus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-468"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-469"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-470"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_before</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-471">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-472"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">available</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-473"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-474">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-475"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">'.'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-476"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_before</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">no_before</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-477">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-478"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">available</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-479"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-480"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-481"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-482">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-483"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'.'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-484"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-485"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-486"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_after</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-487"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-488">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-489"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">available</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-490"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-491"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-492"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_after</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">no_after</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-493"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-494">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-495"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">available</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-496"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-497"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-498"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_after</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">no_after</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">inchar</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-499"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-500"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-501"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-502"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-503"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-504">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-505"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Combine the chars into a single float</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-506"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">answer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">float</span><span class="crayon-sy">(</span><span class="crayon-v">no_after</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-507"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">answer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">answer</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">no_before</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-508"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">minus</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">answer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">answer</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-509">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-510"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Update the PID constants</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-511"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-512"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Kp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">answer</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-513"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"P - "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-514"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-515"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Ki</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">answer</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-516"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"I - "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-517"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-518"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Kd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">answer</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-519"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"D - "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-520"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-521"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Constant Set: "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-522"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">answer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-523">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-524"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-525"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">changestate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-526"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-527"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-528"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-529">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-530">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-531">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-532"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-533"><span class="crayon-c">// 			 RECALIBRATE TARGET VALUES</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-534"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-535"><span class="crayon-c">// Takes a number of readings and gets new values for the target angles.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-536"><span class="crayon-c">// Robot must be held upright while this process is being completed.</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-537">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-538"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">calibrateTargets</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-539">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-540"><span class="crayon-h">	</span><span class="crayon-v">targetAngle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-541"><span class="crayon-h">	</span><span class="crayon-v">targetYaw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-542"><span class="crayon-h">	</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-543"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">calibrator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">calibrator</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">calibrator</span><span class="crayon-o">++</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-544"><span class="crayon-h">	</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-545"><span class="crayon-h">		</span><span class="crayon-e">accelgyroData</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-546"><span class="crayon-h">		</span><span class="crayon-v">targetAngle</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">pitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-547"><span class="crayon-h">		</span><span class="crayon-v">targetYaw</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">yaw</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-548"><span class="crayon-h">		</span><span class="crayon-e">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-549"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-550"><span class="crayon-h">	</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-551"><span class="crayon-h">	</span><span class="crayon-c">// Set our new value for Pitch and Yaw</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-552"><span class="crayon-h">	</span><span class="crayon-v">targetAngle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">targetAngle</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-553"><span class="crayon-h">	</span><span class="crayon-v">targetYaw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">targetYaw</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-554"><span class="crayon-h">	</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Target Pitch: "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-555"><span class="crayon-h">	</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">targetAngle</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-556"><span class="crayon-h">	</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">", Target Yaw: "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-557"><span class="crayon-h">	</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">targetYaw</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-558">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-559"><span class="crayon-h">	</span><span class="crayon-v">newCalibration</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-560"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-561">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-562">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-563">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-564"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-565"><span class="crayon-c">// 			 GET PITCH AND YAW VALUES</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-566"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-567"><span class="crayon-c">// This simply converts the values from the accel-gyro arrays into degrees.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-568">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-569"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-e">pitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-570"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">ypr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">180</span><span class="crayon-o">/</span><span class="crayon-v">M_PI</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-571"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-572">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-573"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-e">yaw</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-574"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">ypr</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">180</span><span class="crayon-o">/</span><span class="crayon-v">M_PI</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-575"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-576">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-577"><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-e">angRate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-578"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-t">float</span><span class="crayon-sy">)</span><span class="crayon-v">gyro</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-o">/</span><span class="crayon-cn">131.0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-579"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-580">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-581">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-582">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-583"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-584"><span class="crayon-c">// 			 GET ACCEL_GYRO DATA</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-585"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-586">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-587"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">accelgyroData</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-588">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-589"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Reset interrupt flag and get INT_STATUS byte</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-590"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpuIntStatus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">getIntStatus</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-591">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-592"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Get current FIFO count</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-593"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fifoCount</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">getFIFOCount</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-594">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-595"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Check for overflow (this should never happen unless our code is too inefficient)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-596"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">mpuIntStatus</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0x10</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">fifoCount</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1024</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-597"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Reset so we can continue cleanly</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-598"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">resetFIFO</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-599"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"Warning - FIFO Overflowing!"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-600">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-601"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// otherwise, check for DMP data ready interrupt (this should happen exactly once per loop: 100Hz)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-602"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mpuIntStatus</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0x02</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-603"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Wait for correct available data length, should be less than 1-2ms, if any!</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-604"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">fifoCount</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">packetSize</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">fifoCount</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">getFIFOCount</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-605">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-606">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-607"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// read a packet from FIFO</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-608"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">getFIFOBytes</span><span class="crayon-sy">(</span><span class="crayon-v">fifoBuffer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">packetSize</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-609"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-610"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// track FIFO count here in case there is &gt; 1 packet available</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-611"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// (this lets us immediately read more without waiting for an interrupt)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-612"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fifoCount</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-v">packetSize</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-613">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-614"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Get sensor data</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-615"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">dmpGetQuaternion</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">q</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fifoBuffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-616"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">dmpGetGyro</span><span class="crayon-sy">(</span><span class="crayon-v">gyro</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fifoBuffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-617"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">dmpGetGravity</span><span class="crayon-sy">(</span><span class="crayon-o">&amp;</span><span class="crayon-v">gravity</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-618"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">dmpGetYawPitchRoll</span><span class="crayon-sy">(</span><span class="crayon-v">ypr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">q</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-v">gravity</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-619"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">resetFIFO</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-620">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-621"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Serial.print(ypr[1]);</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-622"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Serial.print(" - ");</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-623"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">//Serial.println(ypr[0]);</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-624"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-625"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-626">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-627">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-628">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-629"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-630"><span class="crayon-c">// 			 MAIN PROGRAM LOOP</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-631"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-632">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-633"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">loop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-634">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-635"><span class="crayon-h">	</span><span class="crayon-c">// If the "SET" button is pressed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-636"><span class="crayon-h">	</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-637"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">digitalRead</span><span class="crayon-sy">(</span><span class="crayon-v">BTN_2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-638">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-639"><span class="crayon-h">		</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">LED_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-640"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">calibrateTargets</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-641">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-642"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lastpitch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-643"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">iTerm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-644">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-645"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt; Setting new centre of gravity &lt;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-646">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-647"><span class="crayon-h">		</span><span class="crayon-e">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">250</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-648"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">resetFIFO</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-649"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">LED_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-650"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-651">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-652">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-653"><span class="crayon-h">	</span><span class="crayon-c">// If the "POWER" button is pressed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-654"><span class="crayon-h">	</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-655"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">digitalRead</span><span class="crayon-sy">(</span><span class="crayon-v">BTN_1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-656"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">modeSelect</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-657"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt; Turning off balancing system &lt;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-658"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">initialised</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-659"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">modeSelect</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-660"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Move</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Stop both motors from moving</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-661"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">LED_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-662"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">modeSelect</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-663"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt; Turning on balancing system &lt;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-664"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">initialised</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-665"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">modeSelect</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-666"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">LED_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-667"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-668"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">500</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-669"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">mpu</span><span class="crayon-sy">.</span><span class="crayon-e">resetFIFO</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-670"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-671"><span class="crayon-h">		</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-672"><span class="crayon-h">	</span><span class="crayon-c">// Gather data from MPU6050</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-673"><span class="crayon-h">	</span><span class="crayon-e">accelgyroData</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-674"><span class="crayon-h">		</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-675"><span class="crayon-h">	</span><span class="crayon-c">// If the Balance System is turned on:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-676"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">modeSelect</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-677"><span class="crayon-h">				</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-678"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-v">initialised</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-679">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-680"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Wait until robot is vertical and angular rate is almost zero:</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-681"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">pitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">targetAngle</span><span class="crayon-o">+</span><span class="crayon-cn">0.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">pitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">targetAngle</span><span class="crayon-o">-</span><span class="crayon-cn">0.1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">abs</span><span class="crayon-sy">(</span><span class="crayon-e">angRate</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-682"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt;&gt;&gt;&gt; Balancing System Active &lt;&lt;&lt;&lt;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-683"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">initialised</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-684"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lastpitch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-685"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">iTerm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-686"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-687"><span class="crayon-h">	</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-688"><span class="crayon-h">	&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Otherwise, run the PID controller</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-689"><span class="crayon-h">		</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-690">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-691"><span class="crayon-h">			</span><span class="crayon-c">// Stop the system if it has fallen over:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-692"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">pitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">45</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">pitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-693"><span class="crayon-h">					</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-694"><span class="crayon-h">				</span><span class="crayon-c">// Stop the motors</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-695"><span class="crayon-h">				</span><span class="crayon-e">Move</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-696"><span class="crayon-h">				</span><span class="crayon-c">// Reset runtime variables</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-697"><span class="crayon-h">				</span><span class="crayon-v">lastpitch</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-698"><span class="crayon-h">				</span><span class="crayon-v">iTerm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-699"><span class="crayon-h">				</span><span class="crayon-v">initialised</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-700"><span class="crayon-h">				</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-s">"&gt;&gt;&gt;&gt; Balancing System Stopped &lt;&lt;&lt;&lt;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-701">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-702"><span class="crayon-h">			</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-703"><span class="crayon-h">				</span><span class="crayon-c">// A bit of function-ception happening here:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-704"><span class="crayon-h">				</span><span class="crayon-c">//Serial.println(pitch());</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-705"><span class="crayon-h">				</span><span class="crayon-e">MoveControl</span><span class="crayon-sy">(</span><span class="crayon-e">PID</span><span class="crayon-sy">(</span><span class="crayon-e">pitch</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">yaw</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-706"><span class="crayon-h">			</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-707"><span class="crayon-h">		</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-708"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-709">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-710"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">available</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// If new PID values are being sent by the interface</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-711"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">readSerial</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Run the read serial method</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-712"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-713">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-714"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Call the timing function</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-715"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Very important to keep the response time consistent!</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-716"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">timekeeper</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-717"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-718">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-719">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-720">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-721"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-722"><span class="crayon-c">// 			 	TIME KEEPER</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-723"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-724">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-725"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">timekeeper</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-726">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-727"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Calculate time since loop began</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-728"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">float</span><span class="crayon-h"> </span><span class="crayon-v">timeChange</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">millis</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">loopStartTime</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-729">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-730"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// If the required loop time has not been reached, please wait!</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-731">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-732"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">timeChange</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">STD_LOOP_TIME</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-733"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">delay</span><span class="crayon-sy">(</span><span class="crayon-v">STD_LOOP_TIME</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">timeChange</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-734"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-735">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-736">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-737"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Update loop timer variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a36d9492413430-738"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loopStartTime</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">millis</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5a01d678a36d9492413430-739"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.1180 seconds] -->
<p>Here is a breakdown of how to use this code with your robot:</p>
<ol>
<li>Before starting the program, connect the board via USB to your computer, and open a terminal window in the Arduino software (baud rate: 115200).</li>
<li><b>Wait until robot is ready:</b> At the start the robot automatically initialises the MPU6050 module. Once this is done, the following message should appear:<br>
<code>DMP Ready! Let's Proceed.</code></li>
<li><b>Set Centre of Gravity:</b> You should set the centre of gravity of the robot, so that the robot knows which way is up! Do this by steadily holding the robot upright, with the wheels off the floor, and pressing the button connected to GPIO-4. The LED on GPIO-2 will flash, and the following message should appear:<br>
<code>&gt; Setting new centre of gravity &lt;</code></li>
<li><b>Automatic On/Off:</b> The motors of the robot automatically turn off if the robot has fallen over, or is lying on its side. To turn them back on, hold the robot steadily in an upright position. The motors should start and the following message appear:<br>
<code>&gt;&gt;&gt;&gt; Balancing System Active &lt;&lt;&lt;&lt;</code><br>
If the robot has fallen over and motors are off, this message appears:<br>
<code>&gt;&gt;&gt;&gt; Balancing System Stopped&nbsp;&lt;&lt;&lt;&lt;</code></li>
<li><b>Manual On/Off:</b> To manually turn the balancing system on/off, press the button connected to GPIO-7. The LED on GPIO-10 will be bright, if the balancing system is turned on. One of the following messages will appear to let you know which state the robot is in:<br>
<code>&gt; Turning off balancing system &lt;</code><br>
<code>&gt; Turning on balancing system &lt;</code></li>
<li><b>Sending new PID values:</b>&nbsp;Please read my guide <span style="text-decoration: underline;"><a href="http://wired.chillibasket.com/2015/03/pid-controller/">The PID Controller</a></span>, to see how to calibrate your robot. You can send new PID values via the console&nbsp;window, by typing the letter of the constant (P, I or D) you want to set, followed by the number you want to set it at. Then press the enter/return&nbsp;key to send. The code accepts any numbers between&nbsp;0.01 – 99.99. For example:<br>
<code>P8.2&nbsp;I1.51 D15</code><br>
This sets the [P]roportional Constant to 8.2, the [I]ntegral Constant to 1.51, and the [D]erivative Constant to 15.</li>
</ol>
<p>&nbsp;</p>
<hr>
<h4>Dealing with Common Errors</h4>
<p>I have found that most of the common errors can be dealt with by checking the following:</p>
<ol>
<li><strong>Check the Pin Mapping:</strong> Make sure that the GPIO number on (lines 54-65) match up with the ones you are using on your robot.</li>
<li><strong>Update the MPU-6050 Offsets:</strong>&nbsp;Each sensor has unique offset values, which have to be inputted on (lines 183-188). I explain how to find these offsets in my “<span style="text-decoration: underline;"><a href="http://wired.chillibasket.com/2015/01/calibrating-mpu6050/">Calibrating &amp; Optimising the MPU6050</a></span>” part of this tutorial.</li>
<li><strong>Ensure sensor is working properly:</strong> Check that the MPU-6050 is working, by uncommenting (line 704) of my code. While running, the robot should display the current angle on the console. When held upright, the angle should be 0. When pitching forwards/backwards, the number should be positive/negative in degrees.</li>
<li><strong>Both motors should spin in same direction:</strong> Set the turning constants on (lines 102-103) to zero. Now both motors should spin in same direction. If not, then one of the motors is wired backwards.</li>
<li><strong>Motors balance in wrong direction:</strong> Instead of stopping the robot from falling, the motors speed up the fall. This means that both motors are wired in backwards!</li>
</ol>
<hr>
<p>This finally concludes my tutorial about self-balancing robots! If you have any questions or suggestions, please leave a comment below. Alternatively you can also send me a private message using the form on the “About” page.</p>

<div id="jp-relatedposts" class="jp-relatedposts" style="display: block;">
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
<div class="jp-relatedposts-items jp-relatedposts-items-visual jp-relatedposts-grid "><div class="jp-relatedposts-post jp-relatedposts-post0 jp-relatedposts-post-thumbs" data-post-id="65" data-post-format="false"><a class="jp-relatedposts-post-a" href="http://wired.chillibasket.com/2014/09/balancing-robot-intro/" title="Introduction to Self-Balancing Robots

Why should you build a self-balancing robot? That is a very good question, with an even better answer! Self-balancing systems can be seen in many places and they are essential for the smooth running of numerous types of machines. Some of the obvious include Segways, bipedal robots and space rockets…" rel="nofollow" data-origin="299" data-position="0"><img class="jp-relatedposts-post-img" src="./5. Putting it all together! – chillibasket_files/Screen-Shot-2014-07-17-at-10.05.23.png" width="350" alt="Introduction to Self-Balancing Robots"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="http://wired.chillibasket.com/2014/09/balancing-robot-intro/" title="Introduction to Self-Balancing Robots

Why should you build a self-balancing robot? That is a very good question, with an even better answer! Self-balancing systems can be seen in many places and they are essential for the smooth running of numerous types of machines. Some of the obvious include Segways, bipedal robots and space rockets…" rel="nofollow" data-origin="299" data-position="0">Introduction to Self-Balancing Robots</a></h4><p class="jp-relatedposts-post-excerpt">Why should you build a self-balancing robot? That is a very good question, with an even better answer! Self-balancing systems can be seen in many places and they are essential for the smooth running of numerous types of machines. Some of the obvious include Segways, bipedal robots and space rockets…</p><p class="jp-relatedposts-post-date" style="display: block;">September 7, 2014</p><p class="jp-relatedposts-post-context">In "Self-balancing"</p></div><div class="jp-relatedposts-post jp-relatedposts-post1 jp-relatedposts-post-thumbs" data-post-id="254" data-post-format="false"><a class="jp-relatedposts-post-a" href="http://wired.chillibasket.com/2015/03/pid-controller/" title="The PID Controller

The most important element of any robot is the controller. Especially for a self-balancing robot, the control program is vital as it interprets the sensor data and decides how much the motors need to be moved in order for the robot to remain upright. The most common controller used for…" rel="nofollow" data-origin="299" data-position="1"><img class="jp-relatedposts-post-img" src="./5. Putting it all together! – chillibasket_files/pid-diagram-e1443473603418.jpg" width="350" alt="The PID Controller"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="http://wired.chillibasket.com/2015/03/pid-controller/" title="The PID Controller

The most important element of any robot is the controller. Especially for a self-balancing robot, the control program is vital as it interprets the sensor data and decides how much the motors need to be moved in order for the robot to remain upright. The most common controller used for…" rel="nofollow" data-origin="299" data-position="1">The PID Controller</a></h4><p class="jp-relatedposts-post-excerpt">The most important element of any robot is the controller. Especially for a self-balancing robot, the control program is vital as it interprets the sensor data and decides how much the motors need to be moved in order for the robot to remain upright. The most common controller used for…</p><p class="jp-relatedposts-post-date" style="display: block;">March 16, 2015</p><p class="jp-relatedposts-post-context">In "Self-balancing"</p></div><div class="jp-relatedposts-post jp-relatedposts-post2 jp-relatedposts-post-thumbs" data-post-id="5" data-post-format="false"><a class="jp-relatedposts-post-a" href="http://wired.chillibasket.com/2014/08/welcome/" title="Welcome!

I have always had a great interest in electronics and technical things. Over the past few years I worked on a number of projects which I would really like to share on this blog. My main blog has turned out to be more of a photography blog, so I decided…" rel="nofollow" data-origin="299" data-position="2"><img class="jp-relatedposts-post-img" src="./5. Putting it all together! – chillibasket_files/Flick-Unit-3.jpg" width="350" alt="Welcome!"></a><h4 class="jp-relatedposts-post-title"><a class="jp-relatedposts-post-a" href="http://wired.chillibasket.com/2014/08/welcome/" title="Welcome!

I have always had a great interest in electronics and technical things. Over the past few years I worked on a number of projects which I would really like to share on this blog. My main blog has turned out to be more of a photography blog, so I decided…" rel="nofollow" data-origin="299" data-position="2">Welcome!</a></h4><p class="jp-relatedposts-post-excerpt">I have always had a great interest in electronics and technical things. Over the past few years I worked on a number of projects which I would really like to share on this blog. My main blog has turned out to be more of a photography blog, so I decided…</p><p class="jp-relatedposts-post-date" style="display: block;">August 25, 2014</p><p class="jp-relatedposts-post-context">In "Announcement"</p></div></div></div>	

                    <div class="clearfix"></div>

                </div><!--END .entry-content .article-->

                <!--BEGIN .entry-meta .entry-footer-->
                <div class="entry-meta entry-footer row">

                    <div class="col-md-6">				
                                                    <div class="entry-categories"> <a href="http://wired.chillibasket.com/category/tutorial/self-balancing/" rel="category tag">Self-balancing</a>, <a href="http://wired.chillibasket.com/category/tutorial/" rel="category tag">Tutorial</a></div>
                                                        <div class="entry-tags"> <a href="http://wired.chillibasket.com/tag/accelerometer/" rel="tag">Accelerometer</a>, <a href="http://wired.chillibasket.com/tag/arduino/" rel="tag">Arduino</a>, <a href="http://wired.chillibasket.com/tag/balancing/" rel="tag">Balancing</a>, <a href="http://wired.chillibasket.com/tag/mpu6050/" rel="tag">MPU6050</a>, <a href="http://wired.chillibasket.com/tag/self-balancing/" rel="tag">Self-balancing</a>, <a href="http://wired.chillibasket.com/tag/stabilisation/" rel="tag">Stabilisation</a>, <a href="http://wired.chillibasket.com/tag/tutorial/" rel="tag">Tutorial</a></div>
                        							
                    </div>

                    <div class="col-md-6">
                            <div class="share-this">
        <a rel="nofollow" class="tipsytext" target="_blank" href="http://twitter.com/intent/tweet?status=Putting%20it%20all%20together!+%C2%BB+http://tinyurl.com/o7m8g8k" name="Share on Twitter"><i class="t4p-icon-social-twitter"></i></a>
        <a rel="nofollow" class="tipsytext" target="_blank" href="http://www.facebook.com/sharer/sharer.php?u=http://wired.chillibasket.com/2015/10/putting-it-all-together/&amp;t=Putting%20it%20all%20together!" name="Share on Facebook"><i class="t4p-icon-social-facebook"></i></a>
        <a rel="nofollow" class="tipsytext" target="_blank" href="https://plus.google.com/share?url=http://wired.chillibasket.com/2015/10/putting-it-all-together/" name="Share on Google Plus"><i class="t4p-icon-social-google-plus"></i></a>
        <a rel="nofollow" class="tipsytext" target="_blank" href="http://pinterest.com/pin/create/button/?url=http://wired.chillibasket.com/2015/10/putting-it-all-together/&amp;media=http://wired.chillibasket.com/wp-content/uploads/2015/10/BalancerDiagram1.jpg&amp;description=Putting%20it%20all%20together!" name="Share on Pinterest"><i class="t4p-icon-social-pinterest"></i></a>			
        <a rel="nofollow" class="tipsytext" target="_blank" href="http://www.addtoany.com/email?linkurl=http://wired.chillibasket.com/2015/10/putting-it-all-together/&amp;linkname=Putting%20it%20all%20together!" name="Share by Email"><i class="t4p-icon-social-envelope-o"></i></a>
        <a rel="nofollow" class="tipsytext" target="_blank" href="http://www.addtoany.com/share_save#url=http://wired.chillibasket.com/2015/10/putting-it-all-together/&amp;linkname=Putting it all together!" name="More options"><i class="t4p-icon-redo"></i></a>
    </div>
                        </div>

                </div><!--END .entry-meta .entry-footer-->

                <!-- Auto Discovery Trackbacks
                <rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="http://wired.chillibasket.com/2015/10/putting-it-all-together/"
    dc:identifier="http://wired.chillibasket.com/2015/10/putting-it-all-together/"
    dc:title="Putting it all together!"
    trackback:ping="http://wired.chillibasket.com/2015/10/putting-it-all-together/trackback/" />
</rdf:RDF>                -->

                <!--END .hentry-->
            </div>

                <!--BEGIN .navigation-links-->
    <div class="navigation-links single-page-navigation clearfix row">
        <div class="col-sm-6 col-md-6 nav-previous"><a href="http://wired.chillibasket.com/2015/03/pid-controller/" rel="prev">The PID Controller</a></div>
        <div class="col-sm-6 col-md-6 nav-next"><a href="http://wired.chillibasket.com/2016/06/my-3d-printer/" rel="next">My 3D Printer!</a></div>
        <!--END .navigation-links-->
    </div>
    <div class="clearfix"></div> 

<div id="comments">   
            <!--BEGIN #comments-->

                    <div class="comments-title-back"><h3 class="comment-title"><span class="comment-title-meta">61 Comments</span></h3>                <span class="comment-feed-link"><a class="tipsytext follow-replies" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/feed/" name="Follow replies"><i class="t4p-icon-social-rss"></i></a></span>
                <div class="clearfix"></div>
            </div>
            
        
                    <!--BEGIN .comment-list-->
            <ol class="comment-list">
                
    <!--BEING .comment-->
    <li class="comment first-comment reader reader-mic-hel" id="comment-286">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Mic Hel" src="./5. Putting it all together! – chillibasket_files/f624068c57936b97f6a344905741f548" srcset="http://0.gravatar.com/avatar/f624068c57936b97f6a344905741f548?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-f624068c57936b97f6a344905741f548-0"> <cite class="commenter fn n">Mic Hel</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 11, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-286"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>I got the same code for the L298N on intel galileo but in the serial dont show nothing and dont moved.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=286#respond" onclick="return addComment.moveForm( &quot;comment-286&quot;, &quot;286&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Mic Hel">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-287">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-0"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 12, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-287"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>It’s really difficult to help you out as your description of the problem is very vague! Have you tried testing the components separately with the Galileo? Are the components wired properly? Is the power plugged in… <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"></p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-sankalp-agrawal" id="comment-277">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Sankalp Agrawal" src="./5. Putting it all together! – chillibasket_files/167f361773c361d725c33eff9edc740c" srcset="http://1.gravatar.com/avatar/167f361773c361d725c33eff9edc740c?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-167f361773c361d725c33eff9edc740c-0"> <cite class="commenter fn n">Sankalp Agrawal</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">June 13, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-277"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi! my question is, why use the yaw control at all?</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=277#respond" onclick="return addComment.moveForm( &quot;comment-277&quot;, &quot;277&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Sankalp Agrawal">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-279">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-1"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">June 16, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-279"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>I included it as I planned to use it later to be able to steer and drive the robot around with a wireless controller. I also found that it helps to keep the robot facing the same direction, even if the motors are slightly mismatched.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-dilshan-fernando" id="comment-276">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="dilshan fernando" src="./5. Putting it all together! – chillibasket_files/598294bf50f8dcc2286fae06e46c5155" srcset="http://2.gravatar.com/avatar/598294bf50f8dcc2286fae06e46c5155?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-598294bf50f8dcc2286fae06e46c5155-0"> <cite class="commenter fn n">dilshan fernando</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">June 11, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-276"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>nice tutorial ..thank you very much ..nice lesson step by step</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=276#respond" onclick="return addComment.moveForm( &quot;comment-276&quot;, &quot;276&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to dilshan fernando">Reply</a></div>    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-shawn-s" id="comment-266">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Shawn S" src="./5. Putting it all together! – chillibasket_files/ad1cacb223fd87baa69f1835fb6fe3b6" srcset="http://1.gravatar.com/avatar/ad1cacb223fd87baa69f1835fb6fe3b6?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-ad1cacb223fd87baa69f1835fb6fe3b6-0"> <cite class="commenter fn n">Shawn S</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">May 2, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-266"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hello Simon,<br>
Thank you very much for the great tutorial! I have assembled the robot and am using the L298N motor controller, your code modified per your instructions. I have run code to test both the L298N (code here: <a href="http://tronixstuff.com/2014/11/25/tutorial-l298n-dual-motor-controller-modules-and-arduino/" rel="nofollow">http://tronixstuff.com/2014/11/25/tutorial-l298n-dual-motor-controller-modules-and-arduino/</a>) and the MPU6050 (code here: <a href="http://playground.arduino.cc/Main/MPU-6050#short" rel="nofollow">http://playground.arduino.cc/Main/MPU-6050#short</a>).<br>
However, when I open the serial monitor, all I get is “Testing MPU connection” and then nothing else. I don’t have real switches wired in–just using jumpers for testing, nor do I have LED’s (using a freshly charged LiPo).<br>
Any ideas where I’ve gone wrong?</p>
<p>[Update] Found the possible source of the problem–line 173 says printf, where it should be serial.println (?)</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=266#respond" onclick="return addComment.moveForm( &quot;comment-266&quot;, &quot;266&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Shawn S">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-268">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-2"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">May 2, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-268"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Yes you can remove that line. Printf() does work on the Galileo micro-controller I was using, but may not work for some Arduino boards. </p>
<p>Other issues may be:<br>
&gt; Incorrect wiring of the sensor – test the sensor using some sample code first to make sure it is working.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-shawn-s" id="comment-269">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Shawn S" src="./5. Putting it all together! – chillibasket_files/ad1cacb223fd87baa69f1835fb6fe3b6" srcset="http://1.gravatar.com/avatar/ad1cacb223fd87baa69f1835fb6fe3b6?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-ad1cacb223fd87baa69f1835fb6fe3b6-1"> <cite class="commenter fn n">Shawn S</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">May 4, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-269"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Thanks for the input, Simon. I have tested the sensor and input new MPU offset values. The problem I’m having now comes with the L298N motor controller. I modified the code per your earlier post. As long as I do not power the L298N on, the serial monitor displays the pwm correctly. As soon as I turn the motor power on, the motors immediately start spinning one way or the other and the serial monitor either freezes or returns “nan” until I reset the board.<br>
One of the other little problems is that it never starts automatically. I always have to manually enable the balancing system. I’m using an UNO board, BTW.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-270">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-3"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">May 4, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-270"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>(1) If the program freezes just as the motors turn on, then you might be experiencing a power brown-out. This happens when the motors use up all available power, causing the Arduino to turn off. Check that your power supply can provide enough current. Alternatively, you can use a separate power supply just for the motors. What are the specs on your LiPo?<br>
(2) To turn the balancing system on by default change the variable on line 120 to “int modeSelect = 1;”.<br>
(3) If your MPU-6050 has a logic voltage of 3.3V and you don’t have any logic voltage level shifter on the I/O lines, you will be more prone to getting misreadings of the sensor data. The Arduino works at 5V, so it will only have a margin of (3.3 – 2.5 = 0.8V) for detecting a high data bit. In most cases, the sensor will probably still work, but it can lead to some unexpected errors.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-shawn-s" id="comment-271">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Shawn S" src="./5. Putting it all together! – chillibasket_files/ad1cacb223fd87baa69f1835fb6fe3b6" srcset="http://1.gravatar.com/avatar/ad1cacb223fd87baa69f1835fb6fe3b6?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-ad1cacb223fd87baa69f1835fb6fe3b6-2"> <cite class="commenter fn n">Shawn S</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">May 5, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-271"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Simon,<br>
1. I have a 2-cell (7.4V) 1300 mAh battery. All of this is with the USB providing power to the UNO though.<br>
2. I did have it turned off-thanks!<br>
Got it working! It turns out that the UNO board I have does not have the PWM-capable pins marked with a tilde like most other boards, so I assumed that a change had been made to support PWM on all pins and just used whatever pin looked good. I switched them to honour known PWM-capable pins and problem solved! Also, my battery is old and dies quickly, so a new one is in order. </p>
<p>Thanks again for your help!!!!!!</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-omar-garcia" id="comment-264">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Omar Garcia" src="./5. Putting it all together! – chillibasket_files/18522b29ff0fa8edb438485926699a48" srcset="http://1.gravatar.com/avatar/18522b29ff0fa8edb438485926699a48?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-18522b29ff0fa8edb438485926699a48-0"> <cite class="commenter fn n">Omar Garcia</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">April 20, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-264"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Mr. Simon, first one I’d like to tell you your robot is awesome, congratulations. second one, I understand you chose to implement Galileo to process capability about it, I’m interesting to implement it on Arduino Uno to academic’s applications but, I have a little question, could you tell me what kind of DC motor are you using? you’re using DC 5V motor or 12V motor.<br>
And one more time, congratulation excellent blog.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=264#respond" onclick="return addComment.moveForm( &quot;comment-264&quot;, &quot;264&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Omar Garcia">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-265">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-4"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">April 20, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-265"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi, all of the details about the parts I used are in the <a href="http://wired.chillibasket.com/2014/09/balancing-robot-intro/">first post of this tutorial</a>. I used two 12V DC motors, and an Arduino Motor Shield to drive them.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-omar-garcia" id="comment-272">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Omar Garcia" src="./5. Putting it all together! – chillibasket_files/18522b29ff0fa8edb438485926699a48" srcset="http://1.gravatar.com/avatar/18522b29ff0fa8edb438485926699a48?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-18522b29ff0fa8edb438485926699a48-1"> <cite class="commenter fn n">Omar Garcia</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">May 12, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-272"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>hi again, i have a question about buttons and leds number pin, or your code you’re using different pins that your schematics, i don’t know if it’s only a mistake or i have to follow code and schematic as you have them?</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-273">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-5"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">May 12, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-273"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>It’s a mistake, thanks for spotting it. I’ve updated the code now to suit the schematic.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-omar-garcia" id="comment-274">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Omar Garcia" src="./5. Putting it all together! – chillibasket_files/18522b29ff0fa8edb438485926699a48" srcset="http://1.gravatar.com/avatar/18522b29ff0fa8edb438485926699a48?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-18522b29ff0fa8edb438485926699a48-2"> <cite class="commenter fn n">Omar Garcia</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">May 14, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-274"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>I implement your code and schematic but im not sure what happen, only one motor is working, i tested two motor with a DC power supply and they’re fine or my problem can be by my switches could be damaged?</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-bingo" id="comment-261">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Bingo" src="./5. Putting it all together! – chillibasket_files/9bb01d1142554181a75b2c94e445563f" srcset="http://0.gravatar.com/avatar/9bb01d1142554181a75b2c94e445563f?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-9bb01d1142554181a75b2c94e445563f-0"> <cite class="commenter fn n">Bingo</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">March 25, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-261"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi there Simon, I managed to adapt your code for my MD25 motor controller, but it seems I’m having some problems in making the motors run in correct direction.<br>
My idea is to change</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a01d678a80cb121870658" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">// Send command to left motor
    if (left_PWM &gt;= 0) MyBoard.setMotor1Speed(int(left_PWM));     // '0' = Left-motor, '1' = Right-motor
    else MyBoard.setMotor1Speed((int(left_PWM) * -1));
  // Send command to right motor
    if (right_PWM &gt;= 0) MyBoard.setMotor2Speed(int(right_PWM));   // '0' = Forward, '1' = Backward
    else MyBoard.setMotor2Speed((int(right_PWM) * -1)); </textarea></div>
			<div class="crayon-main" style="max-height: 250px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a01d678a80cb121870658-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a80cb121870658-2">2</div><div class="crayon-num" data-line="crayon-5a01d678a80cb121870658-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a80cb121870658-4">4</div><div class="crayon-num" data-line="crayon-5a01d678a80cb121870658-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a80cb121870658-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a01d678a80cb121870658-1"><span class="crayon-c">// Send command to left motor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a80cb121870658-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">left_PWM</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">MyBoard</span><span class="crayon-sy">.</span><span class="crayon-e">setMotor1Speed</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">left_PWM</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// '0' = Left-motor, '1' = Right-motor</span></div><div class="crayon-line" id="crayon-5a01d678a80cb121870658-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">MyBoard</span><span class="crayon-sy">.</span><span class="crayon-e">setMotor1Speed</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">left_PWM</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a80cb121870658-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Send command to right motor</span></div><div class="crayon-line" id="crayon-5a01d678a80cb121870658-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">right_PWM</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-v">MyBoard</span><span class="crayon-sy">.</span><span class="crayon-e">setMotor2Speed</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">right_PWM</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// '0' = Forward, '1' = Backward</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a80cb121870658-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">MyBoard</span><span class="crayon-sy">.</span><span class="crayon-e">setMotor2Speed</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">right_PWM</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>And remove the * -1 should fix my problem, because my robot is running on – as backwards and + as forward. The thing is that whenever I do that and upload my code it won’t run.. In serial it will always loop in Testing MP ( Looks like its trying to print Testing MPU…, but keeps looping it with a cut off). Hope you understand what I mean and give me a quick reply.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=261#respond" onclick="return addComment.moveForm( &quot;comment-261&quot;, &quot;261&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Bingo">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-263">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-6"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">March 29, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-263"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi, removing the -1 will not solve your problem. What the -1 is doing is changing the negative PID result into a positive number which can be used as a PWM output. PWM values have to be in range of 0-255. To adapt the code to work with your motor controller, all you have to change is the code in the “void Move(int motor, int direction, int speed)” function, as well as your pin numbers. The easiest way to change the direction the motor is spinning is to swap the ‘+’ and ‘-‘ wires connected to the motor.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-michael" id="comment-256">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Michael" src="./5. Putting it all together! – chillibasket_files/fb0b6cdbbe1bdaf0a896591838c3f176" srcset="http://0.gravatar.com/avatar/fb0b6cdbbe1bdaf0a896591838c3f176?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-fb0b6cdbbe1bdaf0a896591838c3f176-0"> <cite class="commenter fn n">Michael</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">March 3, 2017</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-256"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>If I don’t want to use 2 button like you, How can I change this code? Please help me!!</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=256#respond" onclick="return addComment.moveForm( &quot;comment-256&quot;, &quot;256&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Michael">Reply</a></div>    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-maria-dass" id="comment-243">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Maria Dass" src="./5. Putting it all together! – chillibasket_files/8d94c6cab6006a08d047c65eb04932fc" srcset="http://2.gravatar.com/avatar/8d94c6cab6006a08d047c65eb04932fc?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-8d94c6cab6006a08d047c65eb04932fc-0"> <cite class="commenter fn n">Maria Dass</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">December 8, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-243"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi, i tried to connect it to button pin 5 instead of pin 7, pin 3 and 4 for led . i  modified the code as per the adafruit motor shield like as you said.  it works but i have doubt what does this mean shows in error column . But still robot  is trying  to stand </p>
<p>sketch\MPU6050_6Axis_MotionApps20.h:639:52: warning: left shift count &gt;= width of type [enabled by default]</p>
<p>     data[2] = ((packet[24] &lt;&lt; 24) + (packet[25] &lt;&lt; 16) + (packet[26] &lt;&lt; 8) + packet[27]);</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=243#respond" onclick="return addComment.moveForm( &quot;comment-243&quot;, &quot;243&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Maria Dass">Reply</a></div>    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-maria-dass" id="comment-240">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Maria Dass" src="./5. Putting it all together! – chillibasket_files/8d94c6cab6006a08d047c65eb04932fc" srcset="http://2.gravatar.com/avatar/8d94c6cab6006a08d047c65eb04932fc?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-8d94c6cab6006a08d047c65eb04932fc-1"> <cite class="commenter fn n">Maria Dass</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">December 7, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-240"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hello Simon,<br>
Your tutorial on self balancing robot is awesome, i am new to programming and  was searching  a lot on net couldn’t understand how to start. your post really helped a lot .<br>
i have used adafruit motor shield v1  and tried to connect it as similarly. everything seem to be fine but the motors  run only when the button 2 is pressed. tell me how can i solve it .<br>
thanks for your great post ,<br>
Maria dass</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=240#respond" onclick="return addComment.moveForm( &quot;comment-240&quot;, &quot;240&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Maria Dass">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-242">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-7"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">December 7, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-242"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Is BTN_2 connected to power or to ground? Try changing the value to <code>modeSelect = 1</code> on line 120 of the code. Those the robot work now?<br>
I think that the code for the Adafruit Motor shield is slightly different than for the motor controller that I was using. Adafruit has a separate library for its shield, and you can see some examples of <a href="https://learn.adafruit.com/adafruit-motor-shield/using-dc-motors" rel="nofollow">how to use it here</a>.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-ronaldo-carvalho" id="comment-229">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Ronaldo carvalho" src="./5. Putting it all together! – chillibasket_files/703863129d2485d80a049b4d09f05dd0" srcset="http://1.gravatar.com/avatar/703863129d2485d80a049b4d09f05dd0?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-703863129d2485d80a049b4d09f05dd0-0"> <cite class="commenter fn n">Ronaldo carvalho</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">September 3, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-229"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>heeelllpppp me please… i make all conection right but the motors dont work :(, i´m use arduino uno, MPU 6050, drive l298n, i´m follow all steps of your tutorial ( include the changes with l298n) but it dont work… in serial monitor, bauds is 115200 but this showing only symbols., but i think than code run correct because when i press one of the buttons, LED bright… i need realy realy your help… pls take me back. (sorry for my bad english, i´m Brazilian</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=229#respond" onclick="return addComment.moveForm( &quot;comment-229&quot;, &quot;229&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Ronaldo carvalho">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-232">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-8"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">September 9, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-232"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>That does sound weird. Could you send me a picture of your setup, showing how the Arduino and motor controller is wired up?</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-ronaldo-carvalho" id="comment-228">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Ronaldo carvalho" src="./5. Putting it all together! – chillibasket_files/703863129d2485d80a049b4d09f05dd0" srcset="http://1.gravatar.com/avatar/703863129d2485d80a049b4d09f05dd0?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-703863129d2485d80a049b4d09f05dd0-1"> <cite class="commenter fn n">Ronaldo carvalho</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">August 30, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-228"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Simon, after all, gratz for this amazing tuto,<br>
I’m Brazilian , I’m following your tutorial, but I’m using an Arduino ( UNO ) and L298N bridge, i make ​​the right connections and the change in the code as you indicated , but nothing happens when I turn it on, and the “Serial Monitor” shows only symbols … Bauld is the same as the code. sorry for my bad English, and grateful for an answer.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=228#respond" onclick="return addComment.moveForm( &quot;comment-228&quot;, &quot;228&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Ronaldo carvalho">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-231">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-9"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">September 9, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-231"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>The serial monitor only shows symbols? This usually happens only when the baud rate is wrong, or when there are other devices connected to the ‘0’ and ‘1’ digital pins on the Arduino. Have you tested each of the parts of the robot individually, to see if they work (IMU, motor controller, etc.)?</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-merzoug7 microid-mailto+http:sha1:029c9c041f8c9bd67d3196a8e3b593f0ab3d219c" id="comment-224">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="merzoug7" src="./5. Putting it all together! – chillibasket_files/8cb72dab08a98b89fb009f4181b007a5" srcset="http://2.gravatar.com/avatar/8cb72dab08a98b89fb009f4181b007a5?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-8cb72dab08a98b89fb009f4181b007a5-0"> <cite class="commenter fn n"><a href="http://gravatar.com/ahmed771" rel="external nofollow" class="url">merzoug7</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">April 13, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-224"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hello Simon I want to say thanks a lot about your tutorial for the self balancing robot it was really helpful. I have just one question, I have two xbee module and i’m trying to use them for controlling my robot buy your code do you have any idea how to implement and use them and thank you very much.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=224#respond" onclick="return addComment.moveForm( &quot;comment-224&quot;, &quot;224&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to merzoug7">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-226">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-10"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">April 23, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-226"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi, sorry for the delay! Integrating xBees is pretty easy; you can just connect the RX and TX pins on the xBee shield to those on the Arduino. You can then use the xBees as if they simply are a wireless serial port cable. Check out <a href="http://tronixstuff.com/2010/08/06/moving-forward-with-arduino-chapter-14-xbee-introduction/" rel="nofollow">this tutorial</a> about using xBees.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-ahmed771ahmed7 microid-mailto+http:sha1:029c9c041f8c9bd67d3196a8e3b593f0ab3d219c" id="comment-223">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="ahmed771ahmed7" src="./5. Putting it all together! – chillibasket_files/8cb72dab08a98b89fb009f4181b007a5" srcset="http://2.gravatar.com/avatar/8cb72dab08a98b89fb009f4181b007a5?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-8cb72dab08a98b89fb009f4181b007a5-1"> <cite class="commenter fn n"><a href="http://gravatar.com/ahmed771" rel="external nofollow" class="url">ahmed771ahmed7</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">April 11, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-223"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Simon, very nice project man, but I am using the L298N shield insted of your shield could you please help me to change the code for me.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=223#respond" onclick="return addComment.moveForm( &quot;comment-223&quot;, &quot;223&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to ahmed771ahmed7">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-225">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-11"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">April 23, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-225"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>I’ve already given a solution to the L298N motor controller in a previous comment here <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/comment-page-1/#comment-190">[link]</a>. If you have any questions about the fix, please let me know!</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-s.m.farhan" id="comment-219">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="S.M.FARHAN" src="./5. Putting it all together! – chillibasket_files/57a50e956742c91a1707fbb93f260120" srcset="http://2.gravatar.com/avatar/57a50e956742c91a1707fbb93f260120?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-57a50e956742c91a1707fbb93f260120-0"> <cite class="commenter fn n">S.M.FARHAN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">January 3, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-219"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi! Mr.Simon<br>
When I write this <code>Serial.println(PIDValue);</code> so PWM sent on, the motor is constantly a no (i.e. 3) continuously. couldn’t understand why only PWM is 3 sent to the motor.. Please Suggest.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=219#respond" onclick="return addComment.moveForm( &quot;comment-219&quot;, &quot;219&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to S.M.FARHAN">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-221">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-12"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">January 3, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-221"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>That is weird; was your code working normally before you put that one line in? Are you using the same code that I have displayed in the post above? If the PWM value really does stay at around 3, then the only possible explanation is that the sensor is not working properly. Common problems with the sensor are: incorrect wiring, incorrect pin-mapping, wrong offsets, or that the sensor is broken.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-gökhn" id="comment-210">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="GökhN" src="./5. Putting it all together! – chillibasket_files/2d9d44d14f2567e7291789f9cc0917f5" srcset="http://2.gravatar.com/avatar/2d9d44d14f2567e7291789f9cc0917f5?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-2d9d44d14f2567e7291789f9cc0917f5-0"> <cite class="commenter fn n">GökhN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">December 24, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-210"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Simon. First, thank you very much for sharing this. I bought android controlled balance robot for final project. But I could not. I had little time. I used the code you’re sharing but it did not work. Why could it be? I am using the L293. I made the right connections. But it did not… thank you.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=210#respond" onclick="return addComment.moveForm( &quot;comment-210&quot;, &quot;210&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to GökhN">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-212">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-13"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">December 24, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-212"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi there! Before I can give you some advice, I’ll need to know a lot more about the robot you are using, and what exactly ‘did not work’. Here are a couple of questions:</p>
<p>1) What micro-controller are you using <i>(you mentioned Android; if so, then this is the wrong tutorial for you)</i>?<br>
2) Is your pin-mapping correct? I know that the L293 requires different wiring, which I have already discussed in the <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/comment-page-1/#comment-190" rel="nofollow">comments here</a>.<br>
3) What accelerometer or gyroscope are you using?<br>
4) Have you tested to see if all of the components work individually?<br>
5) What happened when you tried to run the code?<br>
6) How experienced are you with programming &amp; electronics?</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired" id="comment-216">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="GökhN" src="./5. Putting it all together! – chillibasket_files/2d9d44d14f2567e7291789f9cc0917f5" srcset="http://2.gravatar.com/avatar/2d9d44d14f2567e7291789f9cc0917f5?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-2d9d44d14f2567e7291789f9cc0917f5-1"> <cite class="commenter fn n">GökhN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">December 30, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-216"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p><code>http://www.robimek.com/android-kontrollu-dengede-duran-robot-yapimi/</code><br>
I built the circuit here. First I need to do  balance, then I’ll do the last part of the android. I connect pins correctly; I checked a lot of times. I am using MPU6050. I checked all the elements, my electronic and software information not bad. I use the Arduino. I hope you will help me, thank you.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-220">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-14"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">January 3, 2016</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-220"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi GökhN, sorry for the delayed reply, I’m very busy with college exams at the moment. In my post above I have a section which discusses how to use my program and how to deal with common errors. What exactly do you see on the serial monitor when the robot is running? How does it differ from the normal running of the program which I described above? You could try printing out the sensor angle, or the PWM value to the serial (as I described in <a href="http://wired.chillibasket.com/self-balancing-robot/#comment-217" rel="nofollow">this comment</a>) to see if there are any bugs with the sensor.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-s.m.farhan" id="comment-203">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="S.M.FARHAN" src="./5. Putting it all together! – chillibasket_files/57a50e956742c91a1707fbb93f260120" srcset="http://2.gravatar.com/avatar/57a50e956742c91a1707fbb93f260120?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-57a50e956742c91a1707fbb93f260120-1"> <cite class="commenter fn n">S.M.FARHAN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 25, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-203"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Simon! After all, due to Your tutorial, I made my robot to stand vertical! Thanks!<br>
But I want to show/print the PWM (Speed) of the motors on my Software Serial Monitor. So what changes should I want to make on your Code! Please Suggest. Thanks in Advance.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=203#respond" onclick="return addComment.moveForm( &quot;comment-203&quot;, &quot;203&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to S.M.FARHAN">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-204">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-15"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 25, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-204"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Well done in getting your robot to work! To output the PWM value of the motors to serial, simple insert the following line on (line 252) of my code above:<br>
<code>Serial.println(PIDValue);</code></p>
<p>Please note: outputting data over serial is a slow process, so continuously outputting the PWM value will increase the latency of the robot a little bit.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired" id="comment-190">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Serge de Chazelles" src="./5. Putting it all together! – chillibasket_files/c08b6751ee168a9ee28a4a6156f16357" srcset="http://0.gravatar.com/avatar/c08b6751ee168a9ee28a4a6156f16357?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c08b6751ee168a9ee28a4a6156f16357-0"> <cite class="commenter fn n">Serge de Chazelles</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 18, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-190"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Simon, I’m on my first try, but seems I don’t connect the Motor PIN correctly. Nothing happens on the motors; Even the most little Brrrr <img draggable="false" class="emoji" alt="😉" src="./5. Putting it all together! – chillibasket_files/1f609.svg"> . I’m using a L298N Motor Driver module Board. I checked with an other Arduino program for testing and it ran, not perfectly, but let me know that module is running. Besides it, the reference of Pins are not same as yours. It looks like <code>ENA IN1 IN2 IN3 IN4 ENB</code>. what is the correspondence with yours? I tried different ways to plug without success. Please I need your help.<br>
In the serial window, when I run your program, it prints “<code>DMP Ready! Let's Proceed.</code>“, then stops. What should happen after? </p>
<p>Thks in advance.<br>
Serge</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=190#respond" onclick="return addComment.moveForm( &quot;comment-190&quot;, &quot;190&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Serge de Chazelles">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-191">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-16"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 18, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-191"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Serge, the wiring for the <i>L298N Motor Driver</i> is slightly different than for the one I am using. Below I have included what the required changes to my code. Please read through <u><a href="http://tronixstuff.com/2014/11/25/tutorial-l298n-dual-motor-controller-modules-and-arduino/" rel="nofollow">this tutorial first</a></u>, so that you understand the syntax I am using. </p>
<p>You should attach the wires as following:</p>
<ul>
<li>in1 to GPIO-12</li>
<li>in2 to GPIO-13</li>
<li>in3 to GPIO-8</li>
<li>in4 to GPIO-9</li>
<li>enA to GPIO-11</li>
<li>enB to GPIO-3</li>
</ul>
<p>Next you have to update some parts of the code in order for the motor controller to work, as the syntax is slightly different:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a01d678a8de4646387158" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title">Bluetooth Code Integration</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">/*
 * I've included line numbers where you can insert each part
 * into my self-balancing robot code.
 */

// (line 54-59) - Replace pin mapping with the following:
#define IN_1 12;
#define IN_2 13;
#define PWM_A 11;
#define IN_3 8;
#define IN_4 9;
#define PWM_B 3;

// (line 165-168) - Replace initialisation with the following:
pinMode(IN_1, OUTPUT);     // Motor A - 1
pinMode(IN_2, OUTPUT);     // Motor A - 2
pinMode(IN_3, OUTPUT);     // Motor B - 1
pinMode(IN_4, OUTPUT);     // Motor B - 2

// (line 369-433) - Replace motor controller function with this:
// -------------------------------------------------------------------
//           MOTOR CONTROLLER
// -------------------------------------------------------------------

void Move(int motor, int direction, int speed) {            

    // Left Motor
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    if (motor == 0){
    
        // Set motor direction (only if it is currently not that direction)
        if (direction == 0){
            if (direction_A == 1){
                digitalWrite(IN_1, HIGH);        // Forwards
                digitalWrite(IN_2, LOW);
            }
            direction_A = 0;
        } else {
            if (direction_A == 0){
                digitalWrite(IN_1, LOW);        // Backwards
                digitalWrite(IN_2, HIGH);
            }
            direction_A = 1;
        }
        
        // Release brake (only if brake is active)
        if (brake_A == 1){
            brake_A = 0;
        }
        
        // Send PWM data to motor A
        analogWrite(PWM_A, speed);


    // Right Motor
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    } else if (motor == 1){
    
        // Set motor direction (only if it is currently not that direction)
        if (direction == 0){
            if (direction_B == 1){
                digitalWrite(IN_3, HIGH);        // Forwards
                digitalWrite(IN_4, LOW);
            }
            direction_B = 0;
        } else {
            if (direction_B == 0){
                digitalWrite(IN_3, LOW);        // Backwards
                digitalWrite(IN_4, HIGH);
            }
            direction_B = 1;
        }
        
        // Release brake (only if brake is active)
        if (brake_B == 1){
            brake_B = 0;
        }
        
        // Send PWM data to motor A
        analogWrite(PWM_B, speed);


    // Stop both motors
    // -- -- -- -- -- -- -- -- -- -- -- -- -- --
    } else if (motor = 3){  

        analogWrite(PWM_A, 0);
        analogWrite(PWM_B, 0);
        digitalWrite(IN_1, LOW);
        digitalWrite(IN_2, LOW);
        digitalWrite(IN_3, LOW);
        digitalWrite(IN_4, LOW);
        brake_A = 1;
        brake_B = 1;

    }
}</textarea></div>
			<div class="crayon-main" style="max-height: 250px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-2">2</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-4">4</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-6">6</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-8">8</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-10">10</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-12">12</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-14">14</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-16">16</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-18">18</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-20">20</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-22">22</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-24">24</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-26">26</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-28">28</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-30">30</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-32">32</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-34">34</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-36">36</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-38">38</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-40">40</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-42">42</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-44">44</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-46">46</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-48">48</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-50">50</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-52">52</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-54">54</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-56">56</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-58">58</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-60">60</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-62">62</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-64">64</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-66">66</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-68">68</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-70">70</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-72">72</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-74">74</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-76">76</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-78">78</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-80">80</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-82">82</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-84">84</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-86">86</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-88">88</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-90">90</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-92">92</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-94">94</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a8de4646387158-96">96</div><div class="crayon-num" data-line="crayon-5a01d678a8de4646387158-97">97</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a01d678a8de4646387158-1"><span class="crayon-c">/*</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-2"><span class="crayon-c"> * I've included line numbers where you can insert each part</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-3"><span class="crayon-c"> * into my self-balancing robot code.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-4"><span class="crayon-c"> */</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-6"><span class="crayon-c">// (line 54-59) - Replace pin mapping with the following:</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-7"><span class="crayon-p">#define IN_1 12;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-8"><span class="crayon-p">#define IN_2 13;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-9"><span class="crayon-p">#define PWM_A 11;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-10"><span class="crayon-p">#define IN_3 8;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-11"><span class="crayon-p">#define IN_4 9;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-12"><span class="crayon-p">#define PWM_B 3;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-14"><span class="crayon-c">// (line 165-168) - Replace initialisation with the following:</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-15"><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">IN_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Motor A - 1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-16"><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">IN_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Motor A - 2</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-17"><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">IN_3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Motor B - 1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-18"><span class="crayon-e">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">IN_4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Motor B - 2</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-20"><span class="crayon-c">// (line 369-433) - Replace motor controller function with this:</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-21"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-22"><span class="crayon-c">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MOTOR CONTROLLER</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-23"><span class="crayon-c">// -------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-24">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-25"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">Move</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">motor</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">direction</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">speed</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-26">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Left Motor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">motor</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Set motor direction (only if it is currently not that direction)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Forwards</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Backwards</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">direction_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Release brake (only if brake is active)</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">brake_A</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">brake_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Send PWM data to motor A</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">PWM_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">speed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-54">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Right Motor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">motor</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Set motor direction (only if it is currently not that direction)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Forwards</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Backwards</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-71"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">direction_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-74"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Release brake (only if brake is active)</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">brake_B</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">brake_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Send PWM data to motor A</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">PWM_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">speed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-81">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-82">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Stop both motors</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-84"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// -- -- -- -- -- -- -- -- -- -- -- -- -- --</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">motor</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-86">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">PWM_A</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">PWM_B</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">IN_4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">brake_A</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-94"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">brake_B</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-95">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a8de4646387158-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a8de4646387158-97"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0136 seconds] -->
<p></p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-serge-de-chazelles" id="comment-192">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Serge de Chazelles" src="./5. Putting it all together! – chillibasket_files/c08b6751ee168a9ee28a4a6156f16357" srcset="http://0.gravatar.com/avatar/c08b6751ee168a9ee28a4a6156f16357?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c08b6751ee168a9ee28a4a6156f16357-1"> <cite class="commenter fn n">Serge de Chazelles</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 18, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-192"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Thanks Simon for your fast reply, I did what you told me nicely. I noticed a change. The motors have turned :). Beside it, reaction of the robot is not the expected, I guess it is now I have to calibrate the PID? May you tell me what should exactly happen when I enter P .. then I … The robot is always on vertical position, when I enter P .. then P again, etc. what should happen? Should I try to balance it to see it reaction ?<br>
Thks a lot for all your reply <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"> </p>
<p>Serge</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-193">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-17"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 18, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-193"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>A number of people have asked about how to use the program, so I am thinking of making a video to explain. I’ve updated the post above to include a quick breakdown of how to use the program, and how to deal with some common errors. Hopefully this will answer your questions!</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-serge-de-chazelles" id="comment-195">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Serge de Chazelles" src="./5. Putting it all together! – chillibasket_files/c08b6751ee168a9ee28a4a6156f16357" srcset="http://0.gravatar.com/avatar/c08b6751ee168a9ee28a4a6156f16357?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c08b6751ee168a9ee28a4a6156f16357-2"> <cite class="commenter fn n">Serge de Chazelles</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 18, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-195"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Ur Last post is a good help!!<br>
I didn’t understood the way to enter the P I D value <img draggable="false" class="emoji" alt="😉" src="./5. Putting it all together! – chillibasket_files/1f609.svg"><br>
Beside it what the <br><code>&gt;&gt;&gt;&gt; Initializing &lt;&lt;&lt;</code> <code>&gt;&gt;&gt; Stopped &lt;&lt;&lt;&lt;</code><br>
messages mean? Video will surely be a good help too!</p>
<p>Thks so much for all ur sharing.</p>
<p>Serge</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-196">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-18"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 18, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-196"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>I have updated the program code in my post, since you first used it, so <br><code>&gt;&gt;&gt;&gt; Initialing &lt;&lt;&lt;&lt;</code> is now called <code>&gt;&gt;&gt;&gt; Balancing System Active &lt;&lt;&lt;&lt;</code> and <br><code>&gt;&gt;&gt;&gt;Stopped &lt;&lt;&lt;&lt;</code> is now <code>&gt;&gt;&gt;&gt; Balancing System Stopped &lt;&lt;&lt;&lt;</code>. This is the automatic fall-detection system turning the motors on/off. </p>
<p>I’ve tried to make the PID updating method easier to understand, but there isn’t much more I can do without a video. Unfortunately it will be at least 2-3 weeks until I have time to post the video.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-serge-de-chazelles" id="comment-199">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Serge de Chazelles" src="./5. Putting it all together! – chillibasket_files/9fbce080e36283908c5da12880f377ca" srcset="http://0.gravatar.com/avatar/9fbce080e36283908c5da12880f377ca?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-9fbce080e36283908c5da12880f377ca-0"> <cite class="commenter fn n">Serge de Chazelles</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 20, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-199"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Simon, some news about my project <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"><br>
Yesterday evening I finally succeeded to make it “standing up” alone, I started to initialise PID … but, because there is one “but”, I think the motors I use are too greedy on power <img draggable="false" class="emoji" alt="🙁" src="./5. Putting it all together! – chillibasket_files/1f641.svg"><br>
For now I’m using some “normal” batteries, not rechargeable, my mistake. Even it is right level on voltage, it empty them too fast.<br>
It will be the next step, I have to modify it soon <img draggable="false" class="emoji" alt="😉" src="./5. Putting it all together! – chillibasket_files/1f609.svg"><br>
A little question anyway, I noticed that for correcting it position, it is tendency to turn on itself, as right motor respond more than left, it is not on right line as I thought it should be. Do you think it is due some setting or the powering? </p>
<p>Have a good day<br>
Serge</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-200">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-19"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 20, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-200"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>My code has an integrated yaw controller. This is a function that uses the sensor in order to prevent the robot from changing direction. Obviously this isn’t working well on your robot. Try turning off my direction controller by setting the values on lines 102 and 103 to zero. Let me know if this makes any difference!</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-serge-de-chazelles" id="comment-183">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Serge de Chazelles" src="./5. Putting it all together! – chillibasket_files/c08b6751ee168a9ee28a4a6156f16357" srcset="http://0.gravatar.com/avatar/c08b6751ee168a9ee28a4a6156f16357?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c08b6751ee168a9ee28a4a6156f16357-3"> <cite class="commenter fn n">Serge de Chazelles</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 15, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-183"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Simon, I’m french and on the way to build my own balancing robot. There are some days long I read and read again all about your so good explain, i already calibrating my MPU 6050, with no problem. I’m not really a beginner on Arduino, but not as good as u are <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"> I’m Using Arduino Uno. I’m close to be able to do my first rolling, I just a bit “anxious” about the calibration of PID. My wish is to add some simple IR command or sensor, later, so I will maybe need your help <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"> Beside it I asked myself if it will be possible to delete the command line about the calibration, after it is complete and running the best, to have some more line and bytes available?<br>
I hope I’m clear enough, forgive my not perfect english anyway.<br>
Thanks for your concern.</p>
<p>Serge</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=183#respond" onclick="return addComment.moveForm( &quot;comment-183&quot;, &quot;183&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to Serge de Chazelles">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-184">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-20"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 15, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-184"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hello!<br>
It’s great to know that you find my tutorials helpful! <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"> Of course you can remove the serial communication / calibration part of the code, if you think it is no longer needed. My program only uses about 70% of the Arduino Uno’s memory, so you still have a bit of room to add additional features. Calibrating the PID controller is tricky, but there is no need to be anxious!<br>
Simon</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-serge-de-chazelles" id="comment-188">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Serge de Chazelles" src="./5. Putting it all together! – chillibasket_files/c08b6751ee168a9ee28a4a6156f16357" srcset="http://0.gravatar.com/avatar/c08b6751ee168a9ee28a4a6156f16357?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c08b6751ee168a9ee28a4a6156f16357-4"> <cite class="commenter fn n">Serge de Chazelles</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 16, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-188"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Thks again, I will come back, soon ….. will let you know how things ran <img draggable="false" class="emoji" alt="😉" src="./5. Putting it all together! – chillibasket_files/1f609.svg"> …<br>
I will like “create” my own MIP, a little dream <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"> </p>
<p>Serge</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-serge-de-chazelles" id="comment-197">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Serge de Chazelles" src="./5. Putting it all together! – chillibasket_files/c08b6751ee168a9ee28a4a6156f16357" srcset="http://0.gravatar.com/avatar/c08b6751ee168a9ee28a4a6156f16357?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c08b6751ee168a9ee28a4a6156f16357-5"> <cite class="commenter fn n">Serge de Chazelles</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 18, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-197"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Simon, I keep for now the first program you made, I will see later for replacing the “automatic” part.<br>
I succeeded to make the wheels reacting on the movement.. but there still is a problem, maybe due the battery power I use for the motors. It seems they are not reacting enough to the pulse sent to them for really turning frankly, and just turn slowly.<br>
Is there a value (as speed) linked to the program that can be influencing this? Or should I really look my side about the powering!</p>
<p>I run forward slowly, but it is passionating <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"> thats cool.</p>
<p>Serge</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-198">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-21"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 18, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-198"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>It really depends on the motors you are using. For example if they are rated for <i>12v</i>, then the power supply for the motor controller should also be <i>12v</i>. If the voltage is correct, then the only other way of increasing the speed is to increase the [P]-value constant of the PID controller.</p>
<p>Simon</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-serge-de-chazelles" id="comment-201">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Serge de Chazelles" src="./5. Putting it all together! – chillibasket_files/c08b6751ee168a9ee28a4a6156f16357" srcset="http://0.gravatar.com/avatar/c08b6751ee168a9ee28a4a6156f16357?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c08b6751ee168a9ee28a4a6156f16357-6"> <cite class="commenter fn n">Serge de Chazelles</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 21, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-201"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Good evening Simon,</p>
<p>I finally succeeded to make it standing up a while <img draggable="false" class="emoji" alt="🙂" src="./5. Putting it all together! – chillibasket_files/1f642.svg"> Houra !<br>
I changed the 102 &amp; 103 line to 0, as u suggested, it is more right deplacement for sure and better for now.<br>
Is there a way to share with you a short video ?<br>
I have to do progress with D .. (i changed P I and D on p i and d, was easier to enter ) </p>
<p>Next Step: Level battery status.. that’s important! Then IR command or some distance sensor… what a challenge! </p>
<p>Did you make some change your side, some “evolution” on yours? I think some bluetooth or wifi can be good too, but I haven’t such card for adding to my Arduino. IR is for me the easiest solution. The distance sensor will make it closer to the MIP robot, able to reacting to some gestures.</p>
<p>I hope having some feedback from you.<br>
Serge</p>
<p>PS maybe, having some more personal chat will be easier.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-202">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-22"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 22, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-202"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi, well done with your robot! You could either send me an email with the video, or you could upload it to YouTube and send me the link. </p>
<p>I personally added a battery monitoring system to self-balancing robot, and I have all of the equipment to control the robot via WiFi. Unfortunately I haven’t found the time to get the WiFi controller to work yet, especially because the Galileo Gen2 Controller that I am using can be a bit tedious… <img draggable="false" class="emoji" alt="😛" src="./5. Putting it all together! – chillibasket_files/1f61b.svg"></p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-s.m.farhan" id="comment-177">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="S.M.FARHAN" src="./5. Putting it all together! – chillibasket_files/57a50e956742c91a1707fbb93f260120" srcset="http://2.gravatar.com/avatar/57a50e956742c91a1707fbb93f260120?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-57a50e956742c91a1707fbb93f260120-2"> <cite class="commenter fn n">S.M.FARHAN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 12, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-177"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi Simon! When uploaded and run your code, these two problems are occurring:<br>
<b>1. The program Sticks on this line and not going ahead. On Serial Monitor:</b><br>
<code>Testing MPU connection:<br>&gt; MPU6050 connection successful<br>Initialising DMP<br>Enabling DMP<br>DMP Ready! Let's Proceed.</code></p>
<p><b>2. And when press Button_1 or Button_2, It is showing FIFO Overflowing, On Serial Monitor:</b><br>
<code>Turning on balancing system<br>Turning off balancing system<br>Turning on balancing system<br>Setting new centre of gravity<br>Setting new centre of gravity<br>Warning - FIFO Overflowing!</code></p>
<p>I am using Arduino UNO with Interrupt 0 Pin 2 of Arduino UNO.<br>
Please help and resolve these; I will be thankful to You. Thanks In Advance.</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=177#respond" onclick="return addComment.moveForm( &quot;comment-177&quot;, &quot;177&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to S.M.FARHAN">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-179">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-23"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 12, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-179"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>I don’t think the program is sticking, as what you are seeing on the Serial monitor appears to be completely normal:<br>
(1) <b>The MPU6050</b> is initialising and connecting to Arduino successfully<br>
(2) <b>Button 1</b> turns the Balancing system on/off (you probably pressed it more than once), hence the multiple messages.<br>
(3) <b>Button 2</b> sets a new centre of gravity for the robot – this is the upright position the robot is trying to maintain.<br>
(4) <b>Warning – FIFO Overflowing!</b> My program <i>does not use interrupts</i>, so the buffer tends to overflow when the program does something else, such as dealing with the button presses. This is not a major problem and won’t affect the performance of the program.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired" id="comment-185">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="S.M.FARHAN" src="./5. Putting it all together! – chillibasket_files/57a50e956742c91a1707fbb93f260120" srcset="http://2.gravatar.com/avatar/57a50e956742c91a1707fbb93f260120?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-57a50e956742c91a1707fbb93f260120-3"> <cite class="commenter fn n">S.M.FARHAN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 15, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-185"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Thanks for your correction and informing about FIFO Overflowing, but a main query remains that: after all these normal behaviour showing on Serial Monitor:<br>
<code>Testing MPU connection:<br>MPU6050 connection successful<br>Initialising DMP<br>Enabling DMP<br>DMP Ready! Let’s Proceed.</code></p>
<p>Also after DMP Ready! Let’s proceed line on serial monitor, there is no movement by the motors when tilt or any position, I cross checked all my connections and mapped the pins correctly and carefully, but no idea why not any movement by the motors or any response by the system. Please, kindly let me know what is going wrong?</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired" id="comment-187">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="S.M.FARHAN" src="./5. Putting it all together! – chillibasket_files/57a50e956742c91a1707fbb93f260120" srcset="http://2.gravatar.com/avatar/57a50e956742c91a1707fbb93f260120?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-57a50e956742c91a1707fbb93f260120-4"> <cite class="commenter fn n">S.M.FARHAN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 15, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-187"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Thanks for all your helps dear Simon. I have corrected these all, I was doing a mistake. Now motors are synchronised and working with my system. Thanks again.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-s.m.farhan" id="comment-172">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="S.M.FARHAN" src="./5. Putting it all together! – chillibasket_files/57a50e956742c91a1707fbb93f260120" srcset="http://2.gravatar.com/avatar/57a50e956742c91a1707fbb93f260120?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-57a50e956742c91a1707fbb93f260120-5"> <cite class="commenter fn n">S.M.FARHAN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 9, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-172"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Dear Simon!<br>
Your tutorial about two wheel self balancing robot is awesome. i am working on it. I am not understanding where i can placed my Bluetooth based Tuning program on your Code. Please tell me as soon as possible, i will be great full to you.<br>
Thanks.<br>
S.M.FARHAN</p>

<!--END .comment-content-->
</div>
<div class="comment-reply"><a rel="nofollow" class="comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/?replytocom=172#respond" onclick="return addComment.moveForm( &quot;comment-172&quot;, &quot;172&quot;, &quot;respond&quot;, &quot;299&quot; )" aria-label="Reply to S.M.FARHAN">Reply</a></div>    <ul class="children">

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-173">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-24"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 10, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-173"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Hi! Unfortunately I can’t say much as I don’t exactly know what you are trying to do. Do you want to connect the robot, using a bluetooth module, to the computer so that you can tune the PID controller remotely? What micro-controller are you using?</p>
<p>Simon</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-s.m.farhan" id="comment-174">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="S.M.FARHAN" src="./5. Putting it all together! – chillibasket_files/57a50e956742c91a1707fbb93f260120" srcset="http://2.gravatar.com/avatar/57a50e956742c91a1707fbb93f260120?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-57a50e956742c91a1707fbb93f260120-6"> <cite class="commenter fn n">S.M.FARHAN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 10, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-174"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>HI! Sorry for inconvenience dear, Yes i want to connect my android/laptop builtin blue tooth to connect my robot using Bluetooth Module, for tune the PID Controller remotely. I am using Bluetooth Module HC-05 on Robot Side with Arduino Board to connect with Android Bluetooth. I am using Arduino Uno Board.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment administrator administrator-chillibasket_wired microid-mailto+http:sha1:f17aba137423b121906af586b97056ffa6155503" id="comment-175">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="Simon B." src="./5. Putting it all together! – chillibasket_files/c6edfd2247c1eb108913c553e0a55b52" srcset="http://0.gravatar.com/avatar/c6edfd2247c1eb108913c553e0a55b52?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-c6edfd2247c1eb108913c553e0a55b52-25"> <cite class="commenter fn n"><a href="http://www.chillibasket.com/" rel="external nofollow" class="url">Simon B.</a></cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 10, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-175"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Ok from what I can see, the HC-05 can communicate to the Arduino using software serial. Digital pins 5 and 6 are the only ones not used by my program, so you could use those as RX and TX respectively. To update the PID constants, your bluetooth function will simply have to update the values of the “Kp”, “Ki” and “Kd” variables. Here is a quick guideline of where you could put your code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5a01d678a9320611054900" class="crayon-syntax crayon-theme-arduino-ide crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -18px; display: none; position: absolute; z-index: 2;"><span class="crayon-title">Bluetooth Code Integration</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">/*
 * I've included line numbers where you can insert each part
 * into my self-balancing robot code.
 */

// (line 47) - Include the soft serial library
#include &lt;SoftwareSerial.h&gt;

// (line 50) - Set up soft serial pins
SoftwareSerial BTSerial(5, 6);   // RX = pin 5, TX = pin 6

// (line 152) - This initialises the UART communication
BTSerial.begin(38400);  // HC-05 default speed in AT command more

// (line 625) - This is the function that will deal with incoming bluetooth messages
void bluetoothReceive(){
    Serial.print(BTSerial.read());
    // Do something with incoming characters here!
}

// (line 626) - This is the function that will deal with sending bluetooth messages
void bluetoothSend(string message){
    BTSerial.write(message);
}

// (line 711) - This checks if there are any incoming bluetooth characters
if (BTSerial.available()){
    bluetoothReceive();
}</textarea></div>
			<div class="crayon-main" style="max-height: 250px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-2">2</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-4">4</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-6">6</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-8">8</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-10">10</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-12">12</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-14">14</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-16">16</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-18">18</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-20">20</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-22">22</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-24">24</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-26">26</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5a01d678a9320611054900-28">28</div><div class="crayon-num" data-line="crayon-5a01d678a9320611054900-29">29</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5a01d678a9320611054900-1"><span class="crayon-c">/*</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-2"><span class="crayon-c"> * I've included line numbers where you can insert each part</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-3"><span class="crayon-c"> * into my self-balancing robot code.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-4"><span class="crayon-c"> */</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-6"><span class="crayon-c">// (line 47) - Include the soft serial library</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-7"><span class="crayon-p">#include &lt;SoftwareSerial.h&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-8">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a9320611054900-9"><span class="crayon-c">// (line 50) - Set up soft serial pins</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-10"><span class="crayon-e">SoftwareSerial </span><span class="crayon-e">BTSerial</span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// RX = pin 5, TX = pin 6</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-12"><span class="crayon-c">// (line 152) - This initialises the UART communication</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-13"><span class="crayon-v">BTSerial</span><span class="crayon-sy">.</span><span class="crayon-e">begin</span><span class="crayon-sy">(</span><span class="crayon-cn">38400</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// HC-05 default speed in AT command more</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-14">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a9320611054900-15"><span class="crayon-c">// (line 625) - This is the function that will deal with incoming bluetooth messages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-16"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">bluetoothReceive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">BTSerial</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Do something with incoming characters here!</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-19"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-20">&nbsp;</div><div class="crayon-line" id="crayon-5a01d678a9320611054900-21"><span class="crayon-c">// (line 626) - This is the function that will deal with sending bluetooth messages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-22"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-e">bluetoothSend</span><span class="crayon-sy">(</span><span class="crayon-t">string</span><span class="crayon-h"> </span><span class="crayon-v">message</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">BTSerial</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">message</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-24"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-26"><span class="crayon-c">// (line 711) - This checks if there are any incoming bluetooth characters</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-27"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">BTSerial</span><span class="crayon-sy">.</span><span class="crayon-e">available</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5a01d678a9320611054900-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">bluetoothReceive</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5a01d678a9320611054900-29"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0031 seconds] -->
<p></p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>

    <!--BEING .comment-->
    <li class="comment reader reader-s.m.farhan" id="comment-176">
    <!--BEGIN .comment-author-->
<div class="comment-header"><div class="comment-author vcard">
<img alt="S.M.FARHAN" src="./5. Putting it all together! – chillibasket_files/57a50e956742c91a1707fbb93f260120" srcset="http://2.gravatar.com/avatar/57a50e956742c91a1707fbb93f260120?s=90&amp;d=retro&amp;r=g 2x" class="avatar avatar-45 photo img-responsive grav-hashed grav-hijack" height="45" width="45" id="grav-57a50e956742c91a1707fbb93f260120-7"> <cite class="commenter fn n">S.M.FARHAN</cite>
<!--END .comment-author-->
</div>
<!--BEGIN .comment-meta-->
<div class="comment-meta">
<span class="comment-date">October 10, 2015</span>
&nbsp;&nbsp;&nbsp;<span class="comment-permalink"><a rel="bookmark" title="Permalink to this comment" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#comment-176"><i class="t4p-icon-link"></i></a></span>
 
<!--END .comment-meta-->
</div></div>

<!--BEGIN .comment-content-->
<div class="comment-content">
<p>Thanks a lot Simon for such a good help and quick response. You are Great. God Bless You.</p>

<!--END .comment-content-->
</div>
    <!--END .comment-->
</li>
</ul><!-- .children -->
<!--END .comment-->
</li>
                <!--END .comment-list-->
            </ol>
           

        
        <div class="navigation-links page-navigation clearfix row">
            <div class="col-sm-6 col-md-6 nav-next"></div>
            <div class="col-sm-6 col-md-6 nav-previous"></div>
        </div>    

        <!--END #comments-->

        </div>

    <!--BEGIN #respond-->

    <!--BEGIN #comment-form-->

    <div class="clearfix"></div>        

    
		<div id="respond" class="comment-respond">
							<h3 id="reply-title" class="comment-reply-title">Leave a Reply					<small><a rel="nofollow" id="cancel-comment-reply-link" href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#respond" style="display:none;">Cancel reply</a></small>
				</h3>
						<form id="commentform" class="comment-form">
				<iframe src="./5. Putting it all together! – chillibasket_files/saved_resource.html" style="width: 100%; height: 58px; border: 0px;" name="jetpack_remote_comment" class="jetpack_remote_comment" id="jetpack_remote_comment" scrolling="no"></iframe>
				<!--[if !IE]><!-->
				<script>
					document.addEventListener('DOMContentLoaded', function () {
						var commentForms = document.getElementsByClassName('jetpack_remote_comment');
						for (var i = 0; i < commentForms.length; i++) {
							commentForms[i].allowTransparency = false;
							commentForms[i].scrolling = 'no';
						}
					});
				</script>
				<!--<![endif]-->
			</form>
		</div>

		
		<input type="hidden" name="comment_parent" id="comment_parent" value="">

		    <!--END #comment-form-->

    <!--END #respond-->

    
    <!--END #primary .hfeed-->
</div>

<!--BEGIN #secondary .aside-->
<div id="secondary" class="aside col-sm-6 col-md-4">
    <div id="search-2" class="widget widget_search"><div class="widget-content"><!--BEGIN #searchform-->
<form action="http://wired.chillibasket.com/" method="get" class="searchform">
    <div id="search-text-box">
        <label class="searchfield" id="search_label" for="search-text">
            <input id="search-text" type="text" tabindex="3" name="s" class="search" placeholder="Type your search">
        </label>
    </div>
    <div id="search-button-box">
        <button id="search-button" tabindex="4" type="submit" class="search-btn"></button>
    </div>
</form>
<div class="clearfix"></div>
<!--END #searchform--></div></div><div id="blog_subscription-2" class="widget jetpack_subscription_widget"><div class="widget-content"><div class="before-title"><div class="widget-title-background"></div><h3 class="widget-title">Subscribe via Email</h3></div>
			<form action="http://wired.chillibasket.com/2015/10/putting-it-all-together/#" method="post" accept-charset="utf-8" id="subscribe-blog-blog_subscription-2">
				<div id="subscribe-text"><p>Enter your email address to subscribe to this blog and receive notifications of new posts by email.</p>
</div>					<p id="subscribe-email">
						<label id="jetpack-subscribe-label" for="subscribe-field-blog_subscription-2" style="clip: rect(1px 1px 1px 1px); position: absolute; height: 1px; width: 1px; overflow: hidden;">
							Email Address						</label>
						<input type="email" name="email" required="required" class="required" value="" id="subscribe-field-blog_subscription-2" placeholder="Email Address">
					</p>

					<p id="subscribe-submit">
						<input type="hidden" name="action" value="subscribe">
						<input type="hidden" name="source" value="http://wired.chillibasket.com/2015/10/putting-it-all-together/">
						<input type="hidden" name="sub-type" value="widget">
						<input type="hidden" name="redirect_fragment" value="blog_subscription-2">
												<input type="submit" value="Subscribe" name="jetpack_subscriptions_widget">
					</p>
							</form>

			<script>
			/*
			Custom functionality for safari and IE
			 */
			(function( d ) {
				// In case the placeholder functionality is available we remove labels
				if ( ( 'placeholder' in d.createElement( 'input' ) ) ) {
					var label = d.querySelector( 'label[for=subscribe-field-blog_subscription-2]' );
						label.style.clip 	 = 'rect(1px, 1px, 1px, 1px)';
						label.style.position = 'absolute';
						label.style.height   = '1px';
						label.style.width    = '1px';
						label.style.overflow = 'hidden';
				}

				// Make sure the email value is filled in before allowing submit
				var form = d.getElementById('subscribe-blog-blog_subscription-2'),
					input = d.getElementById('subscribe-field-blog_subscription-2'),
					handler = function( event ) {
						if ( '' === input.value ) {
							input.focus();

							if ( event.preventDefault ){
								event.preventDefault();
							}

							return false;
						}
					};

				if ( window.addEventListener ) {
					form.addEventListener( 'submit', handler, false );
				} else {
					form.attachEvent( 'onsubmit', handler );
				}
			})( document );
			</script>
				
</div></div><div id="text-2" class="widget widget_text"><div class="widget-content"><div class="before-title"><div class="widget-title-background"></div><h3 class="widget-title">Tutorials</h3></div>			<div class="textwidget"><u><b>Self-balancing Robots</b></u>
<ul>
	<li><a title="Self-Balancing Robot | Part 1" href="http://wired.chillibasket.com/2014/09/self-balancing-robot-part-1/">Part 1: An Introduction</a></li>
	<li><a title="Self-Balancing Robot | Part 2" href="http://wired.chillibasket.com/2014/10/self-balancing-robot-part-2/">Part 2: Accel &amp; Gyro Sensors</a></li>
	<li><a title="Calibrating &amp; Optimising the MPU6050" href="http://wired.chillibasket.com/2015/01/self-balancing-robot-part-3/">Part 3: Calibrating the MPU-6050</a></li>
	<li><a title="The PID Controller" href="http://wired.chillibasket.com/2015/03/self-balancing-robot-part-4/">Part 4: The PID Controller</a></li>
	<li><span style="color: #000000;"><a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/">Part 5: Putting it all Together</a></span></li>
</ul>
<br>
<u><b>Arduino 101</b></u>
<ul>
	<li><a title="Arduino 101 - An Introduction" href="http://wired.chillibasket.com/2016/10/arduino-101-an-introduction/">Part 1: An Introduction</a></li>
</ul>
<br>
<u><b>Hobby Electronics Tips &amp; Tricks</b></u>
<ul>
	<li><a title="My Hobby Toolbox" href="http://wired.chillibasket.com/2014/10/my-hobby-toolbox/">My Hobby Toolbox</a></li>
	<li><a title="Powering Micro-controllers using Batteries" href="http://wired.chillibasket.com/2014/12/powering-micro-controllers-using-batteries/">Using Batteries with Micro-controllers</a></li>
</ul></div>
		</div></div><div id="categories-2" class="widget widget_categories"><div class="widget-content"><div class="before-title"><div class="widget-title-background"></div><h3 class="widget-title">Categories</h3></div>		<ul>
	<li class="cat-item cat-item-43"><a href="http://wired.chillibasket.com/category/3d-printing/">3D Printing</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://wired.chillibasket.com/category/announcement/">Announcement</a>
</li>
	<li class="cat-item cat-item-44"><a href="http://wired.chillibasket.com/category/tutorial/arduino-101/">Arduino 101</a>
</li>
	<li class="cat-item cat-item-20"><a href="http://wired.chillibasket.com/category/equipment/">Equipment</a>
</li>
	<li class="cat-item cat-item-5"><a href="http://wired.chillibasket.com/category/galileo/">Galileo</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://wired.chillibasket.com/category/projects/">Projects</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://wired.chillibasket.com/category/robotics/">Robotics</a>
</li>
	<li class="cat-item cat-item-38"><a href="http://wired.chillibasket.com/category/tutorial/self-balancing/">Self-balancing</a>
</li>
	<li class="cat-item cat-item-24"><a href="http://wired.chillibasket.com/category/techniques/">Techniques</a>
</li>
	<li class="cat-item cat-item-37"><a href="http://wired.chillibasket.com/category/tutorial/">Tutorial</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://wired.chillibasket.com/category/uncategorized/">Uncategorized</a>
</li>
		</ul>
</div></div><div id="archives-2" class="widget widget_archive"><div class="widget-content"><div class="before-title"><div class="widget-title-background"></div><h3 class="widget-title">Archives</h3></div>		<ul>
			<li><a href="http://wired.chillibasket.com/2017/07/">July 2017</a></li>
	<li><a href="http://wired.chillibasket.com/2016/10/">October 2016</a></li>
	<li><a href="http://wired.chillibasket.com/2016/06/">June 2016</a></li>
	<li><a href="http://wired.chillibasket.com/2015/10/">October 2015</a></li>
	<li><a href="http://wired.chillibasket.com/2015/03/">March 2015</a></li>
	<li><a href="http://wired.chillibasket.com/2015/01/">January 2015</a></li>
	<li><a href="http://wired.chillibasket.com/2014/12/">December 2014</a></li>
	<li><a href="http://wired.chillibasket.com/2014/10/">October 2014</a></li>
	<li><a href="http://wired.chillibasket.com/2014/09/">September 2014</a></li>
	<li><a href="http://wired.chillibasket.com/2014/08/">August 2014</a></li>
		</ul>
		</div></div></div><!--END #secondary .aside--><!--END #content-->
</div>
<!--END .container-->
</div>
<!--END .content-->
</div>
<!--BEGIN .content-bottom-->
<div class="content-bottom">
    <!--END .content-bottom-->
</div>
<!--BEGIN .footer-->
<div class="footer">
    <!--BEGIN .container-->
    <div class="container container-footer">
                <div class="clearfix"></div>
        <p id="copyright"><span class="credits">© Copyright 2016 <a href="http://wired.chillibasket.com/about">Simon Bluett</a> • <a href="http://theme4press.com/evolve-multipurpose-wordpress-theme/">evolve</a> theme by Theme4Press&nbsp;&nbsp;•&nbsp;&nbsp;Powered by <a href="http://wordpress.org/">WordPress</a></span></p>        <!-- Theme Hook -->
        
    <script type="text/javascript">
        var $jx = jQuery.noConflict();
        $jx("div.post").mouseover(
                function () {
                    $jx(this).find("span.edit-post").css('visibility', 'visible');
                }
        ).mouseout(
                function () {
                    $jx(this).find("span.edit-post").css('visibility', 'hidden');
                }
        );
        $jx("div.type-page").mouseover(
                function () {
                    $jx(this).find("span.edit-page").css('visibility', 'visible');
                }
        ).mouseout(
                function () {
                    $jx(this).find("span.edit-page").css('visibility', 'hidden');
                }
        );
        $jx("div.type-attachment").mouseover(
                function () {
                    $jx(this).find("span.edit-post").css('visibility', 'visible');
                }
        ).mouseout(
                function () {
                    $jx(this).find("span.edit-post").css('visibility', 'hidden');
                }
        );
        $jx("li.comment").mouseover(
                function () {
                    $jx(this).find("span.edit-comment").css('visibility', 'visible');
                }
        ).mouseout(
                function () {
                    $jx(this).find("span.edit-comment").css('visibility', 'hidden');
                }
        );</script> 

    
        <script type="text/javascript">
            jQuery(document).ready(
                    function ($) {
                        if (jQuery('.sticky-header').length >= 1) {
                            jQuery(window).scroll(function () {
                                var header = jQuery(document).scrollTop();
                                var headerHeight = jQuery('.new-top-menu').height() + jQuery('.menu-header').height() + jQuery('.header-pattern').height();
                                if (header > headerHeight) {
                                    jQuery('.sticky-header').addClass('sticky');
                                    jQuery('.sticky-header').show();
                                } else {
                                    jQuery('.sticky-header').removeClass('sticky');
                                    jQuery('.sticky-header').hide();
                                }
                            });
                        }
                    }
            );</script>

        
        <script type="text/javascript">
            /*----------------------------*/
            /* Animated Buttons
             /*----------------------------*/

            var $animated = jQuery.noConflict();
            $animated('.post-more').hover(
                    function () {
                        $animated(this).addClass('animated pulse')
                    },
                    function () {
                        $animated(this).removeClass('animated pulse')
                    }
            )
            $animated('.read-more').hover(
                    function () {
                        $animated(this).addClass('animated pulse')
                    },
                    function () {
                        $animated(this).removeClass('animated pulse')
                    }
            )
            $animated('#submit').hover(
                    function () {
                        $animated(this).addClass('animated pulse')
                    },
                    function () {
                        $animated(this).removeClass('animated pulse')
                    }
            )
            $animated('input[type="submit"]').hover(
                    function () {
                        $animated(this).addClass('animated pulse')
                    },
                    function () {
                        $animated(this).removeClass('animated pulse')
                    }
            )

        </script>

        
        <script type="text/javascript">
            /*----------------*/
            /* AnythingSlider
             /*----------------*/
            var $s = jQuery.noConflict();
            $s(
                    function () {
                        $s('#slides')
                                .anythingSlider({autoPlay: true, delay: 7000, })
                    }
            )
        </script>

                <script type="text/javascript">
            /*----------------*/
            /* Parallax Slider
             /*----------------*/

            var $par = jQuery.noConflict();
            $par('#da-slider').cslider(
                    {
                        autoplay: true,
                        bgincrement: 450,
                        interval: 4000                    }
            );</script>

    
    <script type="text/javascript">
        /*----------------------*/
        /* Bootstrap Slider
         /*---------------------*/

        var $carousel = jQuery.noConflict();
        $carousel('#myCarousel').carousel(
                {
                    interval: 7000
                }
        )

        $carousel('#carousel-nav a').click(
                function (q) {
                    q.preventDefault();
                    targetSlide = $carousel(this).attr('data-to') - 1;
                    $carousel('#myCarousel').carousel(targetSlide);
                    $carousel(this).addClass('active').siblings().removeClass('active');
                }
        );
        $carousel('#bootstrap-slider').carousel(
                {
                    interval: 7500                }
        )

        $carousel('#carousel-nav a').click(
                function (q) {
                    q.preventDefault();
                    targetSlide = $carousel(this).attr('data-to') - 1;
                    $carousel('#bootstrap-slider').carousel(targetSlide);
                    $carousel(this).addClass('active').siblings().removeClass('active');
                }
        );
    </script>

            <!--END .container-->
    </div>
    <!--END .footer-->
</div>
<!--END body-->
    <a href="http://wired.chillibasket.com/2015/10/putting-it-all-together/#top" id="top-link"><div id="backtotop" style="display: block;"></div></a>
            </div>
    	<div style="display:none">
	<div class="grofile-hash-map-f624068c57936b97f6a344905741f548">
	</div>
	<div class="grofile-hash-map-c6edfd2247c1eb108913c553e0a55b52">
	</div>
	<div class="grofile-hash-map-167f361773c361d725c33eff9edc740c">
	</div>
	<div class="grofile-hash-map-598294bf50f8dcc2286fae06e46c5155">
	</div>
	<div class="grofile-hash-map-ad1cacb223fd87baa69f1835fb6fe3b6">
	</div>
	<div class="grofile-hash-map-18522b29ff0fa8edb438485926699a48">
	</div>
	<div class="grofile-hash-map-9bb01d1142554181a75b2c94e445563f">
	</div>
	<div class="grofile-hash-map-fb0b6cdbbe1bdaf0a896591838c3f176">
	</div>
	<div class="grofile-hash-map-8d94c6cab6006a08d047c65eb04932fc">
	</div>
	<div class="grofile-hash-map-703863129d2485d80a049b4d09f05dd0">
	</div>
	<div class="grofile-hash-map-8cb72dab08a98b89fb009f4181b007a5">
	</div>
	<div class="grofile-hash-map-57a50e956742c91a1707fbb93f260120">
	</div>
	<div class="grofile-hash-map-2d9d44d14f2567e7291789f9cc0917f5">
	</div>
	<div class="grofile-hash-map-c08b6751ee168a9ee28a4a6156f16357">
	</div>
	<div class="grofile-hash-map-9fbce080e36283908c5da12880f377ca">
	</div>
	</div>
<script>
            if (jQuery(".posts-container-infinite").length == 1) {
                var ias = jQuery.ias({
                    container: ".posts-container-infinite",
                    item: "div.post",
                    pagination: "div.pagination",
                    next: "a.pagination-next",
                });

                ias.extension(new IASTriggerExtension({
                        text: "Load more items",
                        offset: 99999
                }));
                ias.extension(new IASSpinnerExtension({
                }));
                ias.extension(new IASNoneLeftExtension());
            }else{}
    </script><!--[if lte IE 8]>
<link rel='stylesheet' id='jetpack-carousel-ie8fix-css'  href='http://wired.chillibasket.com/wp-content/plugins/jetpack/modules/carousel/jetpack-carousel-ie8fix.css?ver=20121024' type='text/css' media='all' />
<![endif]-->
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/tabs.js.tải xuống"></script>
<script type="text/javascript">
/* <![CDATA[ */
var js_local_vars = {"language_flag":"","infinite_blog_finished_msg":"<em>All posts displayed<\/em>","infinite_blog_text":"<em>Loading the next set of posts...<\/em>","theme_url":"http:\/\/wired.chillibasket.com\/wp-content\/themes\/evolve","responsive_menu":"<span class=\"t4p-icon-menu\"><\/span>"};
/* ]]> */
</script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/main.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/gmap.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/devicepx-jetpack.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/gprofiles.js.tải xuống"></script>
<script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/wpgroho.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/comment-reply.min.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/wp-embed.min.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/spin.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/jquery.spin.js.tải xuống"></script>
<script type="text/javascript">
/* <![CDATA[ */
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"http:\/\/wired.chillibasket.com\/wp-admin\/admin-ajax.php","nonce":"93f50e37ca","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","copyright":"Copyright","comment_registration":"0","require_name_email":"1","login_url":"http:\/\/wired.chillibasket.com\/admin-login?redirect_to=http%3A%2F%2Fwired.chillibasket.com%2F2015%2F10%2Fputting-it-all-together%2F","blog_id":"1","meta_data":["camera","aperture","shutter_speed","focal_length","copyright"],"local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>"};
/* ]]> */
</script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/jetpack-carousel.js.tải xuống"></script>
<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/tiled-gallery.js.tải xuống"></script>

		<!--[if IE]>
		<script type="text/javascript">
			if ( 0 === window.location.hash.indexOf( '#comment-' ) ) {
				// window.location.reload() doesn't respect the Hash in IE
				window.location.hash = window.location.hash;
			}
		</script>
		<![endif]-->
		<script type="text/javascript">
			(function () {
				var comm_par_el = document.getElementById( 'comment_parent' ),
					comm_par = ( comm_par_el && comm_par_el.value ) ? comm_par_el.value : '',
					frame = document.getElementById( 'jetpack_remote_comment' ),
					tellFrameNewParent;

				tellFrameNewParent = function () {
					if ( comm_par ) {
						frame.src = "http://jetpack.wordpress.com/jetpack-comment/?blogid=73605368&postid=299&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=1&avatar_default=retro&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=5.4&sig=285faa87a6043815f7b40c208da3a2a3c6f8d119#parent=http%3A%2F%2Fwired.chillibasket.com%2F2015%2F10%2Fputting-it-all-together%2F" + '&replytocom=' + parseInt( comm_par, 10 ).toString();
					} else {
						frame.src = "http://jetpack.wordpress.com/jetpack-comment/?blogid=73605368&postid=299&comment_registration=0&require_name_email=1&stc_enabled=1&stb_enabled=1&show_avatars=1&avatar_default=retro&greeting=Leave+a+Reply&greeting_reply=Leave+a+Reply+to+%25s&color_scheme=light&lang=en_US&jetpack_version=5.4&sig=285faa87a6043815f7b40c208da3a2a3c6f8d119#parent=http%3A%2F%2Fwired.chillibasket.com%2F2015%2F10%2Fputting-it-all-together%2F";
					}
				};

				
				if ( 'undefined' !== typeof addComment ) {
					addComment._Jetpack_moveForm = addComment.moveForm;

					addComment.moveForm = function ( commId, parentId, respondId, postId ) {
						var returnValue = addComment._Jetpack_moveForm( commId, parentId, respondId, postId ),
							cancelClick, cancel;

						if ( false === returnValue ) {
							cancel = document.getElementById( 'cancel-comment-reply-link' );
							cancelClick = cancel.onclick;
							cancel.onclick = function () {
								var cancelReturn = cancelClick.call( this );
								if ( false !== cancelReturn ) {
									return cancelReturn;
								}

								if ( ! comm_par ) {
									return cancelReturn;
								}

								comm_par = 0;

								tellFrameNewParent();

								return cancelReturn;
							};
						}

						if ( comm_par == parentId ) {
							return returnValue;
						}

						comm_par = parentId;

						tellFrameNewParent();

						return returnValue;
					};
				}

				
				// Do the post message bit after the dom has loaded.
				document.addEventListener( 'DOMContentLoaded', function () {
					var iframe_url = "http:\/\/jetpack.wordpress.com";
					if ( window.postMessage ) {
						if ( document.addEventListener ) {
							window.addEventListener( 'message', function ( event ) {
								var origin = event.origin.replace( /^http:\/\//i, 'https://' );
								if ( iframe_url.replace( /^http:\/\//i, 'https://' ) !== origin ) {
									return;
								}
								jQuery( frame ).height( event.data );
							});
						} else if ( document.attachEvent ) {
							window.attachEvent( 'message', function ( event ) {
								var origin = event.origin.replace( /^http:\/\//i, 'https://' );
								if ( iframe_url.replace( /^http:\/\//i, 'https://' ) !== origin ) {
									return;
								}
								jQuery( frame ).height( event.data );
							});
						}
					}
				})

			})();
		</script>

		<script type="text/javascript" src="./5. Putting it all together! – chillibasket_files/e-201745.js.tải xuống" async="" defer=""></script>
<script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:5.4',blog:'73605368',post:'299',tz:'0',srv:'wired.chillibasket.com'} ]);
	_stq.push([ 'clickTrackerInit', '73605368', '299' ]);
</script>

<!--END html(kthxbye)-->
</div><img src="./5. Putting it all together! – chillibasket_files/g.gif" alt=":)" width="6" height="5" id="wpstats"></body></html>